import{z as A,am as de,an as Pe,ao as Le,ap as La,A as Jo,r as u,j as e,R as Se,n as ba,D as C,l as o,aq as Oe,G as X,Q as G,t as D,O as Ue,P as W,S as Fe,T as Ke,W as J,ar as ke,as as sn,at as on,au as Ve,av as Zo,aw as pt,ax as kn,ay as Ma,$ as le,az as Da,V as Mn,g as xl,aA as Yo,K as bt,I as Xo,aB as ed,aC as at,aD as tt,aE as sa,aF as Sa,aG as Tl,o as St,aH as nd,ah as ad,ai as td,aI as ld,p as Il,q as id,aJ as rd,a0 as sd,aK as od,aL as Ht,aM as dd,aN as cd,aO as ud,aP as md,aQ as gd,aR as pd,aS as yd,aT as fd,aU as hd}from"./vendor-Cb3zlNNd.js";import{c as h,I as L,a as I,e as z,d as K,q as ue,C as q,m as vt,p as Z,D as ee,b as x,v as ce,N as Ct,K as Qe,M as ne,O as Be,Q as be,S as kd,x as Oa,r as Qa,P as Zn,o as Nn,s as va,B as zn,G as Yn,t as De,y as Dl,U as Je,L as wa,V as Pl,W as Ll,X as wl,Y as bd,Z as Sd,$ as Xn,j as je,k as Ca,T as pe,a0 as Ft,n as Re,l as ae,E as ja,f as Ie,a1 as El,a2 as Kt,h as Vn,u as vd,a3 as Cd,w as Fd,R as pa,i as _l}from"./vendor-arizeai-Buo4e1A6.js";import{s as xt,a as me,l as Kd,j as Rl,b as Ae,i as Al,c as Ml,d as yn,e as Nl,f as xd,g as fa,D as Td,h as Ea,k as Id,T as Pn,m as Dd,n as Gt,o as Pd,p as Ld,q as Wt,r as wd,t as Ed,N as _d,u as Rd,L as ye,v as ve,w as Fa,B as Ad,x as Tn,y as Md,G as Nd,z as zd,A as Vd,S as $d,C as ln,J as _e,E as $n,F as Ee,H as fe,I as Ce,K as ea,M as un,O as xe,P as se,Q as rn,R as bn,U as Me,V as zl,W as Ge,X as Ze,Y as Sn,Z as Tt,_ as en,$ as mn,a0 as It,a1 as Vl,a2 as $l,a3 as Jt,a4 as Zt,a5 as On,a6 as Od,a7 as Qd,a8 as B,a9 as Ol,aa as qa,ab as na,ac as Ql,ad as aa,ae as ta,af as jl,ag as gn,ah as we,ai as Ua,aj as vn,ak as Dt,al as nn,am as ql,an as jd,ao as qd,ap as Ud,aq as Bd,ar as Hd,as as Gd,at as He,au as Wd,av as Jd,aw as Ul,ax as Zd,ay as Yd,az as Yt,aA as Xd,aB as ec,aC as nc,aD as ac,aE as tc,aF as lc,aG as Bl,aH as ic,aI as rc,aJ as sc,aK as oc,aL as dc,aM as En,aN as Pt,aO as Hl,aP as Gn,aQ as yt,aR as Dn,aS as pn,aT as cc,aU as uc,aV as Gl,aW as Ba,aX as an,aY as mc,aZ as Wl,a_ as gc,a$ as ze,b0 as Lt,b1 as pc,b2 as wt,b3 as qe,b4 as Ye,b5 as la,b6 as yc,b7 as Ha,b8 as Jl,b9 as Zl,ba as fc,bb as We,bc as Ne,bd as hc,be as Et,bf as Yl,bg as Xl,bh as ei,bi as ni,bj as fn,bk as kc,bl as Xt,bm as ai,bn as bc,bo as Sc,bp as vc,bq as Cc,br as Fc,bs as Wn,bt as ft,bu as ti,bv as Kc,bw as xc,bx as Ga,by as li,bz as Ka,bA as el,bB as ii,bC as _t,bD as ri,bE as si,bF as Tc,bG as ht,bH as oi,bI as Ic,bJ as Dc,bK as Pa,bL as Pc,bM as di,bN as ci,bO as Lc,bP as wc,bQ as Ec,bR as Rt,bS as ui,bT as _c,bU as Na,bV as Rc,bW as Ac,bX as Mc,bY as Nc,bZ as zc,b_ as mi,b$ as Vc,c0 as $c,c1 as Oc,c2 as Qc,c3 as jc,c4 as qc,c5 as Uc,c6 as Bc}from"./components-DKH6AzJw.js";import{R as Cn,C as xa,X as Fn,Y as Xe,a as Kn,T as xn,B as Jn,A as ha,b as gi,c as At,L as pi,d as Hc,P as Gc,e as Wc,f as Jc}from"./vendor-recharts-Cl9dK5tC.js";import{p as Mt,R as ia,n as ra,i as Zc,E as yi,m as Yc,o as Xc,g as eu}from"./vendor-codemirror-BuAQiUVf.js";const nu=4,au={user:["user","human"],ai:["assistant","bot","ai"],system:["system"],tool:["tool"]},tu="Unable to parse span input messages, expected messages which include a role and content.",lu="Unable to parse span output messages, expected messages which include a role and content.",iu="Unable to parse span output expected output.value to be present.",ru="Unable to parse span attributes, attributes must be valid JSON.",su="Unable to parse model config, expected llm.model_name to be present.",ou="Unable to parse model config, expected llm.invocation_parameters JSON string to be present.",du="Unable to parse invocation parameters response_format, expected llm.invocation_parameters.response_format to be a well formed json object or undefined.",cu="Unable to parse tools, expected tools to be an array of valid tools.",uu="Unable to parse prompt template variables, expected prompt template variables to be a valid JSON object string.",nl={AZURE_OPENAI:[],ANTHROPIC:["claude"],OPENAI:["gpt","o1"],GEMINI:["gemini"]},ya="TOOL_CHOICE",_a="tool_choice",_n="RESPONSE_FORMAT",Ln="response_format",mu=[ya,_n],Nt=xt()(A.union([A.literal("auto"),A.literal("none"),A.literal("required"),A.object({type:A.literal("function"),function:A.object({name:A.string()})})])),zt=A.object({type:A.union([A.literal("auto"),A.literal("any"),A.literal("tool")]),disable_parallel_tool_use:A.boolean().optional(),name:A.string().optional()}),gu=zt.transform(n=>{switch(n.type){case"any":case"auto":return"auto";case"tool":return n.name?{type:"function",function:{name:n.name}}:"auto";default:return"auto"}}),pu=Nt.transform(n=>typeof n=="string"?{type:"auto"}:{type:"tool",name:n.function.name});A.union([Nt,zt]);const yu=n=>{const{success:a,data:t}=Nt.safeParse(n);if(a)return{provider:"OPENAI",toolChoice:t};const{success:l,data:i}=zt.safeParse(n);return l?{provider:"ANTHROPIC",toolChoice:i}:{provider:null,toolChoice:null}},fu=n=>{const{provider:a,toolChoice:t}=yu(n);if(a==null||t==null)throw new Error("Could not detect provider of tool choice");switch(a){case"AZURE_OPENAI":case"OPENAI":return t;case"ANTHROPIC":return gu.parse(t);default:me()}},hu=({toolChoice:n,targetProvider:a})=>{switch(a){case"AZURE_OPENAI":case"OPENAI":return n;case"ANTHROPIC":return pu.parse(n);case"GEMINI":return n;default:me()}},ku=({toolChoice:n,targetProvider:a})=>{try{const t=fu(n);return hu({toolChoice:t,targetProvider:a})}catch{return null}},bu=A.object({tool_call:A.object({id:A.string().optional(),function:A.object({name:A.string(),arguments:A.string()}).partial()}).partial()}).partial(),fi=A.object({[de.message]:A.object({[Pe.role]:A.string(),[Pe.content]:A.union([A.string(),A.array(A.record(A.string(),A.unknown()))]).default(""),[Pe.tool_calls]:A.array(bu).optional(),[Pe.tool_call_id]:A.string().optional()})}),Su=A.object({[de.llm]:A.object({[Le.input_messages]:A.array(fi)})}),vu=A.object({[de.llm]:A.object({[Le.output_messages]:A.array(fi)})}),Cu=A.object({[de.output]:A.object({value:A.string()})}),hi=xt()(A.enum(["user","ai","system","tool"])),Fu=xt()(A.object({id:A.number(),role:hi,content:A.string().optional(),toolCallId:A.string().optional(),toolCalls:A.array(Kd).optional()})),Ku=A.array(Fu),Vt=A.lazy(()=>A.record(Rl)),xu=Vt,ki=A.string().transform((n,a)=>{const{json:t}=Ae(n);if(!Al(t))return a.addIssue({code:A.ZodIssueCode.custom,message:"The invocation parameters must be a valid JSON object"}),A.NEVER;const{success:l,data:i}=xu.safeParse(t);return l?i:(a.addIssue({code:A.ZodIssueCode.custom,message:"The invocation parameters must be a valid JSON object"}),A.NEVER)}).default("{}"),Tu=A.object({[de.llm]:A.object({[Le.provider]:A.string().optional(),[Le.model_name]:A.string()})}),bi=A.object({[de.llm]:A.object({[Le.invocation_parameters]:ki})}),Iu=A.object({[de.llm]:A.object({[Le.invocation_parameters]:ki.pipe(A.object({response_format:Vt.optional()}))})}),Du=A.string().transform((n,a)=>{const{json:t}=Ae(n);return t==null||!Al(t)?(a.addIssue({code:A.ZodIssueCode.custom,message:"The tool JSON schema must be a valid JSON object"}),A.NEVER):t}).transform((n,a)=>{const{data:t,success:l}=Ml.safeParse(n);return l?t:(a.addIssue({code:A.ZodIssueCode.custom,message:"The tool JSON schema must be a valid tool schema"}),A.NEVER)}),Pu=A.object({[de.llm]:A.object({[Le.tools]:A.array(A.object({[de.tool]:A.object({[La.json_schema]:Du})}).optional()).optional()}).optional()}).optional(),Lu=A.lazy(()=>A.object({type:A.literal("json_schema"),json_schema:A.object({name:A.string().describe("The name of the schema"),schema:Rl.describe("The schema itself in JSON format"),strict:A.literal(!0).describe("The schema must be strict")})})),wu=Jo(Lu,{removeAdditionalStrategy:"passthrough"}),Eu=A.string().transform((n,a)=>{const{json:t}=Ae(n);return yn(t)?Object.entries(t).reduce((i,[r,s])=>{if(typeof s=="string")i[r]=s;else{const{json:c}=Nl(s);c!=null&&(i[r]=c)}return i},{}):(a.addIssue({code:A.ZodIssueCode.custom,message:"The prompt template variables must be a valid JSON object"}),A.NEVER)}),_u=A.object({[de.llm]:A.object({[Le.prompt_template]:A.object({variables:Eu}).optional()}).optional()}).optional();function Si(n){return hi.safeParse(n).success}function za(n){if(Si(n))return n;for(const[a,t]of Object.entries(au))if(t.includes(n))return a;return Id}function Ru({toolCalls:n,provider:a}){if(n!=null)return n.map(({tool_call:t})=>{var i,r,s,c;if(t==null)return null;let l={};if(((i=t.function)==null?void 0:i.arguments)!=null){const{json:d}=Ae(t.function.arguments);yn(d)&&(l=d)}switch(a){case"OPENAI":case"AZURE_OPENAI":return{id:t.id??"",function:{name:((r=t.function)==null?void 0:r.name)??"",arguments:l}};case"ANTHROPIC":return{id:t.id??"",type:"tool_use",name:((s=t.function)==null?void 0:s.name)??"",input:l};case"GEMINI":return{id:t.id??"",function:{name:((c=t.function)==null?void 0:c.name)??"",arguments:l}};default:me()}}).filter(t=>t!=null)}function vi({messages:n,provider:a}){return n.map(({message:t})=>({id:fa(),role:t.tool_call_id!=null?za("tool"):za(t.role),content:typeof t.content=="string"?t.content:void 0,toolCalls:Ru({provider:a,toolCalls:t.tool_calls}),toolCallId:t.tool_call_id}))}function Au({provider:n,parsedAttributes:a}){var l;const t=Su.safeParse(a);if(!t.success)return{messageParsingErrors:[tu],messages:null};if(n==="ANTHROPIC"){const{success:i,data:r}=bi.safeParse(a);if(i){const s=t.data.llm.input_messages,c=(l=r.llm.invocation_parameters)==null?void 0:l.system;typeof c=="string"&&c&&(!s||s[0].message.role!=="system")&&t.data.llm.input_messages.unshift({message:{role:"system",content:c}})}}return{messageParsingErrors:[],messages:vi({provider:n,messages:t.data.llm.input_messages})}}function Mu({provider:n,parsedAttributes:a}){const t=[],l=vu.safeParse(a);if(l.success)return{output:vi({provider:n,messages:l.data.llm.output_messages}),outputParsingErrors:t};t.push(lu);const i=Cu.safeParse(a);return i.success?{output:i.data.output.value,outputParsingErrors:t}:(t.push(iu),{output:void 0,outputParsingErrors:t})}function Nu(n){if(n==null)return null;switch(n.toLowerCase()){case"openai":return"OPENAI";case"anthropic":return"ANTHROPIC";case"google":return"GEMINI";case"azure":return"AZURE_OPENAI";default:return null}}function zu(n){for(const a of Object.keys(nl))if(nl[a].some(l=>n.includes(l)))return a;return Td}function Vu(n){const{success:a,data:t}=Tu.safeParse(n);if(a){const l=Nu(t.llm.provider)||zu(t.llm.model_name);return{modelConfig:{modelName:t.llm.model_name,provider:l,invocationParameters:[],supportedInvocationParameters:[]},parsingErrors:[]}}return{modelConfig:null,parsingErrors:[su]}}function $u(n,a=[]){const{success:t,data:l}=bi.safeParse(n),i=[];return t||i.push(ou),{invocationParameters:Wu((l==null?void 0:l.llm.invocation_parameters)??{},a),parsingErrors:i}}function Ou(n){const{success:a,data:t}=Iu.safeParse(n);return a?{responseFormat:t.llm.invocation_parameters.response_format,parsingErrors:[]}:{responseFormat:void 0,parsingErrors:[du]}}function Qu(n){var a;return(((a=n==null?void 0:n.llm)==null?void 0:a.tools)??[]).map(t=>(t==null?void 0:t.tool)==null?null:{id:Ea(),definition:t.tool.json_schema}).filter(t=>t!=null)}function ju(n){var l;const{data:a,success:t}=Pu.safeParse(n);return t?((l=a==null?void 0:a.llm)==null?void 0:l.tools)==null?{tools:null,parsingErrors:[]}:{tools:Qu(a),parsingErrors:[]}:{tools:null,parsingErrors:[cu]}}function qu(n){var l;const{success:a,data:t}=_u.safeParse(n);return a?((l=t==null?void 0:t.llm)==null?void 0:l.prompt_template)==null?{variables:null,parsingErrors:[]}:{variables:t.llm.prompt_template.variables,parsingErrors:[]}:{variables:null,parsingErrors:[uu]}}function Uu(n){const a=xd(),{json:t,parseError:l}=Ae(n.attributes);if(l)return{playgroundInstance:{...a,spanId:(n==null?void 0:n.id)??null},parsingErrors:[ru]};const i=n.invocationParameters,r=Vu(t);let{modelConfig:s}=r;const{parsingErrors:c}=r,{messages:d,messageParsingErrors:m}=Au({provider:(s==null?void 0:s.provider)??a.model.provider,parsedAttributes:t}),{output:y,outputParsingErrors:g}=Mu({provider:(s==null?void 0:s.provider)??a.model.provider,parsedAttributes:t}),{invocationParameters:p,parsingErrors:f}=$u(t,i),{variables:k,parsingErrors:b}=qu(t),{parsingErrors:S}=Ou(t);s=s!=null?{...s,invocationParameters:S.length>0?p.filter(E=>E.invocationName!==Ln&&E.canonicalName!==_n):p}:null;const{tools:v,parsingErrors:P}=ju(t);return{playgroundInstance:{...a,model:s??a.model,template:d!=null?{__type:"chat",messages:d}:a.template,output:y,spanId:n.id,tools:v??a.tools},playgroundInput:k!=null?{variablesValueCache:k}:void 0,parsingErrors:[...m,...g,...c,...P,...f,...S,...b]}}const Bu=n=>Ku.safeParse(n).success,Ci=({instance:n,templateLanguage:a})=>{if(a==Pn.NONE)return[];const t=new Set,l=n.template.__type,i=Dd(a);switch(l){case"chat":{n.template.messages.forEach(r=>{(r.content==null?[]:i.extractVariables(r.content)).forEach(c=>{t.add(c)})});break}case"text_completion":{i.extractVariables(n.template.prompt).forEach(s=>{t.add(s)});break}default:me()}return Array.from(t)},Hu=({instances:n,templateLanguage:a})=>a==Pn.NONE?[]:Array.from(new Set(n.flatMap(t=>Ci({instance:t,templateLanguage:a})))),Fi=({instances:n,templateLanguage:a,input:t})=>{if(a==Pn.NONE)return{variablesMap:{},variableKeys:[]};const l=Hu({instances:n,templateLanguage:a}),i=t.variablesValueCache??{};return{variablesMap:l.reduce((s,c)=>(s[c]=i[c]||"",s),{}),variableKeys:l}};function Rn(n,a){return n.invocationName===a.invocationName||n.canonicalName!=null&&a.canonicalName!=null&&n.canonicalName===a.canonicalName}const Gu=(n,a)=>n.filter(t=>a.some(l=>Rn(l,t))).map(t=>{var l;return{...t,invocationName:((l=a.find(i=>Rn(i,t)))==null?void 0:l.invocationName)??t.invocationName}}),Wa=n=>n.replace(/_([a-z])/g,(a,t)=>t.toUpperCase()),Wu=(n,a)=>Object.entries(n).map(([t,l])=>{const i=a.find(r=>r.canonicalName&&r.canonicalName.toLowerCase()===t.toLowerCase()||r.invocationName&&r.invocationName.toLowerCase()===t.toLowerCase());return i==null||i.invocationInputField==null||i.invocationName==null?null:{canonicalName:i.canonicalName,invocationName:i.invocationName,[Wa(i.invocationInputField)]:l}}).filter(t=>t!=null),Ra=n=>{const{provider:a,validatedToolDefinition:t}=Ld(n.definition);switch(a){case"OPENAI":case"AZURE_OPENAI":return t.function.name;case"ANTHROPIC":return t.name;case"UNKNOWN":return null;default:me()}},al=({provider:n,toolNumber:a})=>{switch(n){case"OPENAI":case"AZURE_OPENAI":return{id:Ea(),definition:Wt(a)};case"ANTHROPIC":return{id:Ea(),definition:wd(a)};case"GEMINI":return{id:Ea(),definition:Wt(a)};default:me()}},Ju=n=>{switch(n){case"OPENAI":case"AZURE_OPENAI":return Gt();case"ANTHROPIC":return Pd();case"GEMINI":return Gt();default:me()}};function Zu(n){return{content:n.content,role:Yu(n.role),toolCalls:n.toolCalls,toolCallId:n.toolCallId}}function Yu(n){switch(n){case"system":return"SYSTEM";case"user":return"USER";case"tool":return"TOOL";case"ai":return"AI";default:me()}}const Ki=({playgroundStore:n,instanceId:a,credentials:t})=>{const{instances:l}=n.getState(),i=l.find(m=>m.id===a);if(!i)throw new Error(`No instance found for id ${a}`);if(i.template.__type!=="chat")throw new Error("We only support chat templates for now");const r=i.model.supportedInvocationParameters;let s=[...i.model.invocationParameters];const c=ku({toolChoice:i.toolChoice,targetProvider:i.model.provider});i.tools.length>0?(s=s.filter(m=>m.invocationName!==_a&&m.canonicalName!==ya),s.push({canonicalName:ya,invocationName:_a,valueJson:c})):s=s.filter(m=>m.invocationName!==_a&&m.canonicalName!==ya),s=r.length?Gu(s,r):s;const d=i.model.provider==="AZURE_OPENAI"?{endpoint:i.model.endpoint,apiVersion:i.model.apiVersion}:{};return{messages:i.template.messages.map(Zu),model:{providerKey:i.model.provider,name:i.model.modelName||"",...d},invocationParameters:s,tools:i.tools.length?i.tools.map(m=>m.definition):void 0,apiKey:t[i.model.provider]||null}},Xu=({playgroundStore:n,instanceId:a,credentials:t})=>{const l=Ki({playgroundStore:n,instanceId:a,credentials:t}),{instances:i,templateLanguage:r,input:s}=n.getState(),{variablesMap:c}=Fi({instances:i,input:s,templateLanguage:r});return{...l,template:{variables:c,language:r}}},tl=({playgroundStore:n,instanceId:a,credentials:t,datasetId:l})=>({...Ki({playgroundStore:n,instanceId:a,credentials:t}),templateLanguage:n.getState().templateLanguage,datasetId:l});function xi(n){return n==null||n===""?"{}":typeof n=="string"?n:JSON.stringify(n,null,2)}function Ti(n,a){return a.filter(t=>t.required).every(t=>n.some(l=>Rn(l,t)))}const em=n=>{for(const[a,t]of Object.entries(n))if(a.endsWith("DefaultValue")&&t!=null)return n[a]};function I0(n,a){const t=new Map(n.map(l=>[l.canonicalName||l.invocationName,l]));return a.forEach(l=>{var d;const i=l.canonicalName||l.invocationName,r=em(l),s=Wa(l.invocationInputField||"");if(!l.invocationName||!l.invocationInputField||!i||r==null||((d=t.get(i))==null?void 0:d[s])!=null)return;const c={canonicalName:l.canonicalName,invocationName:l.invocationName,[s]:r};t.set(i,c)}),Array.from(t.values())}const Ii=u.createContext(null);function D0({children:n,...a}){const[t]=u.useState(()=>Ed(a));return e(Ii.Provider,{value:t,children:n})}function Va(n,a){const t=Se.useContext(Ii);if(!t)throw new Error("Missing CredentialsContext.Provider in the tree");return ba(t,n,a)}const Di=u.createContext(null);function nm(){const n=u.useContext(Di);if(n===null)throw new Error("useFunctionality must be used within a FunctionalityProvider");return n}function P0(n){return e(Di.Provider,{value:{authenticationEnabled:window.Config.authenticationEnabled},children:n.children})}const am=C`
  display: flex;
  direction: row;
  height: 100vh;
  overflow: hidden;
`,tm=C`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  height: 100%;
  overflow: hidden;
  padding-left: var(--px-nav-collapsed-width);
`,lm=C`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
`,im=C`
  display: flex;
  flex-direction: column;
  margin: 0;
  list-style: none;
  gap: var(--ac-global-dimension-size-50);
  padding-inline-start: 0;
`,rm=C`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-50);
`;function L0(){return o("div",{css:am,"data-testid":"layout",children:[e(sm,{}),o("div",{css:tm,children:[e(Rd,{children:e(_d,{})}),e("div",{"data-testid":"content",css:lm,children:e(u.Suspense,{fallback:e(ye,{}),children:e(Oe,{})})})]})]})}function sm(){const n=u.useMemo(()=>window.Config.hasInferences,[]),a=ve(),{authenticationEnabled:t}=nm(),l=X(),i=u.useCallback(async()=>{const r=await fetch(Fa("/auth/logout"),{method:"POST"});if(r.ok){l("/login");return}a({title:"Logout Failed",message:"Failed to log out: "+r.statusText})},[l,a]);return o($d,{children:[e(Ad,{}),o(h,{direction:"column",justifyContent:"space-between",flex:"1 1 auto",children:[o("ul",{css:rm,children:[n&&e("li",{children:e(Tn,{to:"/model",text:"Model",icon:e(L,{svg:e(I.CubeOutline,{})})})}),e("li",{children:e(Tn,{to:"/projects",text:"Projects",icon:e(L,{svg:e(I.GridOutline,{})})})}),e("li",{children:e(Tn,{to:"/datasets",text:"Datasets",icon:e(L,{svg:e(I.DatabaseOutline,{})})})}),e("li",{children:e(Tn,{to:"/playground",text:"Playground",icon:e(L,{svg:e(I.PlayCircleOutline,{})})})}),e("li",{children:e(Tn,{to:"/apis",text:"APIs",icon:e(L,{svg:e(I.Code,{})})})})]}),o("ul",{css:im,children:[e("li",{children:e(Tn,{to:"/settings",text:"Settings",icon:e(L,{svg:e(I.SettingsOutline,{})})})}),e("li",{children:e(Md,{})}),e("li",{children:e(Nd,{})}),e("li",{children:e(zd,{})}),t&&o(G,{children:[e("li",{children:e(Tn,{to:"/profile",text:"Profile",icon:e(L,{svg:e(I.PersonOutline,{})})})}),e("li",{children:e(Vd,{text:"Log Out",icon:e(L,{svg:e(I.LogOut,{})}),onClick:i})})]})]})]})]})}const Pi=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"exampleId"}],a=[{kind:"Variable",name:"id",variableName:"exampleId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},i={alias:"latestRevision",args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},s={alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[t,{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[r],storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null}],storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},d=[{kind:"Literal",name:"first",value:100}],m={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,i,s],type:"DatasetExample",abstractKey:null},{args:null,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[c,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[i,s,{alias:null,args:d,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},l,m,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},m],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[c],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experimentRuns(first:100)"},{alias:null,args:d,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"6fa23dc80c23ecdf48e57d139d76a721",id:null,metadata:{},name:"ExampleDetailsDialogQuery",operationKind:"query",text:`query ExampleDetailsDialogQuery(
  $exampleId: GlobalID!
) {
  example: node(id: $exampleId) {
    __typename
    ... on DatasetExample {
      id
      latestRevision: revision {
        input
        output
        metadata
      }
      span {
        id
        context {
          traceId
        }
        project {
          id
        }
      }
    }
    ...ExampleExperimentRunsTableFragment
    __isNode: __typename
    id
  }
}

fragment ExampleExperimentRunsTableFragment on DatasetExample {
  experimentRuns(first: 100) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              annotatorKind
              trace {
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Pi.hash="65b1c049bacc1ef8739c61af32a9414c";const Li=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"patchDatasetExamples",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditExampleDialogMutation",selections:a},params:{cacheID:"7217082d3d3796ecb60481d17133c351",id:null,metadata:{},name:"EditExampleDialogMutation",operationKind:"mutation",text:`mutation EditExampleDialogMutation(
  $input: PatchDatasetExamplesInput!
) {
  patchDatasetExamples(input: $input) {
    __typename
  }
}
`}}}();Li.hash="a5e0e601ed24ffaa37a99ba358f960d3";const lt={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function om(n){const{exampleId:a,onCompleted:t}=n,[l,i]=u.useState(null),[r,s]=D.useMutation(Li),{control:c,setError:d,handleSubmit:m,formState:{isValid:y}}=Ue({defaultValues:n.currentRevision}),g=u.useCallback(p=>{if(i(null),!ln(p==null?void 0:p.input))return d("input",{message:"Input must be a valid JSON object"});if(!ln(p==null?void 0:p.output))return d("output",{message:"Output must be a valid JSON object"});if(!ln(p==null?void 0:p.metadata))return d("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{patches:[{exampleId:a,input:JSON.parse(p.input),output:JSON.parse(p.output),metadata:JSON.parse(p.metadata)}],versionDescription:p.description}},onCompleted:()=>{t()},onError:f=>{i(f.message)}})},[r,a,d,t]);return e(Z,{size:"fullscreen",title:`Edit Example: ${a}`,extra:e(z,{variant:"primary",size:"compact",disabled:!y||s,loading:s,onClick:m(g),children:"Save Changes"}),children:e("div",{css:C`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
          /* Make widths configurable */
          .dataset-picker {
            width: 100%;
            .ac-dropdown--picker,
            .ac-dropdown-button {
              width: 100%;
            }
          }
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(K,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:o(h,{direction:"column",gap:"size-200",children:[l?e(ue,{variant:"danger",children:l}):null,e(W,{control:c,name:"input",render:({field:{onChange:p,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>o(q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...lt,children:[b?e(ue,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(_e,{value:k,onChange:p,onBlur:f})]})}),e(W,{control:c,name:"output",render:({field:{onChange:p,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>o(q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...lt,backgroundColor:"green-100",borderColor:"green-700",children:[b?e(ue,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(_e,{value:k,onChange:p,onBlur:f})]})}),e(W,{control:c,name:"metadata",render:({field:{onChange:p,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>o(q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...lt,children:[b?e(ue,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(_e,{value:k,onChange:p,onBlur:f})]})}),e(W,{control:c,name:"description",render:({field:{onChange:p,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>e(vt,{label:"Revision Description",value:k,onChange:p,onBlur:f,errorMessage:S==null?void 0:S.message,validationState:b?"invalid":"valid",placeholder:"A description of the changes made in this revision. Will be displayed in the version history.",height:100})})]})})})})})}function dm(n){const{onCompleted:a,...t}=n,[l,i]=u.useState(null);return o(G,{children:[e(z,{variant:"default",size:"compact",icon:e(L,{svg:e(I.EditOutline,{})}),onClick:()=>i(e(om,{...t,onCompleted:()=>{i(null),a()}})),children:"Edit Example"}),e(ee,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:l})]})}const wi=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},r,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"2ec7ead16e6df0877bc47db0ed7c7553",id:null,metadata:{},name:"ExampleExperimentRunsTableQuery",operationKind:"query",text:`query ExampleExperimentRunsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExampleExperimentRunsTableFragment_2HEEH6
    __isNode: __typename
    id
  }
}

fragment ExampleExperimentRunsTableFragment_2HEEH6 on DatasetExample {
  experimentRuns(first: $first, after: $after) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              annotatorKind
              trace {
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();wi.hash="6ca0f938b309407e8c184a1c13d1c52d";const Ei=function(){var n=["experimentRuns"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:wi,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExampleExperimentRunsTableFragment",selections:[{alias:"experimentRuns",args:null,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"__ExampleExperimentRunsTable_experimentRuns_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},t,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"DatasetExample",abstractKey:null}}();Ei.hash="6ca0f938b309407e8c184a1c13d1c52d";const cm=100;function um(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:n=>C`
            text-align: center;
            padding: ${n.spacing.margin24}px ${n.spacing.margin24}px !important;
          `,children:"No experiments have been run for this example."})})})}const mm=C`
  display: flex;
  flex-direction: row;
  align-items: center;
  color: var(--ac-global-color-primary);
  gap: var(--ac-global-dimension-size-50);
`;function gm({example:n}){const a=u.useRef(null),t=X(),{data:l,loadNext:i,hasNext:r,isLoadingNext:s}=D.usePaginationFragment(Ei,n),c=u.useMemo(()=>l.experimentRuns.edges.map(f=>{let k=null;return f.run.startTime&&f.run.endTime&&(k=new Date(f.run.endTime).getTime()-new Date(f.run.startTime).getTime()),{...f.run,output:JSON.stringify(f.run.output),latencyMs:k}}),[l]),m=Fe({columns:[{header:"start time",accessorKey:"startTime",cell:Ee},{header:"output",accessorKey:"output",cell:f=>{var b;const k=(b=f.row.original)==null?void 0:b.error;return k!==null?e(x,{color:"danger",children:k}):e(fe,{...f})}},{header:"latency",accessorKey:"latencyMs",cell:({getValue:f})=>{const k=f();return k===null||typeof k!="number"?"--":e(Ce,{latencyMs:k})}},{header:"evaluations",accessorKey:"annotations",cell:({row:f})=>e(h,{direction:"row",gap:"size-50",wrap:"wrap",children:f.original.annotations.edges.map((k,b)=>{const S=k.annotation;return e(ea,{annotation:S,extra:S.trace&&e(K,{paddingTop:"size-100",children:o("div",{css:mm,children:[e(L,{svg:e(I.InfoOutline,{})}),e("span",{children:"Click to view evaluator trace"})]})}),children:e(un,{annotation:S,onClick:()=>{S.trace&&t(`/projects/${S.trace.projectId}/traces/${S.trace.traceId}`)}},b)},b)})})},{id:"actions",cell:({row:f})=>{const k=f.original.trace;if(k)return e(z,{variant:"default",size:"compact",icon:e(L,{svg:e(I.Trace,{})}),onClick:()=>{t(`/projects/${k.projectId}/traces/${k.traceId}`)},"aria-label":"view trace"})}}],data:c,getCoreRowModel:Ke()}),y=m.getRowModel().rows,g=y.length===0,p=u.useCallback(f=>{if(f){const{scrollHeight:k,scrollTop:b,clientHeight:S}=f;k-b-S<300&&!s&&r&&i(cm)}},[r,s,i]);return e("div",{css:C`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:a,onScroll:f=>p(f.target),children:o("table",{css:$n,children:[e("thead",{children:m.getHeaderGroups().map(f=>e("tr",{children:f.headers.map(k=>e("th",{children:e("div",{children:J(k.column.columnDef.header,k.getContext())})},k.id))},f.id))}),g?e(um,{}):e("tbody",{children:y.map(f=>e("tr",{children:f.getVisibleCells().map(k=>e("td",{children:J(k.column.columnDef.cell,k.getContext())},k.id))},f.id))})]})})}function $t({exampleId:n,onDismiss:a}){const[t,l]=u.useState(0),i=D.useLazyLoadQuery(Pi,{exampleId:n},{fetchKey:t,fetchPolicy:"store-and-network"}),r=u.useMemo(()=>{const p=i.example.latestRevision;return{input:JSON.stringify(p==null?void 0:p.input,null,2),output:JSON.stringify(p==null?void 0:p.output,null,2),metadata:JSON.stringify(p==null?void 0:p.metadata,null,2)}},[i]),s=u.useMemo(()=>{const p=i.example.span;return p?{id:p.id,traceId:p.context.traceId,projectId:p.project.id}:null},[i]),{input:c,output:d,metadata:m}=r,y=X(),g=xe();return e(ee,{type:"slideOver",isDismissable:!0,onDismiss:a,children:e(Z,{size:"XL",title:`Example: ${n}`,extra:o(h,{direction:"row",gap:"size-100",children:[s?e(z,{variant:"default",size:"compact",onClick:()=>{y(`/projects/${s.projectId}/traces/${s.traceId}?selectedSpanNodeId=${s.id}`)},children:"View Source Span"}):null,e(dm,{exampleId:n,currentRevision:r,onCompleted:()=>{g({title:"Example updated",message:`Example ${n} has been updated.`}),l(p=>p+1)}})]}),children:o(on,{direction:"vertical",autoSaveId:"example-panel-group",children:[e(ke,{defaultSize:200,children:e("div",{css:C`
                overflow-y: auto;
                height: 100%;
              `,children:e(h,{direction:"row",justifyContent:"center",children:e(K,{width:"900px",paddingStart:"auto",paddingEnd:"auto",paddingTop:"size-200",paddingBottom:"size-200",children:o(h,{direction:"column",gap:"size-200",children:[e(q,{title:"Input",...it,extra:e(se,{text:c}),children:e(rn,{value:c})}),e(q,{title:"Output",...it,extra:e(se,{text:d}),children:e(rn,{value:d})}),e(q,{title:"Metadata",...it,extra:e(se,{text:m}),children:e(rn,{value:m})})]})})})})}),e(sn,{css:bn}),e(ke,{defaultSize:100,children:o(h,{direction:"column",height:"100%",children:[e(K,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(ce,{level:3,children:"Experiment Runs"})}),e(gm,{example:i.example})]})})]})})})}const it={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}};function w0(){const{exampleId:n,datasetId:a}=Ve(),t=X();return e($t,{exampleId:n,onDismiss:()=>{t(`/playground/datasets/${a}`)}})}const _i=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null}],type:"ProjectSession",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"aa110794a0fd7ac02812e8e14196930b",id:null,metadata:{},name:"sessionLoaderQuery",operationKind:"query",text:`query sessionLoaderQuery(
  $id: GlobalID!
) {
  session: node(id: $id) {
    __typename
    id
    ... on ProjectSession {
      sessionId
    }
  }
}
`}}}();_i.hash="26e5a5dbde9bd4ecfd7ae5fc1c078860";async function E0(n){const{sessionId:a}=n.params;return await D.fetchQuery(Me,_i,{id:a}).toPromise()}const Ri=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:"latencyP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:null,args:null,concreteType:"TraceConnection",kind:"LinkedField",name:"traces",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"trace",args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"rootSpan",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ProjectSession",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SessionDetailsQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SessionDetailsQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t],storageKey:null}]},params:{cacheID:"44f2433d50767bdcd9eb7c62d1f2cbb7",id:null,metadata:{},name:"SessionDetailsQuery",operationKind:"query",text:`query SessionDetailsQuery(
  $id: GlobalID!
) {
  session: node(id: $id) {
    __typename
    ... on ProjectSession {
      numTraces
      tokenUsage {
        total
        completion
        prompt
      }
      sessionId
      latencyP50: traceLatencyMsQuantile(probability: 0.5)
      traces {
        edges {
          trace: node {
            rootSpan {
              id
              attributes
              project {
                id
              }
              input {
                value
              }
              output {
                value
              }
              cumulativeTokenCountTotal
              cumulativeTokenCountCompletion
              cumulativeTokenCountPrompt
              latencyMs
              startTime
              spanAnnotations {
                name
                label
                score
                explanation
                annotatorKind
              }
              context {
                traceId
                spanId
              }
            }
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Ri.hash="4cf37bedf6f6d9f7b373d019055a89f4";function Ja(n){return u.useMemo(()=>n==="user"||n==="human"?{backgroundColor:"grey-100",borderColor:"grey-500"}:n==="assistant"||n==="ai"?{backgroundColor:"blue-100",borderColor:"blue-700"}:n==="system"?{backgroundColor:"indigo-100",borderColor:"indigo-700"}:["function","tool"].includes(n)?{backgroundColor:"yellow-100",borderColor:"yellow-700"}:{backgroundColor:"grey-100",borderColor:"grey-700"},[n])}function Ai({spanNodeId:n,projectId:a,size:t="default"}){const[l,i]=u.useState(null);return o(G,{children:[e(z,{variant:"default",size:t,icon:e(L,{svg:e(I.EditOutline,{})}),onClick:()=>i(e(zl,{spanNodeId:n,projectId:a})),children:"Annotate"}),e(ee,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:l})]})}const pm=n=>{const{json:a}=Ae(n);if(a==null||!yn(a))return null;const t=a[de.user];if(t==null||!yn(t))return null;const l=t[Zo.id];return pt.isString(l)||pt.isNumber(l)?l:null};function ll({role:n,value:a}){const t=Ja(n==="HUMAN"?"user":"assistant");return e(K,{alignSelf:n==="HUMAN"?"start":"end",borderRadius:"medium",borderColor:"dark",borderWidth:"thin",padding:"size-200",maxWidth:"70%",...t,children:o(h,{direction:"column",gap:"size-50",children:[e(x,{color:"text-700",textSize:"medium",children:n}),e(x,{children:a})]})})}function ym({rootSpan:n,index:a}){const t=u.useMemo(()=>new Date(n.startTime),[n.startTime]),l=u.useMemo(()=>pm(n.attributes),[n.attributes]);return e(K,{height:"100%",children:o(h,{direction:"column",justifyContent:"space-between",height:"100%",children:[o(h,{direction:"column",gap:"size-200",children:[o(h,{direction:"row",justifyContent:"space-between",children:[o(x,{children:["Trace #",a+1]}),e(Ge,{to:`/projects/${n.project.id}/traces/${n.context.traceId}?selectedSpanNodeId=${n.id}`,children:o(h,{alignItems:"center",children:["View Trace",e(L,{svg:e(I.ArrowIosForwardOutline,{})})]})})]}),o(h,{direction:"row",justifyContent:"space-between",children:[l!=null?o(x,{color:"text-700",children:["user: ",l]}):null,e(x,{color:"text-700",flex:"end",marginStart:"auto",children:Ze(t)})]}),o(h,{direction:"row",gap:"size-100",children:[e(Sn,{tokenCountTotal:n.cumulativeTokenCountTotal??0,tokenCountCompletion:n.cumulativeTokenCountCompletion??0,tokenCountPrompt:n.cumulativeTokenCountPrompt??0}),n.latencyMs!=null?e(Ce,{latencyMs:n.latencyMs}):"--"]})]}),o(h,{direction:"row",justifyContent:"space-between",alignItems:"end",children:[o(h,{direction:"column",gap:"size-100",maxWidth:"50%",children:[e(x,{textSize:"medium",children:"Feedback"}),e(h,{gap:"size-50",direction:"column",children:n.spanAnnotations.length>0?n.spanAnnotations.map(i=>e(ea,{annotation:i,children:e(un,{annotation:i,annotationDisplayPreference:"label"})},i.name)):"--"})]}),e("span",{children:e(Ai,{size:"compact",spanNodeId:n.id,projectId:n.project.id})})]})]})})}function fm({rootSpan:n}){var a,t;return o(h,{direction:"column",gap:"size-100",children:[e(ll,{role:"HUMAN",value:((a=n.input)==null?void 0:a.value)??"--"}),e(ll,{role:"AI",value:((t=n.output)==null?void 0:t.value)??"--"})]})}function hm({traces:n}){const a=u.useMemo(()=>((n==null?void 0:n.edges)||[]).map(({trace:l})=>l.rootSpan).filter(l=>l!=null),[n]);return e(K,{height:"100%",flex:"1 1 auto",overflow:"auto",children:a.map((t,l)=>e(K,{borderBottomColor:"dark",borderBottomWidth:"thin",children:o(h,{direction:"row",children:[e(K,{borderRightWidth:"thin",borderEndColor:"dark",padding:"size-200",flex:"1 1 auto",children:e(fm,{rootSpan:t})}),e(K,{width:350,padding:"size-200",flex:"none",children:e(ym,{rootSpan:t,index:l})})]})},t.context.spanId))})}function km({traceCount:n,tokenUsage:a,latencyP50:t}){return e(K,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:o(h,{direction:"row",gap:"size-400",children:[o(h,{direction:"column",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Traces Count"}),e(x,{textSize:"xlarge",children:n})]}),a!=null?o(h,{direction:"column",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Total Tokens"}),e(Sn,{tokenCountTotal:a.total,tokenCountCompletion:a.completion,tokenCountPrompt:a.prompt,textSize:"xlarge"})]}):null,t!=null?o(h,{direction:"column",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Latency P50"}),e(Ce,{latencyMs:t,textSize:"xlarge"})]}):null]})})}function bm(n){const{sessionId:a}=n,t=D.useLazyLoadQuery(Ri,{id:a},{fetchPolicy:"store-and-network"});if(t.session==null)throw new Error("Session not found");return o("main",{css:C`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        height: 100%;
        overflow: hidden;
      `,children:[e(km,{traceCount:t.session.numTraces??0,tokenUsage:t.session.tokenUsage,latencyP50:t.session.latencyP50}),e(hm,{traces:t.session.traces})]})}function _0(){var i;const n=kn(),{sessionId:a,projectId:t}=Ve(),l=X();return e(ee,{type:"slideOver",isDismissable:!0,onDismiss:()=>l(`/projects/${t}`),children:e(Z,{size:"fullscreen",title:`Session ID: ${((i=n.session)==null?void 0:i.sessionId)??"--"}`,children:e(Tt,{children:e(bm,{sessionId:a})})})})}const Mi=function(){var n=[{alias:null,args:null,concreteType:"Functionality",kind:"LinkedField",name:"functionality",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"modelInferences",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"homeLoaderQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"homeLoaderQuery",selections:n},params:{cacheID:"8bfba02258509f0b645b86f3322838d8",id:null,metadata:{},name:"homeLoaderQuery",operationKind:"query",text:`query homeLoaderQuery {
  functionality {
    modelInferences
  }
}
`}}}();Mi.hash="a248736e236c8d5348e0ecfbe9440ca2";async function R0(n){const a=await D.fetchQuery(Me,Mi,{}).toPromise();return a!=null&&a.functionality.modelInferences?Ma("/model"):Ma("/projects")}const Ni=function(){var n={defaultValue:null,kind:"LocalArgument",name:"endTime"},a={defaultValue:null,kind:"LocalArgument",name:"startTime"},t=[{kind:"Variable",name:"endTime",variableName:"endTime"},{kind:"Variable",name:"startTime",variableName:"startTime"}],l=[{kind:"Literal",name:"first",value:50}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={fields:[{kind:"Variable",name:"end",variableName:"endTime"},{kind:"Variable",name:"start",variableName:"startTime"}],kind:"ObjectValue",name:"timeRange"},c={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],m={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ModelPageQuery",selections:[{args:t,kind:"FragmentSpread",name:"ModelSchemaTable_dimensions"},{args:t,kind:"FragmentSpread",name:"ModelEmbeddingsTable_embeddingDimensions"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ModelPageQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:l,concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dimension",args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},{alias:"cardinality",args:[{kind:"Literal",name:"metric",value:"cardinality"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[{kind:"Literal",name:"metric",value:"percentEmpty"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"min",args:[{kind:"Literal",name:"metric",value:"min"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"mean",args:[{kind:"Literal",name:"metric",value:"mean"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"max",args:[{kind:"Literal",name:"metric",value:"max"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},s],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},c,{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:d,storageKey:null}],storageKey:null},m],storageKey:"dimensions(first:50)"},{alias:null,args:l,filters:null,handle:"connection",key:"ModelSchemaTable_dimensions",kind:"LinkedHandle",name:"dimensions"},{alias:null,args:l,concreteType:"EmbeddingDimensionConnection",kind:"LinkedField",name:"embeddingDimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"EmbeddingDimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"embedding",args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:"euclideanDistance",args:[{kind:"Literal",name:"metric",value:"euclideanDistance"},s],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},c,{alias:null,args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:d,storageKey:null}],storageKey:null},m],storageKey:"embeddingDimensions(first:50)"},{alias:null,args:l,filters:null,handle:"connection",key:"ModelEmbeddingsTable_embeddingDimensions",kind:"LinkedHandle",name:"embeddingDimensions"}],storageKey:null}]},params:{cacheID:"18059ac8df6b3c15d5e4bc04ca2c9877",id:null,metadata:{},name:"ModelPageQuery",operationKind:"query",text:`query ModelPageQuery(
  $startTime: DateTime!
  $endTime: DateTime!
) {
  ...ModelSchemaTable_dimensions_3uKjWt
  ...ModelEmbeddingsTable_embeddingDimensions_3uKjWt
}

fragment ModelEmbeddingsTable_embeddingDimensions_3uKjWt on Query {
  model {
    embeddingDimensions(first: 50) {
      edges {
        embedding: node {
          id
          name
          euclideanDistance: driftMetric(metric: euclideanDistance, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}

fragment ModelSchemaTable_dimensions_3uKjWt on Query {
  model {
    dimensions(first: 50) {
      edges {
        dimension: node {
          id
          name
          type
          dataType
          cardinality: dataQualityMetric(metric: cardinality, timeRange: {start: $startTime, end: $endTime})
          percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: {start: $startTime, end: $endTime})
          min: dataQualityMetric(metric: min, timeRange: {start: $startTime, end: $endTime})
          mean: dataQualityMetric(metric: mean, timeRange: {start: $startTime, end: $endTime})
          max: dataQualityMetric(metric: max, timeRange: {start: $startTime, end: $endTime})
          psi: driftMetric(metric: psi, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}
`}}}();Ni.hash="b612239336c7638df42037315b00f635";function A0(n){const{referenceInferences:a}=en(),{timeRange:t}=mn(),l=D.useLazyLoadQuery(Ni,{startTime:t.start.toISOString(),endTime:t.end.toISOString()});return o("main",{children:[o(It,{children:[e(Vl,{}),a?e($l,{inferencesRole:"reference",timeRange:{start:new Date(a.startTime),end:new Date(a.endTime)}}):null]}),e("section",{css:C`
          margin: var(--ac-global-dimension-static-size-200);
        `,children:e(Ct,{title:"Model Schema",variant:"compact",bodyStyle:{padding:0},children:o(Qe,{children:[e(ne,{name:"All",children:o(Be,{children:[e(be,{title:"Embeddings",id:"embeddings",children:e(Jt,{model:l})}),e(be,{title:"Dimensions",id:"dimensions",children:e(Zt,{model:l})})]})},"all"),e(ne,{name:"Embeddings",children:e(Jt,{model:l})},"embeddings"),e(ne,{name:"Dimensions",children:e(Zt,{model:l})},"dimensions")]})})}),e(Oe,{})]})}const zi={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MetricSelector_dimensions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],storageKey:null}]},params:{cacheID:"4ccf476dd862525b059197daccd0d4d9",id:null,metadata:{},name:"EmbeddingPageModelQuery",operationKind:"query",text:`query EmbeddingPageModelQuery {
  model {
    ...MetricSelector_dimensions
  }
}

fragment MetricSelector_dimensions on Model {
  numericDimensions: dimensions(include: {dataTypes: [numeric]}) {
    edges {
      node {
        id
        name
        type
      }
    }
  }
}
`}};zi.hash="374499f7f8ce6919e4a0a4ecbe380c52";const Vi=function(){var n={defaultValue:null,kind:"LocalArgument",name:"clusterMinSamples"},a={defaultValue:null,kind:"LocalArgument",name:"clusterSelectionEpsilon"},t={defaultValue:null,kind:"LocalArgument",name:"dataQualityMetricColumnName"},l={defaultValue:null,kind:"LocalArgument",name:"fetchDataQualityMetric"},i={defaultValue:null,kind:"LocalArgument",name:"fetchPerformanceMetric"},r={defaultValue:null,kind:"LocalArgument",name:"id"},s={defaultValue:null,kind:"LocalArgument",name:"minClusterSize"},c={defaultValue:null,kind:"LocalArgument",name:"minDist"},d={defaultValue:null,kind:"LocalArgument",name:"nNeighbors"},m={defaultValue:null,kind:"LocalArgument",name:"nSamples"},y={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},g={defaultValue:null,kind:"LocalArgument",name:"timeRange"},p=[{kind:"Variable",name:"id",variableName:"id"}],f={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},b={alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},v=[f,{alias:null,args:null,kind:"ScalarField",name:"eventId",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"coordinates",plural:!1,selections:[k,{kind:"InlineFragment",selections:[b,S,{alias:null,args:null,kind:"ScalarField",name:"z",storageKey:null}],type:"Point3D",abstractKey:null},{kind:"InlineFragment",selections:[b,S],type:"Point2D",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EmbeddingMetadata",kind:"LinkedField",name:"embeddingMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"linkToData",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"rawData",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null}],P=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],E={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"clusterMinSamples",variableName:"clusterMinSamples"},{kind:"Variable",name:"clusterSelectionEpsilon",variableName:"clusterSelectionEpsilon"},{kind:"Variable",name:"minClusterSize",variableName:"minClusterSize"},{kind:"Variable",name:"minDist",variableName:"minDist"},{kind:"Variable",name:"nNeighbors",variableName:"nNeighbors"},{kind:"Variable",name:"nSamples",variableName:"nSamples"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"UMAPPoints",kind:"LinkedField",name:"UMAPPoints",plural:!1,selections:[{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"data",plural:!0,selections:v,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"referenceData",plural:!0,selections:v,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"corpusData",plural:!0,selections:v,storageKey:null},{alias:null,args:null,concreteType:"Cluster",kind:"LinkedField",name:"clusters",plural:!0,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"eventIds",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"driftRatio",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"primaryToCorpusRatio",storageKey:null},{condition:"fetchDataQualityMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"columnName",variableName:"dataQualityMetricColumnName"},{kind:"Literal",name:"metric",value:"mean"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"dataQualityMetric",plural:!1,selections:P,storageKey:null}]},{condition:"fetchPerformanceMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"performanceMetric",plural:!1,selections:P,storageKey:null}]}],storageKey:null},{alias:null,args:null,concreteType:"Retrieval",kind:"LinkedField",name:"contextRetrievals",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"queryId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"relevance",storageKey:null}],storageKey:null}],storageKey:null}],type:"EmbeddingDimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t,l,i,r,s,c,d,m,y,g],kind:"Fragment",metadata:null,name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:p,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[E],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[r,g,c,d,m,s,n,a,l,t,i,y],kind:"Operation",name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:p,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[k,E,{kind:"TypeDiscriminator",abstractKey:"__isNode"},f],storageKey:null}]},params:{cacheID:"d30210c52f86b9d9a7ac958f866aa93e",id:null,metadata:{},name:"EmbeddingPageUMAPQuery",operationKind:"query",text:`query EmbeddingPageUMAPQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
  $minDist: Float!
  $nNeighbors: Int!
  $nSamples: Int!
  $minClusterSize: Int!
  $clusterMinSamples: Int!
  $clusterSelectionEpsilon: Float!
  $fetchDataQualityMetric: Boolean!
  $dataQualityMetricColumnName: String
  $fetchPerformanceMetric: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      UMAPPoints(timeRange: $timeRange, minDist: $minDist, nNeighbors: $nNeighbors, nSamples: $nSamples, minClusterSize: $minClusterSize, clusterMinSamples: $clusterMinSamples, clusterSelectionEpsilon: $clusterSelectionEpsilon) {
        data {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        referenceData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        corpusData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        clusters {
          id
          eventIds
          driftRatio
          primaryToCorpusRatio
          dataQualityMetric(metric: {columnName: $dataQualityMetricColumnName, metric: mean}) @include(if: $fetchDataQualityMetric) {
            primaryValue
            referenceValue
          }
          performanceMetric(metric: {metric: $performanceMetric}) @include(if: $fetchPerformanceMetric) {
            primaryValue
            referenceValue
          }
        }
        contextRetrievals {
          queryId
          documentId
          relevance
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Vi.hash="f1ee7ce02317f1c3fe96b77af405095f";function Sm(){const{theme:n}=On();return u.useMemo(()=>n==="light"?Od:Qd,[n])}function vm(){const{embeddingDimensionId:n}=Ve();if(!n)throw new Error("Missing embeddingDimensionId in URL params");return n}const $i={euclideanDistance:{name:"Euclidean Distance",shortName:"Euc. Distance",definition:"Euclidean distance over time captures how much your primary inferences's embeddings are drifting from the reference data. Euclidean distance of the embeddings is calculated by taking the centroid of the embedding vectors for each inferences and calculating the distance between the two centroids."},queryDistance:{name:"Query Distance",shortName:"Query Distance",definition:"The query distance is the euclidean distance of the centroid of queries from the centroid of the corpus."},accuracyScore:{name:"Accuracy Score",shortName:"Accuracy",definition:"Accuracy classification score. In multi-label classification, this function computes subset accuracy: the set of labels predicted for a sample must exactly match the corresponding set of labels in the ground truth."}};function wn(n){const a=$i[n];return a!=null?a.shortName:n}function rt(n){const a=$i[n];return a&&a.definition!=null&&a.definition||null}function qn(n){return`${n.column}:${n.dir}`}function Cm(){const{referenceInferences:n}=en(),a=!!n,t=B(d=>d.clusterSort),l=B(d=>d.setClusterSort),[i,r]=u.useState(!1),s=u.useMemo(()=>{const d=[];return a&&d.push({label:"Most drift",value:qn({column:"driftRatio",dir:"desc"})}),[...d,{label:"Largest clusters",value:qn({column:"size",dir:"desc"})},{label:"Smallest clusters",value:qn({column:"size",dir:"asc"})},{label:"Highest metric value",value:qn({column:"primaryMetricValue",dir:"desc"})},{label:"Lowest metric value",value:qn({column:"primaryMetricValue",dir:"asc"})}]},[a]),c=qn(t);return e("div",{css:d=>C`
        .ac-action-button {
          background: none;
          border: none;
          color: ${"var(--ac-global-text-color-700)"};
          font-size: ${d.typography.sizes.small.fontSize}px;
          line-height: ${d.typography.sizes.small.lineHeight}px;
          cursor: pointer;
          outline: none;
          &:hover {
            color: var(--ac-global-text-color-900);
          }
        }
      `,children:o(Zn,{placement:"bottom right","aria-label":"Sort clusters by",isOpen:i,onOpenChange:d=>r(d),children:[o(kd,{children:["Sort",e("span",{"aria-hidden":!0,"data-testid":"dropdown-caret",css:C`
              margin-left: var(--ac-global-dimension-static-size-50);
              border-bottom-color: #0000;
              border-left-color: #0000;
              border-right-color: #0000;
              border-style: solid;
              border-width: 3px 3px 0;
              content: "";
              display: inline-block;
              height: 0;
              vertical-align: middle;
              width: 0;
            `})]}),e(Oa,{children:e(Qa,{style:{width:200},selectedKeys:[c],selectionMode:"single",items:s,onSelectionChange:d=>{if(d instanceof Set&&d.size>0){const[m]=d.values(),[y,g]=m.split(":");l({column:y,dir:g})}r(!1)},children:d=>e(le,{children:d.label},d.value)})})]})})}const Oi=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"clusters"}],a=[{alias:null,args:[{kind:"Variable",name:"clusters",variableName:"clusters"}],concreteType:"ExportedFile",kind:"LinkedField",name:"exportClusters",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EmbeddingActionMenuExportClustersMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EmbeddingActionMenuExportClustersMutation",selections:a},params:{cacheID:"1bef6586fcb3d6eb7034204fbe49633c",id:null,metadata:{},name:"EmbeddingActionMenuExportClustersMutation",operationKind:"mutation",text:`mutation EmbeddingActionMenuExportClustersMutation(
  $clusters: [ClusterInput!]!
) {
  exportClusters(clusters: $clusters) {
    fileName
  }
}
`}}}();Oi.hash="b5ff2517dbb0d19a1b24dea1796a3576";function Fm(){const n=B(r=>r.clusters),{notifyError:a,notifySuccess:t}=Ol(),[l,i]=D.useMutation(Oi);return e(Nn,{align:"end",buttonSize:"compact",icon:i?e(L,{svg:e(I.LoadingOutline,{})}):null,onAction:r=>{switch(r){case"export_cluster":l({variables:{clusters:n.map(s=>({eventIds:s.eventIds,id:s.id}))},onCompleted:s=>{const{fileName:c}=s.exportClusters;t({title:"Clusters Exported",message:"dataframe is available via px.active_session().exports or can be downloaded by clicking below",action:{text:"Download",onClick:()=>{window.open(`/exports?filename=${c}`,"_self")}}})},onError:s=>{a({title:"Failed to export clusters",message:`Failed to export clusters: ${s.message}`})}});break}},children:o(le,{children:[e(L,{svg:e(I.Download,{})}),"Export clusters"]},"export_cluster")})}const Qi={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MetricSelector_dimensions",selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],type:"Model",abstractKey:null};Qi.hash="55d03de16503d7af254c17cef7d18ee0";const Bn=":";function Km(n){return["drift","performance","dataQuality","retrieval"].includes(n)}function oa(n){const{type:a,metric:t}=n;switch(a){case"drift":return`${a}${Bn}${t}`;case"retrieval":return`${a}${Bn}${t}`;case"performance":return`${a}${Bn}${t}`;case"dataQuality":{const{name:l}=n.dimension;return`${a}${Bn}${t}${Bn}${l}`}default:me()}}function xm({metricKey:n,dimensions:a}){const[t,l,i]=n.split(Bn);if(!Km(t))throw new Error(`Invalid metric type: ${t}`);switch(t){case"drift":return{type:t,metric:l};case"retrieval":return{type:t,metric:l};case"performance":return{type:t,metric:l};case"dataQuality":{const r=a.find(s=>s.name===i);if(!r)throw new Error(`Invalid dimension name: ${i}`);return{type:t,metric:l,dimension:r}}default:me()}}const Tm=o(Yn,{variant:"info",children:[e(ce,{level:4,children:"Analysis Metric"}),o(zn,{children:[e("p",{children:"Select a metric to drive the analysis of your embeddings."}),e("p",{children:"To analyze the the drift between your two inferencess, select a drift metric and the UI will highlight areas of high drift."}),e("p",{children:"To analyze the quality of your embeddings, select a dimension data quality metric by which to analyze the point cloud. The UI will highlight areas where the data quality is degrading."})]})]});function Im({model:n}){const[,a]=u.useTransition(),t=D.useFragment(Qi,n),{referenceInferences:l,corpusInferences:i}=en(),r=!!l,s=!!i,c=B(f=>f.metric),d=B(f=>f.loading),m=B(f=>f.setMetric),y=t.numericDimensions.edges.map(f=>f.node),g=y.length>0,p=u.useCallback(f=>{const k=xm({metricKey:f,dimensions:y});a(()=>{m(k)})},[m,y,a]);return o(va,{label:"metric",labelExtra:Tm,selectedKey:c?oa(c):void 0,onSelectionChange:p,placeholder:"Select a metric...",isDisabled:d,children:[r?e(Da,{title:"Drift",children:e(le,{children:"Euclidean Distance"},oa({type:"drift",metric:"euclideanDistance"}))}):null,s?e(Da,{title:"Retrieval",children:e(le,{children:"Query Distance"},oa({type:"retrieval",metric:"queryDistance"}))}):null,e(Da,{title:"Performance",children:e(le,{children:"Accuracy Score"},oa({type:"performance",metric:"accuracyScore"}))}),g?e(Da,{title:"Data Quality",children:y.map(f=>e(le,{children:`${f.name} avg`},oa({type:"dataQuality",metric:"average",dimension:f})))}):null]})}const ji=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"embeddingDimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"fetchDataQuality"},i={defaultValue:null,kind:"LocalArgument",name:"fetchDrift"},r={defaultValue:null,kind:"LocalArgument",name:"fetchPerformance"},s={defaultValue:null,kind:"LocalArgument",name:"fetchQueryDistance"},c={defaultValue:null,kind:"LocalArgument",name:"metricGranularity"},d={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},m={defaultValue:null,kind:"LocalArgument",name:"timeRange"},y=[{kind:"Variable",name:"id",variableName:"embeddingDimensionId"}],g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},p={kind:"Variable",name:"granularity",variableName:"metricGranularity"},f={kind:"Variable",name:"timeRange",variableName:"timeRange"},k=[p,{kind:"Literal",name:"metric",value:"euclideanDistance"},f],b=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],S={kind:"InlineFragment",selections:[{condition:"fetchDrift",kind:"Condition",passingValue:!0,selections:[{alias:"euclideanDistanceTimeSeries",args:k,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:b,storageKey:null}]},{condition:"fetchQueryDistance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:k,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"retrievalMetricTimeSeries",plural:!1,selections:b,storageKey:null}]},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},f],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:b,storageKey:null}],type:"EmbeddingDimension",abstractKey:null},v=[{kind:"Variable",name:"id",variableName:"dimensionId"}],P={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:[p,{kind:"Literal",name:"metric",value:"mean"},f],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:b,storageKey:null}],type:"Dimension",abstractKey:null},E={alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{condition:"fetchPerformance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[p,{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"},f],concreteType:"PerformanceTimeSeries",kind:"LinkedField",name:"performanceTimeSeries",plural:!1,selections:b,storageKey:null}]}],storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:[n,a,t,l,i,r,s,c,d,m],kind:"Fragment",metadata:null,name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:y,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:v,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[P],storageKey:null}]},E],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,m,c,n,i,s,l,a,r,d],kind:"Operation",name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:y,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[R,g,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:v,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[R,P,{kind:"TypeDiscriminator",abstractKey:"__isNode"},g],storageKey:null}]},E]},params:{cacheID:"a68a8204bf7fdd13e6915b338d4b5497",id:null,metadata:{},name:"MetricTimeSeriesQuery",operationKind:"query",text:`query MetricTimeSeriesQuery(
  $embeddingDimensionId: GlobalID!
  $timeRange: TimeRange!
  $metricGranularity: Granularity!
  $countGranularity: Granularity!
  $fetchDrift: Boolean!
  $fetchQueryDistance: Boolean!
  $fetchDataQuality: Boolean!
  $dimensionId: GlobalID!
  $fetchPerformance: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $embeddingDimensionId) {
    __typename
    id
    ... on EmbeddingDimension {
      euclideanDistanceTimeSeries: driftTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchDrift) {
        data {
          timestamp
          value
        }
      }
      retrievalMetricTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchQueryDistance) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
  dimension: node(id: $dimensionId) @include(if: $fetchDataQuality) {
    __typename
    ... on Dimension {
      name
      dataQualityTimeSeries(metric: mean, timeRange: $timeRange, granularity: $metricGranularity) {
        data {
          timestamp
          value
        }
      }
    }
    __isNode: __typename
    id
  }
  model {
    performanceTimeSeries(metric: {metric: $performanceMetric}, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchPerformance) {
      data {
        timestamp
        value
      }
    }
  }
}
`}}}();ji.hash="f31abad2141a5a1c461ef2a598ffa4f3";const il=new Intl.NumberFormat([],{maximumFractionDigits:2}),qi=()=>{const n=gn(),a=n.blue400,t=n.gray500;return{color:a,barColor:t}};function Dm({active:n,payload:a,label:t}){var r,s,c;const{color:l,barColor:i}=qi();if(n&&a&&a.length){const d=((r=a[1])==null?void 0:r.value)??null,m=((s=a[0])==null?void 0:s.value)??null,y=typeof d=="number"?il.format(d):"--",g=typeof m=="number"?il.format(m):"--";return o(vn,{children:[e(x,{weight:"heavy",textSize:"medium",children:`${Ze(new Date(t))}`}),e(we,{color:l,name:((c=a[1])==null?void 0:c.payload.metricName)??"Metric",value:y}),e(we,{color:i,shape:"square",name:"Count",value:g}),e(Ua,{}),o("div",{css:C`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);

            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(L,{svg:e(Dl,{})}),e("span",{children:"Click to view the point cloud at this time"})]})]})}return null}function Pm(n){switch(n.type){case"drift":return"Embedding Drift";case"performance":return"Model Performance";case"dataQuality":return"Data Quality";case"retrieval":return"Query Distance";default:me()}}function Lm(n){if(n)switch(n.type){case"drift":return wn(n.metric);case"performance":return wn(n.metric);case"dataQuality":return`${n.dimension.name} avg`;case"retrieval":return wn(n.metric);default:me()}else return"Count"}function wm(n){switch(n.type){case"drift":return rt(n.metric);case"performance":return rt(n.metric);case"dataQuality":return null;case"retrieval":return rt(n.metric);default:me()}}function Em({embeddingDimensionId:n}){const a=B(F=>F.metric),t=a.type==="drift",l=a.type==="retrieval",i=a.type==="dataQuality",r=a.type==="performance",{timeRange:s}=mn(),{selectedTimestamp:c,setSelectedTimestamp:d}=qa(),m=na(s),y=D.useLazyLoadQuery(ji,{embeddingDimensionId:n,timeRange:{start:s.start.toISOString(),end:s.end.toISOString()},metricGranularity:Ql(s),countGranularity:m,fetchDrift:t,fetchQueryDistance:l,fetchDataQuality:i,fetchPerformance:r,dimensionId:a.type==="dataQuality"?a.dimension.id:n,performanceMetric:a.type==="performance"?a.metric:"accuracyScore"}),g=aa({samplingIntervalMinutes:m.samplingIntervalMinutes}),p=u.useCallback(F=>{const{activePayload:T}=F;if(T!=null&&T.length>0){const w=T[0].payload;d(new Date(w.timestamp))}},[d]),f=_m({data:y,metric:a}),b=Rm(y).reduce((F,T)=>(F[T.timestamp]=T.value,F),{})??{},S=f.map(F=>{const T=b[F.timestamp];return{...F,traffic:T,timestamp:new Date(F.timestamp).getTime()}}),v=Lm(a),P=wm(a),{color:E,barColor:R}=qi();return o("section",{css:C`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        h3 {
          padding: var(--ac-global-dimension-static-size-50)
            var(--ac-global-dimension-static-size-200) 0
            var(--ac-global-dimension-static-size-200);
          flex: none;
          display: flex;
          flex-direction: row;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-50);
        }
        & > div {
          flex: 1 1 auto;
          width: 100%;
          overflow: hidden;
        }
      `,children:[o(ce,{level:3,children:[Pm(a),P!=null?o(Yn,{children:[e(ce,{level:4,children:v}),e(zn,{children:P})]}):null]}),e("div",{children:e(Cn,{width:"100%",height:"100%",children:o(xa,{data:S,margin:{top:25,right:18,left:18,bottom:10},onClick:p,children:[o("defs",{children:[o("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:E,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:E,stopOpacity:0})]}),o("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:R,stopOpacity:.3}),e("stop",{offset:"95%",stopColor:R,stopOpacity:0})]})]}),e(Fn,{...ta,tickFormatter:F=>g(new Date(F)),style:{fill:"var(--ac-global-text-color-700)"}}),e(Xe,{stroke:De.colors.gray200,label:{value:v,angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Xe,{yAxisId:"right",orientation:"right",label:{value:"Count",angle:90,position:"insideRight",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Kn,{strokeDasharray:"4 4",stroke:De.colors.gray200,strokeOpacity:.5}),e(xn,{content:e(Dm,{})}),e(Jn,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(ha,{type:"monotone",dataKey:"value",stroke:E,fillOpacity:1,fill:"url(#colorUv)"}),c!=null?e(gi,{...jl,x:c.getTime()}):null]})})})]})}function _m({data:n,metric:a}){var t,l,i,r,s,c;if(((t=n.embedding.euclideanDistanceTimeSeries)==null?void 0:t.data)!=null&&n.embedding.euclideanDistanceTimeSeries.data.length>0)return n.embedding.euclideanDistanceTimeSeries.data.map(d=>({metricName:wn(a.metric),...d}));if(((l=n.embedding.retrievalMetricTimeSeries)==null?void 0:l.data)!=null&&n.embedding.retrievalMetricTimeSeries.data.length>0)return n.embedding.retrievalMetricTimeSeries.data.map(d=>({metricName:wn(a.metric),...d}));if(n.dimension&&((r=(i=n.dimension)==null?void 0:i.dataQualityTimeSeries)==null?void 0:r.data)!=null&&n.dimension.dataQualityTimeSeries.data.length>0){const d=n.dimension.name||"unknown";return n.dimension.dataQualityTimeSeries.data.map(m=>({metricName:`${d} avg`,...m}))}else{if(n.model&&((s=n.model.performanceTimeSeries)==null?void 0:s.data)!=null&&n.model.performanceTimeSeries.data.length>0)return n.model.performanceTimeSeries.data.map(d=>({metricName:wn(a.metric),...d}));if(((c=n.embedding.trafficTimeSeries)==null?void 0:c.data)!=null)return n.embedding.trafficTimeSeries.data.map(d=>({metricName:"Count",...d}))}return[]}function Rm(n){var a;return((a=n.embedding.trafficTimeSeries)==null?void 0:a.data)!=null?[...n.embedding.trafficTimeSeries.data]:[]}const Ui=function(){var n={defaultValue:null,kind:"LocalArgument",name:"corpusEventIds"},a={defaultValue:null,kind:"LocalArgument",name:"primaryEventIds"},t={defaultValue:null,kind:"LocalArgument",name:"referenceEventIds"},l=[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:"DimensionWithValue",kind:"LinkedField",name:"dimensions",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"dimension",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptResponse",kind:"LinkedField",name:"promptAndResponse",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"response",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentText",storageKey:null}],i=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"primaryEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:l,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"referenceEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:l,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"corpusEventIds"}],concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:l,storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"PointSelectionPanelContentQuery",selections:i,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,n],kind:"Operation",name:"PointSelectionPanelContentQuery",selections:i},params:{cacheID:"8b48064eba35d0d6c8dc834c2f7795c0",id:null,metadata:{},name:"PointSelectionPanelContentQuery",operationKind:"query",text:`query PointSelectionPanelContentQuery(
  $primaryEventIds: [ID!]!
  $referenceEventIds: [ID!]!
  $corpusEventIds: [ID!]!
) {
  model {
    primaryInferences {
      events(eventIds: $primaryEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    referenceInferences {
      events(eventIds: $referenceEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    corpusInferences {
      events(eventIds: $corpusEventIds) {
        id
        dimensions {
          dimension {
            name
            type
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
  }
}
`}}}();Ui.hash="4bd627481610322f2acbcf73dfbfaadc";const rl=C`
  margin: var(--ac-global-dimension-static-size-200);
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-static-size-100);
  & > div {
    display: flex;
    flex-direction: row;
    dt {
      font-weight: bold;
      flex: none;
      width: 130px;
    }
    dd {
      flex: 1 1 auto;
      margin-inline-start: 0;
    }
  }
`;function da(n){return e("div",{css:C`
        max-height: 200px;
        overflow-y: auto;
      `,children:e("pre",{css:C`
          padding: var(--ac-global-dimension-static-size-200);
          color: var(--ac-global-text-color-900);
          white-space: normal;
          margin: 0;
        `,children:n.children})})}function Am({event:n}){const a=n.retrievedDocuments&&n.retrievedDocuments.length>0,t=!n.id.includes("CORPUS");return o("section",{css:C`
        height: 100%;
        overflow-y: auto;
      `,children:[e(Vm,{event:n}),o(Be,{children:[t?e(be,{id:"prediction",title:"Prediction Details",children:o("dl",{css:rl,children:[n.predictionId!=null&&o("div",{children:[e("dt",{children:"Prediction ID"}),e("dd",{css:C`
                      display: flex;
                      align-items: center;
                    `,children:n.predictionId})]}),n.predictionLabel!=null&&o("div",{children:[e("dt",{children:"Prediction Label"}),e("dd",{children:n.predictionLabel})]}),n.predictionScore!=null&&o("div",{children:[e("dt",{children:"Prediction Score"}),e("dd",{children:n.predictionScore})]}),n.actualLabel!=null&&o("div",{children:[e("dt",{children:"Actual Label"}),e("dd",{children:n.actualLabel})]}),n.actualScore!=null&&o("div",{children:[e("dt",{children:"Actual Score"}),e("dd",{children:n.actualScore})]})]})}):e(be,{id:"document",title:"Document Details",children:e("dl",{css:rl,children:n.predictionId!=null&&o("div",{children:[e("dt",{children:"Document ID"}),e("dd",{css:C`
                      display: flex;
                      align-items: center;
                    `,children:n.predictionId})]})})}),e(be,{id:"dimensions",title:"Dimensions",children:e(Nm,{dimensions:n.dimensions})}),a&&e(be,{id:"retrievals",title:"Retrieved Documents",titleExtra:e(Je,{variant:"light",children:n.retrievedDocuments.length}),children:e("ul",{css:C`
                padding: var(--ac-global-dimension-static-size-100);
                li + li {
                  margin-top: var(--ac-global-dimension-static-size-100);
                }
              `,children:n.retrievedDocuments.map(l=>e("li",{children:e(Mm,{document:l})},l.id))})})]})]})}function Mm({document:n}){return e(K,{borderRadius:"medium",backgroundColor:"light",children:o(h,{direction:"column",children:[e(K,{width:"100%",borderBottomWidth:"thin",borderBottomColor:"dark",children:o(h,{direction:"row",justifyContent:"space-between",margin:"size-100",alignItems:"center",children:[o(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(I.FileOutline,{})}),o(ce,{level:4,children:["document ",n.id]})]}),typeof n.relevance=="number"&&e(wa,{color:"blue",children:`relevance ${Dt(n.relevance)}`})]})}),e("pre",{css:C`
            padding: var(--ac-global-dimension-static-size-200);
            white-space: normal;
            margin: 0;
          `,children:n.text})]})})}function Nm({dimensions:n}){const a=u.useMemo(()=>n.map(i=>({name:i.dimension.name,type:i.dimension.type,value:i.value??"--"})),[n]),t=u.useMemo(()=>[{header:()=>"Name",accessorKey:"name"},{header:()=>"Type",accessorKey:"type"},{header:()=>"Value",accessorKey:"value"}],[]),l=Fe({columns:t,data:a,getCoreRowModel:Ke()});return o("table",{css:nn,children:[e("thead",{children:l.getHeaderGroups().map(i=>e("tr",{children:i.headers.map(r=>e("th",{colSpan:r.colSpan,children:r.isPlaceholder?null:e("div",{children:J(r.column.columnDef.header,r.getContext())})},r.id))},i.id))}),l.getCoreRowModel().rows.length?e("tbody",{children:l.getRowModel().rows.map(i=>e("tr",{children:i.getVisibleCells().map(r=>e("td",{children:J(r.column.columnDef.cell,r.getContext())},r.id))},i.id))}):e($m,{})]})}function zm({dataUrl:n}){const a=jd(n),t=qd(n);return a?e("video",{src:n,controls:!0,css:C`
          width: 100%;
          height: 500px;
          background-color: black;
        `}):t?e("audio",{src:n,controls:!0,autoPlay:!0}):e("img",{src:n,alt:"event image",width:"100%",height:"200px",css:C`
        object-fit: contain;
        background-color: black;
      `})}function Vm({event:n}){const a=n.linkToData||void 0,t=n.rawData,l=n.prompt||n.response?{prompt:n.prompt,response:n.response}:null,i=n.documentText;let r=null;return a?r=o(h,{direction:"column",children:[e(zm,{dataUrl:a}),t&&e(Be,{children:e(be,{id:"raw",title:"Raw Data",children:e(da,{children:t})})})]}):i?r=e(Be,{children:e(be,{id:"document",title:"Document",children:e(da,{children:i})})}):l?r=o(Be,{children:[e(be,{id:"prompt",title:"Prompt",children:e(da,{children:l.prompt})}),e(be,{id:"response",title:"Response",children:e(da,{children:l.response})})]}):n.rawData&&n.rawData&&n.rawData,r}function $m(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:n=>C`
            text-align: center;
            padding: ${n.spacing.margin24}px ${n.spacing.margin24}px !important;
          `,children:e(ql,{graphicKey:"documents",message:"This embedding has no associated dimensions"})})})})}const Bi=function(){var n=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"ExportedFile",kind:"LinkedField",name:"exportedFiles",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExportSelectionButtonExportsQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ExportSelectionButtonExportsQuery",selections:n},params:{cacheID:"2f7e3554305121746dc799b6a8d120da",id:null,metadata:{},name:"ExportSelectionButtonExportsQuery",operationKind:"query",text:`query ExportSelectionButtonExportsQuery {
  model {
    exportedFiles {
      fileName
    }
  }
}
`}}}();Bi.hash="7e6db431afe21f137e54505645c787f4";const Hi=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"eventIds"}],a=[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"eventIds"}],concreteType:"ExportedFile",kind:"LinkedField",name:"exportEvents",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExportSelectionButtonMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExportSelectionButtonMutation",selections:a},params:{cacheID:"d370df04ca30a5059288c7aa298239a8",id:null,metadata:{},name:"ExportSelectionButtonMutation",operationKind:"mutation",text:`mutation ExportSelectionButtonMutation(
  $eventIds: [ID!]!
) {
  exportEvents(eventIds: $eventIds) {
    fileName
  }
}
`}}}();Hi.hash="8b0d6962e2034d4c148d1b9919111d2f";const Om=`import phoenix as px

exports = px.active_session().exports
dataframe = exports[-1]
dataframe`,Qm=C`
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100);
  }
`;function jm({value:n}){const{theme:a}=On(),t=a==="light"?void 0:ra;return e(ia,{value:n,basicSetup:!1,extensions:[Mt()],editable:!1,theme:t,css:Qm})}function qm(){const n=B(s=>s.selectedEventIds),[a,t]=D.useMutation(Hi),[l,i]=u.useState(null),r=u.useCallback(()=>{a({variables:{eventIds:[...n]},onCompleted:s=>{i(s.exportEvents)}})},[a,n]);return o(G,{children:[e(z,{variant:"default",size:"compact",icon:e(L,{svg:e(Pl,{})}),"aria-label":"Export selection / cluster",loading:t,onClick:r,children:t?"Exporting":"Export"}),e(ee,{type:"slideOver",isDismissable:!0,onDismiss:()=>i(null),children:l!=null&&o(Z,{title:"Cluster Exports",size:"M",children:[e(ue,{variant:"success",banner:!0,title:"Export succeeded",extra:e(z,{variant:"success",size:"compact",onClick:()=>{window.open(`/exports?filename=${l.fileName}`,"_self")},children:"Download"})}),o("div",{css:C`
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                align-items: flex-start;
                padding: 16px;
                gap: 16px;
              `,children:[e("p",{css:C`
                  margin: 0;
                  flex: 1 1 auto;
                `,children:"You can retrieve your export in your notebook via"}),e(K,{borderColor:"light",borderWidth:"thin",borderRadius:"medium",children:e(jm,{value:Om})})]}),e(Be,{children:e(be,{id:"all-exports",title:"Latest Exports",children:e(u.Suspense,{fallback:e(ye,{}),children:e(Um,{})})})})]})})]})}function Um(){const n=D.useLazyLoadQuery(Bi,{},{fetchPolicy:"network-only"});return e(wl,{children:n.model.exportedFiles.map((a,t)=>e(Ll,{children:o("div",{css:C`
              display: flex;
              flex-direction: row;
              justify-content: space-between;
              align-items: center;
            `,children:[a.fileName,e(z,{size:"compact","aria-label":"Download",variant:"default",icon:e(L,{svg:e(Pl,{})}),onClick:()=>{window.open(`/exports?filename=${a.fileName}`,"_self")}})]})},t))})}function Bm(n){const{getInferencesNameByRole:a}=en(),{events:t,onItemSelected:l}=n,i=B(m=>m.eventIdToDataMap),r=B(m=>m.eventIdToGroup),s=B(m=>m.pointGroupColors),c=B(m=>m.selectionGridSize),d=B(m=>m.setHoveredEventId);return e("div",{css:C`
        flex: 1 1 auto;
        overflow-y: auto;
      `,"data-testid":"grid-view-scroll-container",children:e("ul",{"data-grid-size":c,css:C`
          &[data-grid-size="small"] {
            --grid-item-min-width: 100px;
            --grid-item-height: 100px;
          }
          &[data-grid-size="medium"] {
            --grid-item-min-width: 200px;
            --grid-item-height: 200px;
          }
          &[data-grid-size="large"] {
            --grid-item-min-width: 300px;
            --grid-item-height: 200px;
          }
          padding: var(--ac-global-dimension-static-size-200);
          transition: all 0.2s ease-in-out;
          display: grid;
          grid-template-columns: repeat(
            auto-fill,
            minmax(var(--grid-item-min-width), 1fr)
          );
          flex-wrap: wrap;
          gap: var(--ac-global-dimension-static-size-200);
          & > li {
            min-width: var(--grid-item-min-width);
            height: var(--grid-item-height);
          }
        `,children:t.map((m,y)=>{const g=i.get(m.id),{rawData:p=null,linkToData:f=null}=(g==null?void 0:g.embeddingMetadata)??{},{predictionLabel:k=null,actualLabel:b=null}=(g==null?void 0:g.eventMetadata)??{},S=Ud(m.id),v=a(S),P=r[m.id],E=s[P];return e("li",{children:e(Bd,{rawData:p,linkToData:f,inferencesName:v,group:P,onClick:()=>{l(m.id)},onMouseOver:()=>{d(m.id)},onMouseOut:()=>{d(null)},color:E,size:c,predictionLabel:k,actualLabel:b,promptAndResponse:m.promptAndResponse,documentText:m.documentText,autoPlay:!1})},y)})})})}function Hm({data:n,onPointSelected:a}){const{primaryInferences:t,referenceInferences:l}=en(),i=B(y=>y.metric),[r,s]=u.useState([]),{columns:c,tableData:d}=u.useMemo(()=>{const y=n.filter(E=>E.id.includes("CORPUS")===!1);let g=!1,p=!1,f=!1,k=!1,b=!1;n.forEach(E=>{E.linkToData&&(g=!0),E.rawData&&(p=!0),(E.prompt||E.response)&&(f=!0),E.predictionLabel&&(k=!0),E.actualLabel&&(b=!0)});const S=[];l&&S.push({header:"Inference Set",accessorKey:"id",size:50,cell:({getValue:E})=>e(Gm,{id:E(),primaryInferencesName:t.name,referenceInferencesName:(l==null?void 0:l.name)??"reference"})}),g&&S.push({header:"Link",accessorKey:"linkToData",cell:({getValue:E})=>{const R=E();if(typeof R=="string"){const F=R.split("/").pop();return e(He,{href:R,children:F})}return null}}),f?(S.push({header:"Prompt",accessorKey:"prompt",cell:fe,size:200}),S.push({header:"Response",accessorKey:"response",cell:fe,size:200})):p&&S.push({header:"Raw Data",accessorKey:"rawData"}),k&&S.push({header:"Prediction Label",accessorKey:"predictionLabel",size:50}),b&&S.push({header:"Actual Label",accessorKey:"actualLabel",size:50});const v=[];if(i&&i.type==="dataQuality"){const E=i.dimension.name;v.push({header:i.dimension.name,accessorKey:"metric",cell:Hd,sortingFn:"basic"}),y.forEach(R=>{var T;const F=(T=R.dimensions.find(w=>w.dimension.name===E))==null?void 0:T.value;R.metric=F!=null?Number(F):null})}return{columns:[...S,...v,{header:"",id:"view-details",size:50,cell:({row:E})=>e(Gd,{"aria-label":"view point details",onClick:()=>{a(E.original.id)},children:"view details"})}],tableData:y}},[n,a,t,l,i]),m=Fe({columns:c,data:d,state:{sorting:r},getCoreRowModel:Ke(),onSortingChange:s,getSortedRowModel:Mn()});return o("table",{css:nn,children:[e("thead",{children:m.getHeaderGroups().map(y=>e("tr",{children:y.headers.map(g=>o("th",{children:[g.isPlaceholder?null:o("div",{className:g.column.getCanSort()?"cursor-pointer":"",onClick:g.column.getToggleSortingHandler(),children:[J(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(L,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(I.ArrowDownFilled,{}):e(I.ArrowUpFilled,{})}):null]}),e("div",{onMouseDown:g.getResizeHandler(),onTouchStart:g.getResizeHandler(),className:`resizer ${g.column.getIsResizing()?"isResizing":""}`,style:{transform:g.column.getIsResizing()?`translateX(${m.getState().columnSizingInfo.deltaOffset}px)`:""}})]},g.id))},y.id))}),e("tbody",{children:m.getRowModel().rows.map(y=>e("tr",{children:y.getVisibleCells().map(g=>e("td",{style:{width:g.column.getSize()},children:J(g.column.columnDef.cell,g.getContext())},g.id))},y.id))})]})}function Gm({id:n,primaryInferencesName:a,referenceInferencesName:t}){const l=n.includes("PRIMARY"),i=Sm();return o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Jd,{shape:Wd.circle,color:i[l?0:1]}),l?a:t]})}const Wm=C`
  width: 100%;
  height: 100%;
  position: relative;
  display: flex;
  flex-direction: column;
  /* Give spacing for the close icon */
  & > .ac-tabs {
    padding-top: 17px;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    [role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      display: flex;
      flex-direction: column;
      flex: 1 1 auto;
      overflow: hidden;
      [role="tabpanel"] {
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        overflow: hidden;
      }
    }
  }
`;function Jm({event:n,relevance:a}){return{id:n.eventMetadata.predictionId||"unknown id",text:n.documentText??"empty document",relevance:a}}function Zm(){const n=B(F=>F.selectedEventIds),a=B(F=>F.setSelectedEventIds),t=B(F=>F.setSelectedClusterId),l=B(F=>F.selectionDisplay),[i,r]=Se.useState(null),{primaryEventIds:s,referenceEventIds:c,corpusEventIds:d}=u.useMemo(()=>{const F=[],T=[],w=[];return n.forEach(_=>{_.includes("PRIMARY")?F.push(_):_.includes("CORPUS")?w.push(_):T.push(_)}),{primaryEventIds:F,referenceEventIds:T,corpusEventIds:w}},[n]),m=D.useLazyLoadQuery(Ui,{primaryEventIds:[...s],referenceEventIds:[...c],corpusEventIds:[...d]}),y=u.useMemo(()=>{var _,Q,V,H,te,oe;const F=((Q=(_=m.model)==null?void 0:_.primaryInferences)==null?void 0:Q.events)??[],T=((H=(V=m.model)==null?void 0:V.referenceInferences)==null?void 0:H.events)??[],w=((oe=(te=m.model)==null?void 0:te.corpusInferences)==null?void 0:oe.events)??[];return[...F,...T,...w]},[m]),g=()=>{a(new Set),t(null)},p=B(F=>F.eventIdToDataMap),f=B(F=>F.pointData),k=B(F=>F.selectionSearchText),b=u.useMemo(()=>y.map(F=>{var _,Q,V,H,te,oe,N;const T=p.get(F.id),w=[];return f!=null&&(T==null?void 0:T.retrievals)!=null&&T.retrievals.forEach(({documentId:j,relevance:M})=>{const U=f[j];U!=null&&w.push(Jm({event:U,relevance:M}))}),{id:F.id,predictionId:((_=F.eventMetadata)==null?void 0:_.predictionId)??null,actualLabel:((Q=F.eventMetadata)==null?void 0:Q.actualLabel)??null,actualScore:((V=F.eventMetadata)==null?void 0:V.actualScore)??null,predictionLabel:((H=F.eventMetadata)==null?void 0:H.predictionLabel)??null,predictionScore:((te=F.eventMetadata)==null?void 0:te.predictionScore)??null,rawData:(T==null?void 0:T.embeddingMetadata.rawData)??null,linkToData:(T==null?void 0:T.embeddingMetadata.linkToData)??null,dimensions:F.dimensions,prompt:((oe=F.promptAndResponse)==null?void 0:oe.prompt)??null,response:((N=F.promptAndResponse)==null?void 0:N.response)??null,retrievedDocuments:w,documentText:F.documentText??null}}),[y,p,f]),S=u.useMemo(()=>{if(k){const F=k.toLowerCase();return b.filter(T=>{var w,_,Q,V;return T.id.includes(F)||((w=T.documentText)==null?void 0:w.toLowerCase().includes(F))||((_=T.predictionId)==null?void 0:_.includes(F))||((Q=T.prompt)==null?void 0:Q.toLowerCase().includes(F))||((V=T.response)==null?void 0:V.toLowerCase().includes(F))})}return b},[b,k]),v=u.useMemo(()=>{if(k){const F=k.toLowerCase();return y.filter(T=>{var w,_,Q,V,H,te,oe;return T.id.includes(F)||((w=T.documentText)==null?void 0:w.toLowerCase().includes(F))||((Q=(_=T.eventMetadata)==null?void 0:_.predictionId)==null?void 0:Q.includes(F))||((H=(V=T.promptAndResponse)==null?void 0:V.prompt)==null?void 0:H.toLowerCase().includes(F))||((oe=(te=T.promptAndResponse)==null?void 0:te.response)==null?void 0:oe.toLowerCase().includes(F))})}return y},[y,k]),P=u.useMemo(()=>i?b.find(T=>T.id===i)??null:null,[b,i]),E=y.length,R=v.length;return o("section",{css:Wm,children:[o("div",{role:"toolbar",css:C`
          position: absolute;
          top: var(--ac-global-dimension-static-size-100);
          right: var(--ac-global-dimension-static-size-200);
          display: flex;
          flex-direction: row-reverse;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(z,{variant:"default",size:"compact",icon:e(L,{svg:e(bd,{})}),"aria-label":"Clear selection",onClick:g}),e(qm,{})]}),e(Qe,{children:o(ne,{name:"Selection",children:[e(Ym,{numSelectedEvents:E,numMatchingEvents:R,searchText:k}),l===Ul.list?e("div",{css:C`
                flex: 1 1 auto;
                overflow-y: auto;
              `,children:e(Hm,{data:S,onPointSelected:r})}):e(Bm,{events:v,onItemSelected:r})]})}),e(ee,{type:"slideOver",isDismissable:!0,onDismiss:()=>r(null),children:P&&e(Z,{title:"Embedding Details",size:"L",children:e(Am,{event:P})})})]})}function Ym({numSelectedEvents:n,numMatchingEvents:a,searchText:t}){const l=B(m=>m.selectionDisplay),i=B(m=>m.setSelectionDisplay),r=B(m=>m.selectionGridSize),s=B(m=>m.setSelectionGridSize),c=B(m=>m.setSelectionSearchText),d=u.useMemo(()=>t?`${a}/${n} match "${t}"`:`${n} selected`,[n,a,t]);return e(It,{extra:o("div",{css:C`
            display: flex;
            flex-direction: row;
            gap: var(--ac-global-dimension-static-size-100);
          `,children:[e(Sd,{placeholder:"Search by text or ID",onChange:m=>{c(m)}}),l===Ul.gallery&&e(Zd,{size:r,onChange:s}),e(Yd,{mode:l,onChange:m=>{i(m)}})]}),children:e(x,{children:d})})}const Gi=Vi;function M0(){const{referenceInferences:n,corpusInferences:a}=en(),{timeRange:t}=mn(),l=u.useMemo(()=>{let i={};return a!=null?i=nc():n!=null?i=ac():i=tc(),i={...i,umapParameters:{...window.Config.UMAP}},i},[a,n]);return e(Bl,{initialTimestamp:t.end,children:e(lc,{...l,children:e(Xm,{})})})}function Xm(){const n=vm(),{primaryInferences:a,referenceInferences:t}=en(),l=B(v=>v.umapParameters),i=B(v=>v.getHDSCANParameters),r=B(v=>v.getMetric),s=B(v=>v.reset),c=B(v=>v.setLoading),[d,m]=u.useState(!0),[y,g,p]=D.useQueryLoader(Gi),{selectedTimestamp:f}=qa(),k=u.useMemo(()=>f??new Date(a.endTime),[f,a.endTime]),b=u.useMemo(()=>({start:xl(k,2).toISOString(),end:k.toISOString()}),[k]),S=D.useLazyLoadQuery(zi,{});return u.useEffect(()=>{s(),c(!0);const v=r();return g({id:n,timeRange:b,...l,...i(),fetchDataQualityMetric:v.type==="dataQuality",fetchPerformanceMetric:v.type==="performance",dataQualityMetricColumnName:v.type==="dataQuality"?v.dimension.name:null,performanceMetric:v.type==="performance"?v.metric:"accuracyScore"},{fetchPolicy:"network-only"}),()=>{p()}},[c,s,n,g,p,l,i,r,b]),o("main",{css:C`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(sg,{}),o(It,{extra:o(h,{direction:"row",justifyContent:"center",alignItems:"center",gap:"size-100",children:[e(Xn,{onChange:v=>{m(v)},defaultSelected:!0,labelPlacement:"start",children:"Show Timeseries"}),e(Fm,{})]}),children:[e(Vl,{}),t?e($l,{inferencesRole:"reference",timeRange:{start:new Date(t.startTime),end:new Date(t.endTime)}}):null,e(Im,{model:S.model})]}),o(on,{direction:"vertical",children:[d?o(G,{children:[e(ke,{defaultSize:20,collapsible:!0,order:1,children:e(u.Suspense,{fallback:e(ye,{}),children:e(Em,{embeddingDimensionId:n})})}),e(sn,{css:bn})]}):null,e(ke,{order:2,children:e("div",{css:C`
              width: 100%;
              height: 100%;
              position: relative;
            `,children:e(u.Suspense,{fallback:e(ic,{}),children:y?e(ng,{queryReference:y}):null})})})]})]})}function eg(n){if(n.__typename!=="Point3D")throw new Error(`Expected Point3D but got ${n.__typename} for coordinates`);return[n.x,n.y,n.z]}function ng({queryReference:n}){const a=D.usePreloadedQuery(Gi,n),t=u.useMemo(()=>{var m,y;return((y=(m=a.embedding)==null?void 0:m.UMAPPoints)==null?void 0:y.data)??[]},[a]),l=u.useMemo(()=>{var m,y;return((y=(m=a.embedding)==null?void 0:m.UMAPPoints)==null?void 0:y.referenceData)??[]},[a]),i=u.useMemo(()=>{var m,y;return((y=(m=a.embedding)==null?void 0:m.UMAPPoints)==null?void 0:y.corpusData)??[]},[a]),r=u.useMemo(()=>{var m,y;return((y=(m=a.embedding)==null?void 0:m.UMAPPoints)==null?void 0:y.contextRetrievals)??[]},[a]),s=u.useMemo(()=>[...t,...l,...i].map(y=>({...y,position:eg(y.coordinates),metaData:{id:y.eventId}})),[l,t,i]),c=B(m=>m.setInitialData),d=B(m=>m.setClusters);return Yo(()=>{var y,g;const m=((g=(y=a.embedding)==null?void 0:y.UMAPPoints)==null?void 0:g.clusters)||[];c({points:s,clusters:m,retrievals:r})},[s,n,r,c,d]),e("div",{css:C`
        flex: 1 1 auto;
        display: flex;
        flex-direction: row;
        align-items: stretch;
        width: 100%;
        height: 100%;
      `,"data-testid":"point-cloud-display",children:o(on,{direction:"horizontal",children:[e(ke,{id:"embedding-left",defaultSize:15,maxSize:30,minSize:10,collapsible:!0,children:o(on,{autoSaveId:"embedding-controls-vertical",direction:"vertical",children:[e(ke,{css:C`
                display: flex;
                flex-direction: column;
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  display: flex;
                  flex-direction: column;
                  [role="tablist"] {
                    flex: none;
                  }
                  .ac-tabs__pane-container {
                    flex: 1 1 auto;
                    overflow: hidden;
                    display: flex;
                    flex-direction: column;
                    & > div {
                      height: 100%;
                    }
                  }
                }
              `,children:e(ig,{})}),e(sn,{css:bn}),e(ke,{css:C`
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  .ac-tabs__pane-container {
                    height: 100%;
                    overflow-y: auto;
                  }
                }
              `,children:o(Qe,{children:[e(ne,{name:"Display",children:e(rc,{})}),e(ne,{name:"Hyperparameters",children:e(sc,{})})]})})]})}),e(sn,{css:oc}),e(ke,{children:o("div",{css:C`
              position: relative;
              width: 100%;
              height: 100%;
            `,children:[e(ag,{}),e(dc,{})]})})]})})}function ag(){return B(a=>a.selectedEventIds).size===0?null:e("div",{css:C`
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
      `,"data-testid":"selection-panel",children:o(on,{direction:"vertical",children:[e(ke,{}),e(sn,{css:bn,style:{zIndex:1}}),e(ke,{id:"embedding-point-selection",defaultSize:40,minSize:20,order:2,style:{zIndex:1},children:e(tg,{children:e(u.Suspense,{fallback:e(ye,{}),children:e(Zm,{})})})})]})})}function tg(n){return e("div",{css:C`
        background-color: var(--ac-global-color-grey-75);
        width: 100%;
        height: 100%;
      `,children:n.children})}const lg=1,ig=Se.memo(function(){const{referenceInferences:a}=en(),t=B(g=>g.clusters),l=B(g=>g.selectedClusterId),i=B(g=>g.metric),r=B(g=>g.setSelectedClusterId),s=B(g=>g.setSelectedEventIds),c=B(g=>g.setHighlightedClusterId),d=B(g=>g.setClusterColorMode),m=a==null||i.type==="drift",y=u.useCallback(g=>{d(g===lg?Yt.highlight:Yt.default)},[d]);return o(Qe,{onChange:y,children:[e(ne,{name:"Clusters",extra:e(Je,{children:t.length}),children:o(h,{direction:"column",height:"100%",children:[e(K,{borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"dark",flex:"none",padding:"size-50",children:e(h,{direction:"row",justifyContent:"end",children:e(Cm,{})})}),e(K,{flex:"1 1 auto",overflow:"auto",children:e("ul",{css:g=>C`
                flex: 1 1 auto;
                display: flex;
                flex-direction: column;
                gap: ${g.spacing.margin8}px;
                margin: ${g.spacing.margin8}px;
              `,children:t.map(g=>e("li",{children:e(Xd,{clusterId:g.id,numPoints:g.eventIds.length,isSelected:l===g.id,driftRatio:g.driftRatio,primaryToCorpusRatio:g.primaryToCorpusRatio,primaryMetricValue:g.primaryMetricValue,referenceMetricValue:g.referenceMetricValue,metricName:rg(i),hideReference:m,onClick:()=>{l!==g.id?(r(g.id),s(new Set(g.eventIds))):(r(null),s(new Set))},onMouseEnter:()=>{c(g.id)},onMouseLeave:()=>{c(null)}})},g.id))})})]})}),e(ne,{name:"Configuration",children:e(K,{overflow:"auto",height:"100%",children:e(ec,{})})})]})});function rg(n){const{type:a,metric:t}=n;switch(a){case"dataQuality":return`${n.dimension.name} avg`;case"drift":{switch(t){case"euclideanDistance":return"Cluster Drift";default:me()}break}case"performance":return wn(t);case"retrieval":{switch(t){case"queryDistance":return"% Query";default:me()}break}default:me()}}function sg(){const{notifyError:n}=Ol(),a=B(l=>l.errorMessage),t=B(l=>l.setErrorMessage);return u.useEffect(()=>{a!==null&&n({title:"An error occurred",message:a,action:{text:"Dismiss",onClick:()=>{t(null)}}})},[a,n,t]),null}const Wi=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,l],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[l],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"cff0ac130f1ef79784f7bef4161ac60d",id:null,metadata:{},name:"embeddingLoaderQuery",operationKind:"query",text:`query embeddingLoaderQuery(
  $id: GlobalID!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      id
      name
    }
    __isNode: __typename
    id
  }
}
`}}}();Wi.hash="c049e57d92943f64b5e751e0daa89dc8";async function N0(n){const{embeddingDimensionId:a}=n.params;return D.fetchQuery(Me,Wi,{id:a}).toPromise()}const Ji=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"hasReference"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"timeRange",variableName:"timeRange"},s=[r],c=[{kind:"Variable",name:"hasReference",variableName:"hasReference"},r],d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},m=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}],y={kind:"Literal",name:"metric",value:"cardinality"},g={kind:"Literal",name:"metric",value:"percentEmpty"},p={kind:"Literal",name:"inferencesRole",value:"reference"};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionPageQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[i,{args:s,kind:"FragmentSpread",name:"DimensionSegmentsBarChart_dimension"},{args:s,kind:"FragmentSpread",name:"DimensionCountStats_dimension"},{args:s,kind:"FragmentSpread",name:"DimensionDriftStats_dimension"},{args:c,kind:"FragmentSpread",name:"DimensionCardinalityStats_dimension"},{args:c,kind:"FragmentSpread",name:"DimensionPercentEmptyStats_dimension"},{args:s,kind:"FragmentSpread",name:"DimensionQuantilesStats_dimension"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionPageQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[d,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:m,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:m,storageKey:null}],storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},r],kind:"ScalarField",name:"driftMetric",storageKey:null},{alias:"cardinality",args:[y,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[g,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[p,y],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'},{alias:"referencePercentEmpty",args:[p,g],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"2ad937e56d4647309b9d78ac11f57265",id:null,metadata:{},name:"DimensionPageQuery",operationKind:"query",text:`query DimensionPageQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $hasReference: Boolean!
) {
  dimension: node(id: $dimensionId) {
    __typename
    ... on Dimension {
      id
      ...DimensionSegmentsBarChart_dimension_3E0ZE6
      ...DimensionCountStats_dimension_3E0ZE6
      ...DimensionDriftStats_dimension_3E0ZE6
      ...DimensionCardinalityStats_dimension_1JBzL3
      ...DimensionPercentEmptyStats_dimension_1JBzL3
      ...DimensionQuantilesStats_dimension_3E0ZE6
    }
    __isNode: __typename
    id
  }
}

fragment DimensionCardinalityStats_dimension_1JBzL3 on Dimension {
  id
  cardinality: dataQualityMetric(metric: cardinality, timeRange: $timeRange)
  referenceCardinality: dataQualityMetric(metric: cardinality, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionCountStats_dimension_3E0ZE6 on Dimension {
  id
  count: dataQualityMetric(metric: count, timeRange: $timeRange)
}

fragment DimensionDriftStats_dimension_3E0ZE6 on Dimension {
  id
  psi: driftMetric(metric: psi, timeRange: $timeRange)
}

fragment DimensionPercentEmptyStats_dimension_1JBzL3 on Dimension {
  id
  percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: $timeRange)
  referencePercentEmpty: dataQualityMetric(metric: percentEmpty, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionQuantilesStats_dimension_3E0ZE6 on Dimension {
  p99: dataQualityMetric(metric: p99, timeRange: $timeRange)
  p75: dataQualityMetric(metric: p75, timeRange: $timeRange)
  p50: dataQualityMetric(metric: p50, timeRange: $timeRange)
  p25: dataQualityMetric(metric: p25, timeRange: $timeRange)
  p1: dataQualityMetric(metric: p01, timeRange: $timeRange)
}

fragment DimensionSegmentsBarChart_dimension_3E0ZE6 on Dimension {
  id
  segmentsComparison(primaryTimeRange: $timeRange) {
    segments {
      bin {
        __typename
        ... on NominalBin {
          __typename
          name
        }
        ... on IntervalBin {
          __typename
          range {
            start
            end
          }
        }
        ... on MissingValueBin {
          __typename
        }
      }
      counts {
        primaryValue
      }
    }
    totalCounts {
      primaryValue
    }
  }
}
`}}}();Ji.hash="d194bfd656408e8ba7cb427ddc80fc85";const Zi=function(){var n={kind:"Literal",name:"metric",value:"cardinality"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCardinalityStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"cardinality",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'}]}],type:"Dimension",abstractKey:null}}();Zi.hash="8b4edef350e4df49e799afa70ca34918";function og(n){const a=D.useFragment(Zi,n.dimension);return o(G,{children:[e(x,{elementType:"h3",textSize:"small",color:"text-700",children:"Cardinality"}),e(x,{textSize:"xlarge",children:En(a.cardinality)}),a.referenceCardinality!=null&&e(x,{textSize:"medium",color:"designationPurple",children:En(a.referenceCardinality)})]})}const Yi=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"cardinalityTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"cardinality"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"f53e5ac5e0bfd6a0a6c50b761223a617",id:null,metadata:{},name:"DimensionCardinalityTimeSeriesQuery",operationKind:"query",text:`query DimensionCardinalityTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      cardinalityTimeSeries: dataQualityTimeSeries(metric: cardinality, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();Yi.hash="88ce04bb2022d5e2bc75c663abd7e5de";const Ta={top:25,right:18,left:18,bottom:5},dg=new Intl.NumberFormat([],{maximumFractionDigits:2}),Xi=()=>{const{gray300:n}=gn();return{color:n}};function cg({active:n,payload:a,label:t}){var i;const{color:l}=Xi();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,s=typeof r=="number"?dg.format(r):"--";return o(vn,{children:[e(x,{weight:"heavy",textSize:"medium",children:`${Ze(new Date(t))}`}),e(we,{color:l,name:"Cardinality",value:s}),e(Ua,{})]})}return null}function ug({dimensionId:n}){var c;const{timeRange:a}=mn(),t=na(a),l=D.useLazyLoadQuery(Yi,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:t}),{color:i}=Xi(),r=((c=l.dimension.cardinalityTimeSeries)==null?void 0:c.data.map(d=>({timestamp:new Date(d.timestamp).valueOf(),value:d.value})))||[],s=aa({samplingIntervalMinutes:t.samplingIntervalMinutes});return e(Cn,{width:"100%",height:"100%",children:o(xa,{data:r,margin:Ta,syncId:"dimensionDetails",children:[e("defs",{children:o("linearGradient",{id:"cardinalityColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:i,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:i,stopOpacity:0})]})}),e(Fn,{...ta,tickFormatter:d=>s(new Date(d))}),e(Xe,{stroke:De.colors.gray200,label:{value:"Cardinality",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Kn,{strokeDasharray:"4 4",stroke:De.colors.gray200,strokeOpacity:.5}),e(xn,{content:e(cg,{})}),e(ha,{type:"monotone",dataKey:"value",stroke:i,fillOpacity:1,fill:"url(#cardinalityColorUv)"})]})})}const er={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCountStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null};er.hash="6dccac51f3fb0853276677c692af5a43";function mg(n){const t=D.useFragment(er,n.dimension).count??0;return o(G,{children:[e(x,{elementType:"h3",textSize:"small",color:"text-700",children:"Total Count"}),e(x,{textSize:"xlarge",children:En(t)})]})}const nr=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,n],kind:"Operation",name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"1f9eff6d8d453148844edae32b844df7",id:null,metadata:{},name:"DimensionCountTimeSeriesQuery",operationKind:"query",text:`query DimensionCountTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();nr.hash="9677ef7c6b298554824fe3fd3904c7aa";const gg=new Intl.NumberFormat([],{maximumFractionDigits:2}),ar=()=>{const{gray300:n}=gn();return{barColor:n}};function pg({active:n,payload:a,label:t}){var i;const{barColor:l}=ar();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,s=typeof r=="number"?gg.format(r):"--";return o(vn,{children:[e(x,{weight:"heavy",textSize:"medium",children:`${Ze(new Date(t))}`}),e(we,{color:l,shape:"square",name:"Count",value:s})]})}return null}function yg({dimensionId:n}){var d;const{timeRange:a}=mn(),t=na(a),r=(((d=D.useLazyLoadQuery(nr,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},countGranularity:t}).embedding.trafficTimeSeries)==null?void 0:d.data)||[]).map(m=>({...m,timestamp:new Date(m.timestamp).valueOf()})),s=aa({samplingIntervalMinutes:t.samplingIntervalMinutes}),{barColor:c}=ar();return e(Cn,{width:"100%",height:"100%",children:o(At,{data:r,margin:Ta,syncId:"dimensionDetails",children:[e("defs",{children:o("linearGradient",{id:"countBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:c,stopOpacity:1}),e("stop",{offset:"95%",stopColor:c,stopOpacity:.5})]})}),e(Fn,{...ta,tickFormatter:m=>s(new Date(m))}),e(Xe,{stroke:De.colors.gray200,label:{value:"Count",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Kn,{strokeDasharray:"4 4",stroke:De.colors.gray200,strokeOpacity:.5}),e(xn,{...Pt,content:e(pg,{})}),e(Jn,{dataKey:"value",fill:"url(#countBarColor)",spacing:5})]})})}const tr=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"dimensionId"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"dimensionId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],d={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:c,storageKey:null},m={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:c,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{kind:"RequiredField",field:{alias:null,args:l,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[i,r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[i,s],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[i],type:"MissingValueBin",abstractKey:null}],storageKey:null},d],storageKey:null},m],storageKey:null},action:"THROW",path:"dimension.segmentsComparison"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,t,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[i,{kind:"InlineFragment",selections:[r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"IntervalBin",abstractKey:null}],storageKey:null},d],storageKey:null},m],storageKey:null}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"7d11d88f419003f5ee8cd9d11312e427",id:null,metadata:{},name:"DimensionDriftBreakdownSegmentBarChartQuery",operationKind:"query",text:`query DimensionDriftBreakdownSegmentBarChartQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      segmentsComparison(primaryTimeRange: $timeRange) {
        segments {
          bin {
            __typename
            ... on NominalBin {
              __typename
              name
            }
            ... on IntervalBin {
              __typename
              range {
                start
                end
              }
            }
            ... on MissingValueBin {
              __typename
            }
          }
          counts {
            primaryValue
            referenceValue
          }
        }
        totalCounts {
          primaryValue
          referenceValue
        }
      }
    }
  }
}
`}}}();tr.hash="6bb76e3cce4ee28c333e485b3aa2dffd";const sl=bt(".2f"),lr=()=>{const{primary:n,reference:a}=gn();return{primaryBarColor:n,referenceBarColor:a}};function fg({active:n,payload:a,label:t}){var r,s,c,d,m,y;const{primaryBarColor:l,referenceBarColor:i}=lr();if(n&&a&&a.length){const g=(s=(r=a[0])==null?void 0:r.payload)==null?void 0:s.primaryName,p=(c=a[0])==null?void 0:c.value,f=(m=(d=a[0])==null?void 0:d.payload)==null?void 0:m.referenceName,k=(y=a[1])==null?void 0:y.value;return o(vn,{children:[e(x,{elementType:"h3",textSize:"medium",weight:"heavy",children:t}),e(we,{color:l,shape:"square",name:g,value:p!=null?`${sl(p)}%`:"--"}),e(we,{color:i,shape:"square",name:f,value:k!=null?`${sl(k)}%`:"--"})]})}return null}function hg(n){var p,f,k,b,S;const{primaryInferences:a,referenceInferences:t}=en(),l=a.name,i=(t==null?void 0:t.name)||"reference",{selectedTimestamp:r}=qa(),s=u.useMemo(()=>r??new Date(a.endTime),[r,a.endTime]),c=u.useMemo(()=>({start:xl(s,2).toISOString(),end:s.toISOString()}),[s]),d=D.useLazyLoadQuery(tr,{dimensionId:n.dimensionId,timeRange:c}),m=u.useMemo(()=>{var R,F,T,w,_;const v=((R=d.dimension.segmentsComparison)==null?void 0:R.segments)??[],P=((T=(F=d.dimension.segmentsComparison)==null?void 0:F.totalCounts)==null?void 0:T.primaryValue)??0,E=((_=(w=d.dimension.segmentsComparison)==null?void 0:w.totalCounts)==null?void 0:_.referenceValue)??0;return v.map(Q=>{var j,M;const V=((j=Q.counts)==null?void 0:j.primaryValue)??0,H=((M=Q.counts)==null?void 0:M.referenceValue)??0,te=Hl(Q.bin),oe=V/P*100,N=H/E*100;return{name:te,primaryName:l,referenceName:i,primaryPercent:oe,referencePercent:N}})},[(p=d.dimension.segmentsComparison)==null?void 0:p.segments,(k=(f=d.dimension.segmentsComparison)==null?void 0:f.totalCounts)==null?void 0:k.primaryValue,(S=(b=d.dimension.segmentsComparison)==null?void 0:b.totalCounts)==null?void 0:S.referenceValue,l,i]),{primaryBarColor:y,referenceBarColor:g}=lr();return o(h,{direction:"column",height:"100%",children:[e(K,{flex:"none",paddingTop:"size-100",paddingStart:"size-200",children:e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:`Distribution comparison at ${Ze(new Date(c.end))}`})}),e(K,{flex:!0,children:e(Cn,{children:o(At,{data:m,margin:{top:15,right:18,left:18,bottom:5},children:[o("defs",{children:[o("linearGradient",{id:"dimensionPrimarySegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:y,stopOpacity:1}),e("stop",{offset:"95%",stopColor:y,stopOpacity:.5})]}),o("linearGradient",{id:"dimensionReferenceSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:g,stopOpacity:1}),e("stop",{offset:"95%",stopColor:g,stopOpacity:.5})]})]}),e(Fn,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(Xe,{stroke:De.colors.gray200,label:{value:"Percent",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Kn,{strokeDasharray:"4 4",stroke:De.colors.gray200,strokeOpacity:.5}),e(xn,{...Pt,content:e(fg,{})}),e(Jn,{dataKey:"primaryPercent",fill:"url(#dimensionPrimarySegmentsBarColor)"}),e(Jn,{dataKey:"referencePercent",fill:"url(#dimensionReferenceSegmentsBarColor)"})]})})})]})}const ir={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionDriftStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"driftMetric",storageKey:null}],type:"Dimension",abstractKey:null};ir.hash="f8a9fb08a14f63906e38bc247d50b189";const kg=o(Yn,{variant:"info",placement:"top end",children:[e(ce,{weight:"heavy",level:4,children:"Population Stability Index"}),e(zn,{children:e(x,{children:"PSI is a symmetric metric that measures the relative entropy, or difference in information represented by two distributions. It can be thought of as measuring the distance between two data distributions showing how different the two distributions are from each other."})}),e("footer",{children:e(He,{href:"https://arize.com/blog-course/population-stability-index-psi/#:~:text=Population%20Stability%20Index%20(PSI)%20Overview,distributions%20are%20from%20each%20other.",children:"Learn more"})})]});function bg(n){const a=D.useFragment(ir,n.dimension);return o(G,{children:[o(h,{direction:"row",alignItems:"center",gap:"size-25",children:[e(x,{elementType:"h3",textSize:"small",color:"text-700",children:"PSI"}),kg]}),e(x,{textSize:"xlarge",children:Gn(a.psi)})]})}const rr=function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"driftGranularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},i=[{kind:"Variable",name:"id",variableName:"dimensionId"}],r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={kind:"Variable",name:"timeRange",variableName:"timeRange"},c=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],d={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"granularity",variableName:"driftGranularity"},{kind:"Literal",name:"metric",value:"psi"},s],concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:c,storageKey:null},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:c,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t,l],kind:"Fragment",metadata:null,name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,d],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,t,n],kind:"Operation",name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,d],storageKey:null}]},params:{cacheID:"af2d25e28675891b3c8a6bc75027f731",id:null,metadata:{},name:"DimensionDriftTimeSeriesQuery",operationKind:"query",text:`query DimensionDriftTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $driftGranularity: Granularity!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      driftTimeSeries(metric: psi, timeRange: $timeRange, granularity: $driftGranularity) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();rr.hash="6312b58dbb252b17efdf08d44dd58630";const sr=()=>{const{orange300:n,gray300:a}=gn();return{color:n,barColor:a}};function Sg({active:n,payload:a,label:t}){var i;const{color:l}=sr();if(n&&a&&a.length){const r=((i=a[1])==null?void 0:i.value)??null;return o(vn,{children:[e(x,{weight:"heavy",textSize:"medium",children:`${Ze(new Date(t))}`}),e(we,{color:l,name:"PSI",value:Gn(r)}),e(Ua,{}),o("div",{css:C`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);

            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(L,{svg:e(Dl,{})}),e("span",{children:"Click to view details"})]})]})}return null}function vg({dimensionId:n}){var f,k;const{timeRange:a}=mn(),{selectedTimestamp:t,setSelectedTimestamp:l}=qa(),i=na(a),r=D.useLazyLoadQuery(rr,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},driftGranularity:Ql(a),countGranularity:i}),s=((f=r.embedding.driftTimeSeries)==null?void 0:f.data)||[],c=((k=r.embedding.trafficTimeSeries)==null?void 0:k.data.reduce((b,S)=>(b[S.timestamp]=S.value,b),{}))??{},d=s.map(b=>{const S=c[b.timestamp];return{...b,traffic:S,timestamp:new Date(b.timestamp).valueOf()}}),m=aa({samplingIntervalMinutes:i.samplingIntervalMinutes}),y=u.useCallback(b=>{const{activePayload:S}=b;if(S!=null&&S.length>0){const v=S[0].payload;l(new Date(v.timestamp))}},[l]),{color:g,barColor:p}=sr();return e(Cn,{width:"100%",height:"100%",children:o(xa,{data:d,margin:Ta,onClick:y,syncId:"dimensionDetails",children:[o("defs",{children:[o("linearGradient",{id:"dimensionDriftColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:g,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:g,stopOpacity:0})]}),o("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:p,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:p,stopOpacity:0})]})]}),e(Fn,{...ta,tickFormatter:b=>m(new Date(b))}),e(Xe,{stroke:De.colors.gray200,label:{value:"PSI",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Xe,{yAxisId:"right",orientation:"right",tick:!1,tickLine:!1,width:0}),e(Kn,{strokeDasharray:"4 4",stroke:De.colors.gray200,strokeOpacity:.5}),e(xn,{content:e(Sg,{})}),e(Jn,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(ha,{type:"monotone",dataKey:"value",stroke:g,fillOpacity:1,fill:"url(#dimensionDriftColorUv)"}),t!=null?e(gi,{...jl,x:t.getTime()}):null]})})}const or=function(){var n={kind:"Literal",name:"metric",value:"percentEmpty"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"percentEmpty",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referencePercentEmpty",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}}();or.hash="1e10d0449d6607d9292f355548c41c78";function Cg(n){const a=D.useFragment(or,n.dimension);return o(G,{children:[e(x,{elementType:"h3",textSize:"small",color:"text-700",children:"% Empty"}),e(x,{textSize:"xlarge",children:yt(a.percentEmpty)}),a.referencePercentEmpty!=null&&e(x,{textSize:"medium",color:"designationPurple",children:yt(a.referencePercentEmpty)})]})}const dr=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"percentEmptyTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"percentEmpty"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"9be05c72f19755036f4829777a96f97d",id:null,metadata:{},name:"DimensionPercentEmptyTimeSeriesQuery",operationKind:"query",text:`query DimensionPercentEmptyTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      percentEmptyTimeSeries: dataQualityTimeSeries(metric: percentEmpty, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();dr.hash="1e843d6c8dbe05b389b24188c6bdb394";const Fg=new Intl.NumberFormat([],{maximumFractionDigits:2}),cr=()=>{const{gray100:n}=gn();return{color:n}};function Kg({active:n,payload:a,label:t}){var i;const{color:l}=cr();if(n&&a&&a.length){const r=((i=a[0])==null?void 0:i.value)??null,s=typeof r=="number"?Fg.format(r):"--";return o(vn,{children:[e(x,{weight:"heavy",textSize:"medium",children:`${Ze(new Date(t))}`}),e(we,{color:l,name:"% Empty",value:s})]})}return null}function xg({dimensionId:n}){var c;const{timeRange:a}=mn(),t=na(a),i=((c=D.useLazyLoadQuery(dr,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:t}).embedding.percentEmptyTimeSeries)==null?void 0:c.data.map(d=>({timestamp:new Date(d.timestamp).valueOf(),value:d.value})))||[],r=aa({samplingIntervalMinutes:t.samplingIntervalMinutes}),{color:s}=cr();return e(Cn,{width:"100%",height:"100%",children:o(xa,{data:i,margin:Ta,syncId:"dimensionDetails",children:[e("defs",{children:o("linearGradient",{id:"percentEmptyColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:s,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:s,stopOpacity:0})]})}),e(Fn,{...ta,tickFormatter:d=>r(new Date(d))}),e(Xe,{stroke:De.colors.gray200,label:{value:"% Empty",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Kn,{strokeDasharray:"4 4",stroke:De.colors.gray200,strokeOpacity:.5}),e(xn,{content:e(Kg,{})}),e(pi,{type:"monotone",dataKey:"value",stroke:s,fillOpacity:1,fill:"url(#percentEmptyColorUv)"})]})})}const ur=function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionQuantilesStats_dimension",selections:[{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null}}();ur.hash="c306c8eafb1d34be464d3a658d5f94a7";function Tg(n){const a=D.useFragment(ur,n.dimension);return e("ul",{css:C`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-50);
      `,children:Object.keys(a).map(t=>{const l=a[t];return o("li",{css:C`
              display: flex;
              flex-direction: column;
              align-items: flex-end;
            `,children:[e(x,{elementType:"h3",textSize:"xsmall",color:"text-700",children:t}),e(x,{textSize:"medium","data-raw":l,children:Dt(l)})]},t)})})}const mr=function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"granularity",variableName:"granularity"},s={kind:"Variable",name:"timeRange",variableName:"timeRange"},c=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],d={kind:"InlineFragment",selections:[{alias:"p99TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p99"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:c,storageKey:null},{alias:"p75TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p75"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:c,storageKey:null},{alias:"p50TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p50"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:c,storageKey:null},{alias:"p25TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p25"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:c,storageKey:null},{alias:"p01TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p01"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:c,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,d],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,d],storageKey:null}]},params:{cacheID:"0bb3d9faf9d7f0c2e27995120ae24e1c",id:null,metadata:{},name:"DimensionQuantilesTimeSeriesQuery",operationKind:"query",text:`query DimensionQuantilesTimeSeriesQuery(
  $dimensionId: GlobalID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      p99TimeSeries: dataQualityTimeSeries(metric: p99, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p75TimeSeries: dataQualityTimeSeries(metric: p75, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p50TimeSeries: dataQualityTimeSeries(metric: p50, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p25TimeSeries: dataQualityTimeSeries(metric: p25, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p01TimeSeries: dataQualityTimeSeries(metric: p01, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}}();mr.hash="134f0dad0e0ecc7863dfbb0f437d829b";const Ig=bt("~s");var gr=(n=>(n.p99_p01="p99_p01",n.p75_p25="p75_p25",n.p50="p50",n))(gr||{});const Dg=new Intl.NumberFormat([],{maximumFractionDigits:2});function ca(n){return typeof n=="number"?Dg.format(n):"--"}const pr=()=>{const n=gn();return{outerColor:n.gray500,innerColor:n.gray300,lineColor:n.default}};function Pg({active:n,payload:a,label:t}){const{outerColor:l,innerColor:i,lineColor:r}=pr();if(n&&a&&a.length){const s=a[0].payload;return o(vn,{children:[e(x,{weight:"heavy",textSize:"medium",children:`${Ze(new Date(t))}`}),e(we,{color:l,name:"p99",value:ca(s.p99_p01[0])}),e(we,{color:i,name:"p75",value:ca(s.p75_p25[0])}),e(we,{color:r,name:"p50",value:ca(s.p50)}),e(we,{color:i,name:"p25",value:ca(s.p75_p25[1])}),e(we,{color:l,name:"p01",value:ca(s.p99_p01[1])})]})}return null}function Lg({dimensionId:n}){var E,R,F,T,w;const{timeRange:a}=mn(),t=na(a),l=D.useLazyLoadQuery(mr,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:t}),i=((E=l.dimension.p99TimeSeries)==null?void 0:E.data.map(_=>_))||[],r=((R=l.dimension.p01TimeSeries)==null?void 0:R.data.map(_=>_))||[],s=((F=l.dimension.p75TimeSeries)==null?void 0:F.data.map(_=>_))||[],c=((T=l.dimension.p25TimeSeries)==null?void 0:T.data.map(_=>_))||[],d=((w=l.dimension.p50TimeSeries)==null?void 0:w.data.map(_=>_))||[],m=i.map((_,Q)=>({timestamp:new Date(_.timestamp).valueOf(),p99_p01:[_.value,r[Q].value],p75_p25:[s[Q].value,c[Q].value],p50:d[Q].value})),y=aa({samplingIntervalMinutes:t.samplingIntervalMinutes}),[g,p]=u.useState(Object.keys(gr).reduce((_,Q)=>(_[Q]=!1,_),{})),f=_=>{g[_.dataKey]||p({...g})},k=()=>{p({...g})},b=_=>{p({...g,[String(_.dataKey)]:!g[_.dataKey]})},{outerColor:S,innerColor:v,lineColor:P}=pr();return e(Cn,{width:"100%",height:"100%",children:o(xa,{data:m,margin:Ta,syncId:"dimensionDetails",children:[o("defs",{children:[o("linearGradient",{id:"p99_p01ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:S,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:S,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:S,stopOpacity:.7})]}),o("linearGradient",{id:"p75_p25ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:v,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:v,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:v,stopOpacity:.7})]})]}),e(Fn,{...ta,tickFormatter:_=>y(new Date(_))}),e(Xe,{stroke:De.colors.gray200,label:{value:"Value",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},tickFormatter:_=>Ig(_),style:{fill:"var(--ac-global-text-color-700)"}}),e(Kn,{strokeDasharray:"4 4",stroke:De.colors.gray200,strokeOpacity:.5}),e(xn,{content:e(Pg,{})}),e(Hc,{onClick:b,onMouseOver:f,onMouseOut:k}),e(ha,{type:"monotone",dataKey:"p99_p01",name:"p99 - p01",fillOpacity:1,fill:"url(#p99_p01ColorUV)",stroke:S,hide:g.p99_p01===!0}),e(ha,{type:"monotone",dataKey:"p75_p25",name:"p75 - p25",fillOpacity:1,stroke:v,fill:"url(#p75_p25ColorUV)",hide:g.p75_p25===!0}),e(pi,{type:"monotone",dataKey:"p50",stroke:P,hide:g.p50===!0})]})})}const yr=function(){var n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionSegmentsBarChart_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[n,{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[n],type:"MissingValueBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:a,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:a,storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null}}();yr.hash="8cef9841e9a5bd7d0d50acb5db9028b0";const wg=bt(".2f"),fr=()=>{const{primary:n}=gn();return{color:n}};function Eg({active:n,payload:a,label:t}){var i;const{color:l}=fr();if(n&&a&&a.length){const r=(i=a[0])==null?void 0:i.value;return e(vn,{children:e(we,{color:l,shape:"square",name:t,value:r!=null?`${wg(r)}%`:"--"})})}return null}function _g(n){const a=D.useFragment(yr,n.dimension),t=u.useMemo(()=>{var s,c,d;const i=((s=a.segmentsComparison)==null?void 0:s.segments)??[],r=((d=(c=a.segmentsComparison)==null?void 0:c.totalCounts)==null?void 0:d.primaryValue)??0;return i.map(m=>{var f;const y=((f=m.counts)==null?void 0:f.primaryValue)??0,g=Hl(m.bin),p=y/r*100;return{name:g,percent:p}})},[a]),{color:l}=fr();return e(Cn,{children:o(At,{data:t,margin:{top:25,right:18,left:18,bottom:5},children:[e("defs",{children:o("linearGradient",{id:"dimensionSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:l,stopOpacity:1}),e("stop",{offset:"95%",stopColor:l,stopOpacity:.5})]})}),e(Fn,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(Xe,{stroke:De.colors.gray200,label:{value:"% Volume",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Kn,{strokeDasharray:"4 4",stroke:De.colors.gray200,strokeOpacity:.5}),e(xn,{...Pt,content:e(Eg,{})}),e(Jn,{dataKey:"percent",fill:"url(#dimensionSegmentsBarColor)",spacing:15})]})})}function z0(){const{dimensionId:n}=Ve(),{timeRange:a}=mn(),t=kn(),{referenceInferences:l}=en(),i=l!==null,r=i,s=t.dimension.shape!=="continuous",c=t.dimension.dataType==="numeric",d=X(),m=D.useLazyLoadQuery(Ji,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},hasReference:i});if(!n)throw new Error("Dimension ID is required to display a dimension");return e(Bl,{initialTimestamp:new Date(a.end),children:e(ee,{type:"slideOver",isDismissable:!0,onDismiss:()=>d(-1),children:e(Z,{size:"L",title:t.dimension.name,children:e("main",{css:C`
              padding: var(--ac-global-dimension-static-size-100);
              display: flex;
              flex-direction: column;
              min-height: 400px;
              overflow-y: auto;
              height: 100%;
            `,children:e(u.Suspense,{fallback:e(ye,{}),children:o(h,{direction:"column",gap:"size-100",children:[e(K,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:e(_g,{dimension:m.dimension})}),e(K,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600","data-testid":"dimension-count-time-series-view",children:o(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(yg,{dimensionId:n}),e(Dn,{children:e(mg,{dimension:m.dimension})})]})}),r?e(K,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",children:o(h,{direction:"column",alignItems:"stretch",children:[e(K,{width:"100%",height:"size-1600",children:o(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(K,{flex:!0,children:e(vg,{dimensionId:n})}),e(Dn,{children:e(bg,{dimension:m.dimension})})]})}),e(K,{height:"size-1600",width:"100%",borderTopColor:"dark",borderTopWidth:"thin",children:e(u.Suspense,{fallback:e(ye,{}),children:e(hg,{dimensionId:n})})})]})}):null,c?e(K,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-3000",children:o(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(K,{flex:!0,children:e(Lg,{dimensionId:n})}),e(Dn,{children:e(Tg,{dimension:m.dimension})})]})}):null,s?e(K,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:o(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(K,{flex:!0,children:e(ug,{dimensionId:n})}),e(Dn,{children:e(og,{dimension:m.dimension})})]})}):null,e(K,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:o(h,{direction:"row",alignItems:"stretch",height:"100%",children:[e(xg,{dimensionId:n}),e(Dn,{children:e(Cg,{dimension:m.dimension})})]})})]})})})})})})}const hr=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"shape",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,l,i,r],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[l,i,r],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"03a9aafe3f08a9d093b029ff4a9e3253",id:null,metadata:{},name:"dimensionLoaderQuery",operationKind:"query",text:`query dimensionLoaderQuery(
  $id: GlobalID!
) {
  dimension: node(id: $id) {
    __typename
    ... on Dimension {
      id
      name
      dataType
      shape
    }
    __isNode: __typename
    id
  }
}
`}}}();hr.hash="5a662d77e69d2e9bb4eb2af4cad6b722";async function V0(n){const{dimensionId:a}=n.params;return D.fetchQuery(Me,hr,{id:a}).toPromise()}const kr=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"traceId"},t=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"traceId",variableName:"traceId"}],concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"projectSessionId",storageKey:null},{alias:null,args:[{kind:"Literal",name:"first",value:1e3}],concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"spans(first:1000)"}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"TraceDetailsQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"TraceDetailsQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}]},params:{cacheID:"5ac539f9f161693ada371b5d0e55f17f",id:null,metadata:{},name:"TraceDetailsQuery",operationKind:"query",text:`query TraceDetailsQuery(
  $traceId: ID!
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      trace(traceId: $traceId) {
        projectSessionId
        spans(first: 1000) {
          edges {
            span: node {
              id
              context {
                spanId
                traceId
              }
              name
              spanKind
              statusCode: propagatedStatusCode
              startTime
              parentId
              latencyMs
              tokenCountTotal
              tokenCountPrompt
              tokenCountCompletion
              spanAnnotations {
                name
                label
                score
                annotatorKind
              }
            }
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();kr.hash="69f82cff480af6a8d9e0cc0bb393d3e3";const br=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},c={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},b=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}],S={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:b,storageKey:null},v={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:b,storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},E={alias:null,args:null,concreteType:"SpanEvent",kind:"LinkedField",name:"events",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null},R={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},T={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},w={alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},_={alias:null,args:null,concreteType:"DocumentEvaluation",kind:"LinkedField",name:"documentEvaluations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"documentPosition",storageKey:null},r,F,T,w],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[l,i,r,s,c,d,m,y,g,p,f,k,S,v,P,{kind:"RequiredField",field:E,action:"THROW",path:"span.events"},R,_,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[r],storageKey:null},{args:null,kind:"FragmentSpread",name:"SpanFeedback_annotations"},{args:null,kind:"FragmentSpread",name:"SpanAside_span"}],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,r,s,c,d,m,y,g,p,f,k,S,v,P,E,R,_,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[r,F,T,w,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},l],storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"b1a80a0108c40baebf6e64b811ca0202",id:null,metadata:{},name:"SpanDetailsQuery",operationKind:"query",text:`query SpanDetailsQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      id
      context {
        spanId
        traceId
      }
      name
      spanKind
      statusCode: propagatedStatusCode
      statusMessage
      startTime
      parentId
      latencyMs
      tokenCountTotal
      tokenCountPrompt
      tokenCountCompletion
      input {
        value
        mimeType
      }
      output {
        value
        mimeType
      }
      attributes
      events {
        name
        message
        timestamp
      }
      documentRetrievalMetrics {
        evaluationName
        ndcg
        precision
        hit
      }
      documentEvaluations {
        documentPosition
        name
        label
        score
        explanation
      }
      spanAnnotations {
        name
      }
      ...SpanFeedback_annotations
      ...SpanAside_span
    }
    __isNode: __typename
    id
  }
}

fragment SpanAside_span on Span {
  id
  code: statusCode
  startTime
  endTime
  tokenCountTotal
  tokenCountPrompt
  tokenCountCompletion
  spanAnnotations {
    id
    name
    label
    annotatorKind
    score
  }
}

fragment SpanFeedback_annotations on Span {
  spanAnnotations {
    name
    label
    score
    explanation
    annotatorKind
  }
}
`}}}();br.hash="eaf52d9b37b1f5a29cae360a05b7c975";function ol(n){return Array.isArray(n)&&n.every(a=>typeof a=="object"&&de.message in a&&Rg(a[de.message]))}function Rg(n){return typeof n=="object"&&n!==null&&Pe.role in n}const st=C`
  display: flex;
  align-items: center;
  .ac-text {
    display: inline-block;
    max-width: 9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`;function $e(n){const{name:a,metric:t,k:l,score:i}=n,r=typeof l=="number"?`${t}@${l}`:t,s=u.useMemo(()=>t==="hit"?i?"true":"false":typeof i=="number"&&pn(i)||"--",[i,t]);return o(pe,{delay:500,offset:3,children:[e(je,{children:e("div",{css:cc,children:o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(uc,{color:"var(--ac-global-color-seafoam-1000)"}),a?e("div",{css:st,children:e(x,{weight:"heavy",textSize:"small",color:"inherit",children:a})}):null,e("div",{css:st,children:e(x,{textSize:"small",color:"inherit",children:r})}),e("div",{css:st,children:e(x,{textSize:"small",children:s})})]})})}),e(Ca,{children:o(h,{direction:"row",gap:"size-100",children:[o(x,{weight:"heavy",color:"inherit",children:[a," ",r]}),e(x,{color:"inherit",children:s})]})})]})}const Sr=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanAsideSpanQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SpanAside_span"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanAsideSpanQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"878027b90513af8f947e6aa408450057",id:null,metadata:{},name:"SpanAsideSpanQuery",operationKind:"query",text:`query SpanAsideSpanQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SpanAside_span
    __isNode: __typename
    id
  }
}

fragment SpanAside_span on Span {
  id
  code: statusCode
  startTime
  endTime
  tokenCountTotal
  tokenCountPrompt
  tokenCountCompletion
  spanAnnotations {
    id
    name
    label
    annotatorKind
    score
  }
}
`}}}();Sr.hash="cb5cab60889623d77ad0c96c98b3f8ac";const vr=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Sr,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SpanAside_span",selections:[n,{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}}();vr.hash="cb5cab60889623d77ad0c96c98b3f8ac";const Ag=C`
  display: flex;
  padding-top: var(--ac-global-dimension-size-50);
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  align-items: flex-start;
`;function Mg(n){const[a]=D.useRefetchableFragment(vr,n.span),{startTime:t,endTime:l,code:i,tokenCountCompletion:r,tokenCountPrompt:s,tokenCountTotal:c}=a,d=u.useMemo(()=>new Date(t),[t]),m=u.useMemo(()=>l?new Date(l):null,[l]),y=u.useMemo(()=>m?m.getTime()-d.getTime():null,[m,d]),g=Gl(i),p=a.spanAnnotations,f=p.length>0;return e(K,{padding:"size-200",borderColor:"dark",backgroundColor:"dark",borderLeftWidth:"thin",width:"230px",flex:"none",minHeight:"100%",children:o(h,{direction:"column",gap:"size-200",children:[e(Un,{label:"Status",children:o(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(Ba,{statusCode:i}),e(x,{textSize:"xlarge",color:g,children:i})]})}),e(Un,{label:"Start Time",children:e(x,{textSize:"xlarge",children:Ze(d)})}),m&&e(Un,{label:"End Time",children:e(x,{textSize:"xlarge",children:Ze(m)})}),e(Un,{label:"Latency",children:e(x,{textSize:"xlarge",children:typeof y=="number"?e(Ce,{latencyMs:y,textSize:"xlarge"}):"--"})}),c?e(Un,{label:"Total Tokens",children:e(Sn,{tokenCountTotal:c,tokenCountPrompt:s??0,tokenCountCompletion:r??0,textSize:"xlarge"})},"tokens"):null,f&&e(Un,{label:"Feedback",children:e("ul",{css:Ag,children:p.map(k=>e("li",{children:e(un,{annotation:k,annotationDisplayPreference:"label"})},k.id))})})]})})}function Un({label:n,children:a}){return o(h,{direction:"column",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:n}),a]})}function Ng(n){const{spanId:a,traceId:t}=n;return e("div",{css:C`
        button.ac-dropdown-button {
          min-width: 50px;
          .ac-dropdown-button__text {
            padding-right: 10px;
          }
        }
      `,children:o(Zn,{placement:"bottom right",children:[e(Ft,{addonBefore:e(L,{svg:e(I.Code,{})}),children:"Code"}),e(Oa,{children:e(K,{padding:"size-200",children:o(Re,{children:[o(h,{direction:"row",gap:"size-100",alignItems:"end",children:[e(ae,{label:"Span ID",isReadOnly:!0,value:a}),e(se,{text:a,size:"default"})]}),o(h,{direction:"row",gap:"size-100",alignItems:"end",children:[e(ae,{label:"Trace ID",isReadOnly:!0,value:t}),e(se,{text:t,size:"default"})]})]})})})]})})}const Cr={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanFeedback_annotations",selections:[{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};Cr.hash="6199ecd4f0143cffbaa2fe5e19a8739c";function zg(){const[n,a]=u.useState(null);return o(K,{padding:"size-200",children:[o(h,{direction:"column",gap:"size-100",alignItems:"center",children:[e(ja,{graphicKey:"documents"}),e(x,{children:"No annotations for this span"}),e(z,{variant:"default",size:"compact",onClick:()=>{a(e(Z,{title:"Span Annotations",isDismissable:!0,children:o(K,{padding:"size-200",children:[e("p",{css:C`
              margin: 0 0 var(--ac-global-dimension-size-100) 0;
            `,children:"Annotations are pivotal for tracking and improving the performance of your application. Phoenix allows for both LLM and HUMAN annotations."}),e(He,{href:"https://docs.arize.com/phoenix/tracing/concepts-tracing/how-to-evaluate-traces",children:"View annotation documentation"})]})}))},icon:e(L,{svg:e(I.Edit2Outline,{})}),children:"How to Annotate"})]}),e(ee,{onDismiss:()=>a(null),isDismissable:!0,children:n})]})}const Vg=[{header:"name",accessorKey:"name",size:100},{header:"label",accessorKey:"label",size:100},{header:"score",accessorKey:"score",size:100},{header:"explanation",accessorKey:"explanation",cell:mc,size:400}];function dl({annotations:n}){const a=u.useMemo(()=>[...n],[n]),t=Fe({columns:Vg,data:a,getCoreRowModel:Ke()}),i=t.getRowModel().rows.length===0;return o("table",{css:nn,children:[e("thead",{children:t.getHeaderGroups().map(r=>e("tr",{children:r.headers.map(s=>e("th",{colSpan:s.colSpan,children:s.isPlaceholder?null:e(G,{children:J(s.column.columnDef.header,s.getContext())})},s.id))},r.id))}),i?e(an,{}):e("tbody",{children:t.getRowModel().rows.map(r=>e("tr",{children:r.getVisibleCells().map(s=>e("td",{style:{width:s.column.getSize()},children:J(s.column.columnDef.cell,s.getContext())},s.id))},r.id))})]})}function $g({span:n}){const a=D.useFragment(Cr,n),t=u.useMemo(()=>a.spanAnnotations.filter(r=>r.annotatorKind==="HUMAN"),[a.spanAnnotations]),l=u.useMemo(()=>a.spanAnnotations.filter(r=>r.annotatorKind==="LLM"),[a.spanAnnotations]);return a.spanAnnotations.length>0?o(Be,{children:[e(be,{id:"evaluations",title:"Evaluations",children:e(dl,{annotations:l})}),e(be,{id:"human",title:"Human Annotations",children:e(dl,{annotations:t})})]}):e(zg,{})}function Og(n){return n==="__REDACTED__"}const Qg=C`
  position: relative;
  overflow: hidden;
  width: 200px;
  height: 200px;
  border-radius: var(--ac-global-rounding-small);
  border: 1px solid var(--ac-global-color-grey-500);
  background-color: var(--ac-global-color-grey-200);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  transition:
    width 0.1s ease-in-out,
    height 0.1s ease-in-out opacity 0.1s ease-in-out;
  button {
    position: absolute;
    right: var(--ac-global-dimension-size-100);
    top: var(--ac-global-dimension-size-100);
    z-index: 1;
    opacity: 0;
  }
  &:hover button {
    opacity: 1;
  }
  img {
    width: inherit;
    height: inherit;
    object-fit: contain;
  }

  &.is-expanded {
    width: 100%;
    height: 100%;
    img {
      object-fit: cover;
    }
  }
`;function jg(n){const[a,t]=u.useState(!1);let l;const i=Og(n.url);return i?l=e(qg,{}):l=e("img",{src:n.url}),o("div",{className:Xo({"is-expanded":a}),css:Qg,children:[!i&&e(z,{variant:"default",size:"compact",onClick:()=>t(!a),icon:e(L,{svg:a?e(I.CollapseOutline,{}):e(I.ExpandOutline,{})}),"aria-label":"Expand / Collapse Image"}),l]})}const qg=()=>o("svg",{width:"130",height:"130",viewBox:"0 0 130 130",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("rect",{x:"1.5",y:"1.5",width:"127",height:"127",rx:"6.5",strokeOpacity:"0.8",strokeWidth:"3"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M40 27.5H90C96.8917 27.5 102.5 33.1083 102.5 40V90C102.5 96.8917 96.8917 102.5 90 102.5H40C33.1083 102.5 27.5 96.8917 27.5 90V40C27.5 33.1083 33.1083 27.5 40 27.5ZM40 35.8333H90C92.3 35.8333 94.1667 37.7 94.1667 40V74.85L80.8208 63.4667C76.6958 59.9583 70.2417 59.9583 66.1542 63.4417L35.8333 88.7417V40C35.8333 37.7 37.7 35.8333 40 35.8333ZM54.5833 50.4167C54.5833 53.8667 51.7833 56.6667 48.3333 56.6667C44.8833 56.6667 42.0833 53.8667 42.0833 50.4167C42.0833 46.9667 44.8833 44.1667 48.3333 44.1667C51.7833 44.1667 54.5833 46.9667 54.5833 50.4167ZM42.3375 94.1667H90C92.3 94.1667 94.1667 92.3 94.1667 90V85.8083L75.4125 69.8083C74.4083 68.9458 72.55 68.9417 71.525 69.8125L42.3375 94.1667Z",fill:"var(--ac-global-color-grey-300)"})]}),Fr=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a},params:{cacheID:"d93c9d47668fc266ba09ecb14c2b72ae",id:null,metadata:{},name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",operationKind:"mutation",text:`mutation SpanToDatasetExampleDialogAddExampleToDatasetMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();Fr.hash="75120065d239f28304e9dd91fc34bec9";const Kr=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],t={kind:"InlineFragment",selections:[{alias:"revision",args:null,concreteType:"SpanAsExampleRevision",kind:"LinkedField",name:"asExampleRevision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"68887dda2ffa7793e66ff83d472c72f8",id:null,metadata:{},name:"SpanToDatasetExampleDialogQuery",operationKind:"query",text:`query SpanToDatasetExampleDialogQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      revision: asExampleRevision {
        input
        output
        metadata
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Kr.hash="647a1865dacf40ce9bbb255b572a9a68";const ot={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function Ug({spanId:n,onCompleted:a}){const[t,l]=u.useState(null),i=D.useLazyLoadQuery(Kr,{spanId:n},{fetchPolicy:"store-and-network"}),{span:{revision:r}}=i,[s,c]=D.useMutation(Fr),{control:d,setError:m,handleSubmit:y,formState:{isValid:g}}=Ue({defaultValues:{input:JSON.stringify(r==null?void 0:r.input,null,2),output:JSON.stringify(r==null?void 0:r.output,null,2),metadata:JSON.stringify(r==null?void 0:r.metadata,null,2),datasetId:""}}),p=u.useCallback(f=>{if(l(null),!ln(f==null?void 0:f.input))return m("input",{message:"Input must be a valid JSON object"});if(!ln(f==null?void 0:f.output))return m("output",{message:"Output must be a valid JSON object"});if(!ln(f==null?void 0:f.metadata))return m("metadata",{message:"Metadata must be a valid JSON object"});if(!(f!=null&&f.datasetId))return m("datasetId",{message:"Dataset is required"});s({variables:{input:{datasetId:f.datasetId,examples:[{input:JSON.parse(f.input),output:JSON.parse(f.output),metadata:JSON.parse(f.metadata),spanId:n}]}},onCompleted:()=>{a(f.datasetId)},onError:k=>{l(k.message)}})},[s,m,n,a]);return e(Z,{size:"fullscreen",title:"Add Example to Dataset",extra:e(z,{variant:"primary",size:"compact",disabled:!g||c,loading:c,onClick:y(p),icon:e(L,{svg:e(I.PlusCircleOutline,{})}),children:"Add Example"}),children:e("div",{css:C`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
          /* Make widths configurable */
          .dataset-picker {
            width: 100%;
            .ac-dropdown--picker,
            .ac-dropdown-button {
              width: 100%;
            }
          }
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(K,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:o(h,{direction:"column",gap:"size-200",children:[t?e(ue,{variant:"danger",children:t}):null,e(W,{control:d,name:"datasetId",render:({field:{onChange:f,onBlur:k},fieldState:{invalid:b,error:S}})=>o(h,{direction:"row",gap:"size-100",alignItems:"end",children:[e(Wl,{onSelectionChange:f,onBlur:k,validationState:b?"invalid":"valid",errorMessage:S==null?void 0:S.message,label:"Dataset"}),e(gc,{})]})}),e(W,{control:d,name:"input",render:({field:{onChange:f,onBlur:k,value:b},fieldState:{invalid:S,error:v}})=>o(q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...ot,children:[S?e(ue,{variant:"danger",banner:!0,children:v==null?void 0:v.message}):null,e(_e,{value:b,onChange:f,onBlur:k})]})}),e(W,{control:d,name:"output",render:({field:{onChange:f,onBlur:k,value:b},fieldState:{invalid:S,error:v}})=>o(q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...ot,backgroundColor:"green-100",borderColor:"green-700",children:[S?e(ue,{variant:"danger",banner:!0,children:v==null?void 0:v.message}):null,e(_e,{value:b,onChange:f,onBlur:k})]})}),e(W,{control:d,name:"metadata",render:({field:{onChange:f,onBlur:k,value:b},fieldState:{invalid:S,error:v}})=>o(q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...ot,children:[S?e(ue,{variant:"danger",banner:!0,children:v==null?void 0:v.message}):null,e(_e,{value:b,onChange:f,onBlur:k})]})})]})})})})})}const Bg=n=>u.useMemo(()=>Ae(n),[n]),Hg=n=>n.events.some(a=>a.name==="exception"),ge={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0};function Gg({spanNodeId:n,projectId:a}){const t=X(),{span:l}=D.useLazyLoadQuery(br,{spanId:n});if(l.__typename!=="Span")throw new Error("Expected a span, but got a different type"+l.__typename);const i=u.useMemo(()=>Hg(l),[l]),r=ze(c=>c.showSpanAside),s=ze(c=>c.setShowSpanAside);return o(h,{direction:"column",flex:"1 1 auto",height:"100%",children:[e(K,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-150",paddingEnd:"size-200",flex:"none",children:o(h,{direction:"row",gap:"size-200",alignItems:"center",children:[o(h,{direction:"row",gap:"size-100",width:"100%",height:"100%",alignItems:"center",children:[e(Lt,{spanKind:l.spanKind}),e(x,{children:l.name})]}),o(h,{flex:"none",direction:"row",alignItems:"center",gap:"size-100",children:[e(z,{variant:"default",icon:e(L,{svg:e(I.PlayCircleOutline,{})}),disabled:l.spanKind!=="llm",onClick:()=>{t(`/playground/spans/${l.id}`)},children:"Playground"}),e(Ng,{traceId:l.context.traceId,spanId:l.context.spanId}),e(Zg,{span:l}),e(Ai,{spanNodeId:l.id,projectId:a}),o(pe,{placement:"top",offset:5,children:[e(z,{variant:"default","aria-label":"Toggle showing span details",onClick:()=>{s(!r)},icon:e(L,{svg:r?e(I.SlideIn,{}):e(I.SlideOut,{})})}),e(Ie,{children:r?"Hide Span Details":"Show Span Details"})]})]})]})}),o(Qe,{children:[e(ne,{name:"Info",children:o(h,{direction:"row",height:"100%",children:[e(Jg,{children:e(Tt,{children:e(Yg,{span:l})})}),r?e(Mg,{span:l}):null]})}),e(ne,{name:"Feedback",extra:e(Je,{variant:"light",children:l.spanAnnotations.length}),children:c=>c?e($g,{span:l}):null}),e(ne,{name:"Attributes",title:"Attributes",children:e(K,{padding:"size-200",children:e(q,{title:"All Attributes",...ge,titleExtra:Ir,extra:e(se,{text:l.attributes}),bodyStyle:{padding:0},children:e(hn,{children:l.attributes})})})}),e(ne,{name:"Events",extra:e(Je,{variant:i?"danger":"light",children:l.events.length}),children:e(yp,{events:l.events})})]})]})}const Wg=C`
  flex: 1 1 auto;
  overflow-y: auto;
  // Overflow fails to take into account padding
  & > *:after {
    content: "";
    display: block;
    height: var(--ac-global-dimension-static-size-400);
  }
`;function Jg({children:n}){return e("div",{css:Wg,"data-testid":"span-info-wrap",children:n})}function Zg({span:n}){const[a,t]=u.useState(null),l=xe(),i=X(),r=u.useCallback(()=>{t(e(Ug,{spanId:n.id,onCompleted:s=>{t(null),l({title:"Span Added to Dataset",message:"Successfully added span to dataset",action:{text:"View Dataset",onClick:()=>{i(`/datasets/${s}/examples`)}}})}}))},[n.id,l,i]);return o(G,{children:[e(z,{variant:"default",icon:e(L,{svg:e(I.DatabaseOutline,{})}),onClick:r,children:"Add to Dataset"}),e(u.Suspense,{children:e(ee,{type:"slideOver",isDismissable:!0,onDismiss:()=>t(null),children:a})})]})}function Yg({span:n}){const{spanKind:a,attributes:t}=n,{json:l,parseError:i}=Bg(t),r=u.useMemo(()=>n.statusMessage?e(ue,{variant:"danger",title:"Status Description",children:n.statusMessage}):null,[n]);if(i||!l)return e(K,{padding:"size-200",children:o(h,{direction:"column",gap:"size-200",children:[r,e(ue,{variant:"warning",title:"Un-parsable attributes",children:`Failed to parse span attributes. ${i instanceof Error?i.message:""}`}),e(q,{...ge,title:"Attributes",children:e(K,{padding:"size-100",children:t})})]})});let s;switch(a){case"llm":{s=e(Xg,{span:n,spanAttributes:l});break}case"retriever":{s=e(ep,{span:n,spanAttributes:l});break}case"reranker":{s=e(np,{span:n,spanAttributes:l});break}case"embedding":{s=e(ap,{span:n,spanAttributes:l});break}case"tool":{s=e(tp,{span:n,spanAttributes:l});break}default:s=e(xr,{span:n})}return e(K,{padding:"size-200",children:o(h,{direction:"column",gap:"size-200",children:[r,s,l!=null&&l.metadata?e(q,{...ge,title:"Metadata",children:e(hn,{children:JSON.stringify(l.metadata)})}):null]})})}function Xg(n){const{spanAttributes:a,span:t}=n,{input:l,output:i}=t,r=u.useMemo(()=>a[de.llm]||null,[a]),s=u.useMemo(()=>{if(r==null)return null;const w=r[Le.model_name];return typeof w=="string"?w:null},[r]),c=u.useMemo(()=>{if(r==null)return[];const w=r[Le.input_messages];return ol(w)?(w==null?void 0:w.map(_=>_[de.message]).filter(Boolean))||[]:[]},[r]),d=u.useMemo(()=>{if(r==null)return[];const w=r[Le.tools];return Array.isArray(w)?w==null?void 0:w.map(Q=>Q[de.tool]).filter(Boolean):[]},[r]),m=u.useMemo(()=>d.reduce((w,_)=>(_!=null&&_.json_schema&&w.push(_.json_schema),w),[]),[d]),y=u.useMemo(()=>{if(r==null)return[];const w=r[Le.output_messages];return ol(w)?w.map(_=>_[de.message]).filter(Boolean)||[]:[]},[r]),g=u.useMemo(()=>{if(r==null)return[];const w=r[Le.prompts];return pc(w)?w:[]},[r]),p=u.useMemo(()=>{if(r==null)return null;const w=r[Le.prompt_template];return w??null},[r]),f=u.useMemo(()=>r==null?"{}":r[Le.invocation_parameters]||"{}",[r]),k=u.useMemo(()=>s==null?null:o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(wt,{spanKind:"llm"}),e(x,{textSize:"large",weight:"heavy",children:s})]}),[s]),b=l!=null&&l.value!=null,S=c.length>0,v=m.length>0,P=i!=null&&i.value!=null,E=y.length>0,R=g.length>0,F=Object.keys(JSON.parse(f)).length>0,T=p!=null;return o(h,{direction:"column",gap:"size-200",children:[e(q,{collapsible:!0,backgroundColor:"light",borderColor:"light",bodyStyle:{padding:0},titleSeparator:!1,variant:"compact",title:k,children:o(Qe,{children:[S?e(ne,{name:"Input Messages",hidden:!S,children:e(cl,{messages:c})}):null,v?e(ne,{name:"Tools",hidden:!v,children:e(sp,{toolSchemas:m})}):null,b?e(ne,{name:"Input",hidden:!b,children:e(K,{padding:"size-200",children:e(qe,{children:e(q,{...ge,title:"LLM Input",extra:o(h,{direction:"row",gap:"size-100",children:[e(Ye,{}),e(se,{text:l.value})]}),children:e(dn,{...l})})})})}):null,T?e(ne,{name:"Prompt Template",hidden:!T,children:e(K,{padding:"size-200",children:o(h,{direction:"column",gap:"size-100",children:[e(K,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:o(Aa,{text:p.template,children:[e(x,{color:"text-700",fontStyle:"italic",children:"prompt template"}),e(Tr,{children:p.template})]})}),e(K,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:o(Aa,{text:JSON.stringify(p.variables),children:[e(x,{color:"text-700",fontStyle:"italic",children:"template variables"}),e(hn,{children:JSON.stringify(p.variables)})]})})]})})}):null,e(ne,{name:"Prompts",hidden:!R,children:e(op,{prompts:g})}),e(ne,{name:"Invocation Params",hidden:!F,children:e(Aa,{text:f,padding:"size-100",children:e(hn,{children:f})})})]})}),P||E?e(Ct,{...ge,children:o(Qe,{children:[E?e(ne,{name:"Output Messages",hidden:!E,children:e(cl,{messages:y})}):null,P?e(ne,{name:"Output",hidden:!P,children:e(K,{padding:"size-200",children:e(qe,{children:e(q,{...ge,title:"LLM Output",extra:o(h,{direction:"row",gap:"size-100",children:[e(Ye,{}),e(se,{text:i.value})]}),children:e(dn,{...i})})})})}):null]})}):null]})}function ep(n){const{spanAttributes:a,span:t}=n,{input:l}=t,i=u.useMemo(()=>a[de.retrieval]||null,[a]),r=u.useMemo(()=>{var y;return i==null?[]:((y=i[ed.documents])==null?void 0:y.map(g=>g[de.document]).filter(Boolean))||[]},[i]),s=u.useMemo(()=>t.documentEvaluations.reduce((g,p)=>{const f=p.documentPosition,k=g[f]||[];return{...g,[f]:[...k,p]}},{}),[t.documentEvaluations]),c=l!=null&&l.value!=null,d=r.length>0,m=t.documentRetrievalMetrics.length>0;return o(h,{direction:"column",gap:"size-200",children:[c?e(qe,{children:e(q,{title:"Input",...ge,extra:o(h,{direction:"row",gap:"size-100",children:[e(Ye,{}),e(se,{text:l.value})]}),children:e(dn,{...l})})}):null,d?e(qe,{children:e(q,{title:"Documents",...ge,titleExtra:m&&e(h,{direction:"row",alignItems:"center",gap:"size-100",children:t.documentRetrievalMetrics.map(y=>o(G,{children:[e($e,{name:y.evaluationName,metric:"ndcg",score:y.ndcg},"ndcg"),e($e,{name:y.evaluationName,metric:"precision",score:y.precision},"precision"),e($e,{name:y.evaluationName,metric:"hit",score:y.hit},"hit")]}))}),extra:e(Ye,{}),children:e("ul",{css:C`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
              `,children:r.map((y,g)=>e("li",{children:e(kt,{document:y,documentEvaluations:s[g],borderColor:"seafoam-700",backgroundColor:"seafoam-100",labelColor:"seafoam-1000"})},g))})})}):null]})}function np(n){const{spanAttributes:a}=n,t=u.useMemo(()=>a[de.reranker]||null,[a]),l=u.useMemo(()=>t==null?null:t[at.query]||null,[t]),i=u.useMemo(()=>{var d;return t==null?[]:((d=t[at.input_documents])==null?void 0:d.map(m=>m[de.document]).filter(Boolean))||[]},[t]),r=u.useMemo(()=>{var d;return t==null?[]:((d=t[at.output_documents])==null?void 0:d.map(m=>m[de.document]).filter(Boolean))||[]},[t]),s=i.length,c=r.length;return o(h,{direction:"column",gap:"size-200",children:[e(qe,{children:l&&e(q,{title:"Query",...ge,children:e(la,{children:l})})}),e(q,{title:"Input Documents",titleExtra:e(Je,{variant:"light",children:s}),...ge,defaultOpen:!1,bodyStyle:{padding:0},children:e("ul",{css:C`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:i.map((d,m)=>e("li",{children:e(kt,{document:d,borderColor:"seafoam-700",backgroundColor:"seafoam-100",labelColor:"seafoam-1000"})},m))})}),e(q,{title:"Output Documents",titleExtra:e(Je,{variant:"light",children:c}),...ge,bodyStyle:{padding:0},children:e("ul",{css:C`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:r.map((d,m)=>e("li",{children:e(kt,{document:d,borderColor:"celery-700",backgroundColor:"celery-100",labelColor:"celery-1000"})},m))})})]})}function ap(n){const{spanAttributes:a}=n,t=u.useMemo(()=>a[de.embedding]||null,[a]),l=u.useMemo(()=>{var s;return t==null?[]:((s=t[tt.embeddings])==null?void 0:s.map(c=>c[de.embedding]).filter(Boolean))||[]},[t]),i=l.length>0,r=t==null?void 0:t[tt.model_name];return e(h,{direction:"column",gap:"size-200",children:i?e(q,{title:"Embeddings"+(typeof r=="string"?`: ${r}`:""),...ge,children:e("ul",{css:C`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
              `,children:l.map((s,c)=>e("li",{children:e(qe,{children:e(q,{...ge,backgroundColor:"purple-100",borderColor:"purple-700",title:"Embedded Text",children:e(la,{children:s[tt.text]||""})})})},c))})}):e(xr,{span:n.span})})}function tp(n){const{span:a,spanAttributes:t}=n,{input:l,output:i}=a,r=typeof(l==null?void 0:l.value)=="string",s=typeof(i==null?void 0:i.value)=="string",c=(l==null?void 0:l.mimeType)==="text",d=(i==null?void 0:i.mimeType)==="text",m=u.useMemo(()=>t[de.tool]||{},[t]),y=Object.keys(m).length>0,g=m[La.name],p=m[La.description],f=m[La.parameters];return!r&&!s&&!y?null:o(h,{direction:"column",gap:"size-200",children:[r?e(qe,{children:e(q,{title:"Input",...ge,extra:o(h,{direction:"row",gap:"size-100",children:[c?e(Ye,{}):null,e(se,{text:l.value})]}),children:e(dn,{...l})})}):null,s?e(qe,{children:e(q,{title:"Output",...ge,backgroundColor:"green-100",borderColor:"green-700",extra:o(h,{direction:"row",gap:"size-100",children:[d?e(Ye,{}):null,e(se,{text:i.value})]}),children:e(dn,{...i})})}):null,y?e(q,{title:"Tool"+(typeof g=="string"?`: ${g}`:""),...ge,children:o(h,{direction:"column",children:[p!=null?e(K,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"light",children:o(h,{direction:"column",alignItems:"start",gap:"size-50",children:[e(x,{color:"text-700",fontStyle:"italic",children:"Description"}),e(x,{children:p})]})}):null,f!=null?e(K,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",children:o(h,{direction:"column",alignItems:"start",width:"100%",children:[e(x,{color:"text-700",fontStyle:"italic",children:"Parameters"}),e(hn,{children:JSON.stringify(f)})]})}):null]})}):null]})}const lp=["irrelevant","unrelated"];function kt({document:n,documentEvaluations:a,backgroundColor:t,borderColor:l,labelColor:i}){const r=n[sa.metadata],s=a&&a.length,c=n[sa.content];return e(q,{...ge,backgroundColor:t,borderColor:l,bodyStyle:{padding:0},title:o(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(I.FileOutline,{})}),o(ce,{level:4,children:["document ",n[sa.id]]})]}),extra:typeof n[sa.score]=="number"&&e(wa,{color:i,children:`score ${Dt(n[sa.score])}`}),children:o(h,{direction:"column",children:[c&&e(K,{padding:"size-200",children:e(la,{children:c})}),r&&e(G,{children:e(K,{borderColor:l,borderTopWidth:"thin",children:e(hn,{children:JSON.stringify(r)})})}),s&&e(K,{borderColor:l,borderTopWidth:"thin",padding:"size-200",children:o(h,{direction:"column",gap:"size-100",children:[e(ce,{level:3,weight:"heavy",children:"Evaluations"}),e("ul",{children:a.map((d,m)=>{const y=d.label&&lp.includes(d.label)?"danger":i;return e("li",{children:e(K,{padding:"size-200",borderWidth:"thin",borderColor:l,borderRadius:"medium",children:o(h,{direction:"column",gap:"size-50",children:[o(h,{direction:"row",gap:"size-100",children:[e(x,{weight:"heavy",elementType:"h5",children:d.name}),d.label&&e(wa,{color:y,shape:"badge",children:d.label}),typeof d.score=="number"&&e(wa,{color:y,shape:"badge",children:o(h,{direction:"row",gap:"size-50",children:[e(x,{textSize:"xsmall",weight:"heavy",color:"inherit",children:"score"}),e(x,{textSize:"xsmall",children:pn(d.score)})]})})]}),typeof d.explanation&&e("p",{css:C`
                                margin-top: var(
                                  --ac-global-dimension-static-size-100
                                );
                                margin-bottom: 0;
                              `,children:d.explanation})]})})},m)})})]})})]})})}function ip({message:n}){var c;const a=n[Pe.content],t=n[Pe.contents],l=((c=n[Pe.tool_calls])==null?void 0:c.map(d=>d[de.tool_call]).filter(Boolean))||[],i=n[Pe.function_call_arguments_json]&&n[Pe.function_call_name],r=n[Pe.role]||"unknown",s=Ja(r);return e(qe,{children:o(q,{...ge,...s,title:r+(n[Pe.name]?`: ${n[Pe.name]}`:""),extra:o(h,{direction:"row",gap:"size-100",children:[e(Ye,{}),e(se,{text:a||JSON.stringify(n)})]}),children:[e(Tt,{children:t?e(cp,{messageContents:t}):null}),o(h,{direction:"column",alignItems:"start",children:[a?e(la,{children:a}):null,l.length>0?l.map((d,m)=>{var y,g;return o("pre",{css:C`
                      text-wrap: wrap;
                      margin: var(--ac-global-dimension-static-size-100) 0;
                    `,children:[(y=d==null?void 0:d.function)==null?void 0:y.name,"(",JSON.stringify(JSON.parse((g=d==null?void 0:d.function)==null?void 0:g.arguments),null,2),")"]},m)}):null,i?o("pre",{css:C`
                text-wrap: wrap;
                margin: var(--ac-global-dimension-static-size-100) 0;
              `,children:[n[Pe.function_call_name],"(",JSON.stringify(JSON.parse(n[Pe.function_call_arguments_json]),null,2),")"]}):null]})]})})}function rp({toolSchema:n,index:a}){return e(q,{title:o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(wt,{spanKind:"tool"}),e(x,{textSize:"large",weight:"heavy",children:"Tool"})]}),titleExtra:o(Je,{variant:"light",children:["#",a+1]}),...ge,backgroundColor:"yellow-100",borderColor:"yellow-700",bodyStyle:{padding:0},extra:e(se,{text:n}),children:e(dn,{value:n,mimeType:"json"})})}function cl({messages:n}){return e("ul",{css:C`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,t)=>e("li",{children:e(ip,{message:a})},t))})}function sp({toolSchemas:n}){return e("ul",{css:C`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,t)=>e("li",{children:e(rp,{toolSchema:a,index:t})},t))})}function op({prompts:n}){return e("ul",{"data-testid":"llm-prompts-list",css:C`
        padding: var(--ac-global-dimension-size-200);
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-size-100);
      `,children:n.map((a,t)=>e("li",{children:e(K,{backgroundColor:"gray-600",borderColor:"gray-400",borderWidth:"thin",borderRadius:"medium",padding:"size-100",children:e(Aa,{text:a,children:e(dn,{value:a,mimeType:"text"})})})},t))})}const dp=C`
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-size-200);
  flex-wrap: wrap;
`;function cp({messageContents:n}){return e("ul",{css:dp,"data-testid":"message-content-list",children:n.map((a,t)=>e(mp,{messageContentAttribute:a},t))})}const up=C`
  flex: 1 1 100%;
`;function mp({messageContentAttribute:n}){var r;const{message_content:a}=n,t=a==null?void 0:a.text,l=a==null?void 0:a.image,i=(r=l==null?void 0:l.image)==null?void 0:r.url;return o("li",{css:t?up:null,children:[t?e("pre",{css:C`
            white-space: pre-wrap;
            padding: 0;
            margin: 0;
          `,children:t}):null,i?e(jg,{url:i}):null]})}function xr({span:n}){const{input:a,output:t}=n,l=a==null&&t==null,i=(a==null?void 0:a.mimeType)==="text",r=(t==null?void 0:t.mimeType)==="text";return o(h,{direction:"column",gap:"size-200",children:[a&&a.value!=null?e(qe,{children:e(q,{title:"Input",...ge,extra:o(h,{direction:"row",gap:"size-100",children:[i?e(Ye,{}):null,e(se,{text:a.value})]}),children:e(dn,{...a})})}):null,t&&t.value!=null?e(qe,{children:e(q,{title:"Output",...ge,backgroundColor:"green-100",borderColor:"green-700",extra:o(h,{direction:"row",gap:"size-100",children:[r?e(Ye,{}):null,e(se,{text:t.value})]}),children:e(dn,{...t})})}):null,l?e(q,{title:"All Attributes",titleExtra:Ir,...ge,bodyStyle:{padding:0},extra:e(se,{text:n.attributes}),children:e(hn,{children:n.attributes})}):null]})}const gp=C`
  .cm-content {
    padding: var(--ac-global-dimension-static-size-200) 0;
  }
  .cm-editor,
  .cm-gutters {
    background-color: transparent;
  }
`;function Aa({text:n,children:a,padding:t}){const l=t?`var(--ac-global-dimension-${t})`:"0";return o("div",{css:C`
        position: relative;
        .copy-to-clipboard-button {
          transition: opacity 0.2s ease-in-out;
          opacity: 0;
          position: absolute;
          right: ${l};
          top: ${l};
          z-index: 1;
        }
        &:hover .copy-to-clipboard-button {
          opacity: 1;
        }
      `,children:[e(se,{text:n}),a]})}function hn({children:n}){const{theme:a}=On(),t=a==="light"?void 0:ra,{value:l,mimeType:i}=u.useMemo(()=>{try{return{value:JSON.stringify(JSON.parse(n),null,2),mimeType:"json"}}catch{return{value:n,mimeType:"text"}}},[n]);return i==="json"?e(ia,{value:l,basicSetup:{lineNumbers:!0,foldGutter:!0,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[Zc(),yi.lineWrapping],editable:!1,theme:t,css:gp}):e(Tr,{children:l})}function Tr({children:n}){return e("pre",{css:C`
        white-space: pre-wrap;
        padding: 0;
      `,children:n})}function dn({value:n,mimeType:a}){let t;switch(a){case"json":t=e(hn,{children:n});break;case"text":t=e(la,{children:n});break;default:me()}return t}function pp({text:n}){return o(h,{direction:"column",alignItems:"center",flex:"1 1 auto",height:"size-2400",justifyContent:"center",gap:"size-100",children:[e(ja,{graphicKey:"documents"}),e(x,{children:n})]})}function yp({events:n}){return n.length===0?e(pp,{text:"No events"}):e(wl,{children:n.map((a,t)=>{const l=a.name==="exception";return e(Ll,{children:o(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(K,{flex:"none",children:e("div",{"data-event-type":l?"exception":"info",css:i=>C`
                    &[data-event-type="exception"] {
                      --px-event-icon-color: ${i.colors.statusDanger};
                    }
                    &[data-event-type="info"] {
                      --px-event-icon-color: ${i.colors.statusInfo};
                    }
                    .ac-icon-wrap {
                      color: var(--px-event-icon-color);
                    }
                  `,children:e(L,{svg:l?e(I.AlertTriangleOutline,{}):e(I.InfoOutline,{})})})}),o(h,{direction:"column",gap:"size-25",flex:"1 1 auto",children:[e(x,{weight:"heavy",children:a.name}),e(x,{color:"text-700",children:a.message})]}),e(K,{children:e(x,{color:"text-700",children:new Date(a.timestamp).toLocaleString()})})]})},t)})})}const Ir=e(h,{alignItems:"center",justifyContent:"center",children:e(K,{marginStart:"size-100",children:o(Yn,{children:[e(ce,{weight:"heavy",level:4,children:"Span Attributes"}),e(zn,{children:e(x,{children:"Attributes are key-value pairs that represent metadata associated with a span. For detailed descriptions of specific attributes, consult the semantic conventions section of the OpenInference tracing specification."})}),e("footer",{children:e(He,{href:"https://github.com/Arize-ai/openinference/blob/main/spec/semantic_conventions.md",children:"Semantic Conventions"})})]})})}),dt="selectedSpanNodeId";function fp(n){const a=n.find(i=>i.parentId==null);if(a)return a;const t=new Set(n.map(i=>i.context.spanId)),l=n.filter(i=>i.parentId!=null&&!t.has(i.parentId));return l.length===1?l[0]:null}function Ot(n){var y;const{traceId:a,projectId:t}=n,[l,i]=Sa(),r=D.useLazyLoadQuery(kr,{traceId:a,id:t},{fetchPolicy:"store-and-network"}),s=u.useMemo(()=>{var p;return(((p=r.project.trace)==null?void 0:p.spans.edges)||[]).map(f=>f.span)},[r]),d=l.get(dt)??s[0].id,m=u.useMemo(()=>fp(s),[s]);return u.useEffect(()=>()=>{i(g=>(g.delete(dt),g),{replace:!0})},[]),o("main",{css:C`
        flex: 1 1 auto;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      `,children:[e(hp,{rootSpan:m,sessionId:(y=r.project.trace)==null?void 0:y.projectSessionId}),o(on,{direction:"horizontal",autoSaveId:"trace-panel-group",css:C`
          flex: 1 1 auto;
          overflow: hidden;
        `,children:[e(ke,{defaultSize:30,minSize:10,maxSize:70,children:e(bp,{children:e(yc,{spans:s,selectedSpanNodeId:d,onSpanClick:g=>{i(p=>(p.set(dt,g.id),p),{replace:!0})}})})}),e(sn,{css:bn}),e(ke,{children:e(kp,{children:d?e(u.Suspense,{fallback:e(ye,{}),children:e(Gg,{spanNodeId:d,projectId:t})}):null})})]})]})}function hp({rootSpan:n,sessionId:a}){const{projectId:t}=Ve(),{latencyMs:l,statusCode:i,spanAnnotations:r}=n??{latencyMs:null,statusCode:"UNSET",spanAnnotations:[]},s=r.length>0,c=Gl(i);return e(K,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:o(h,{direction:"row",gap:"size-400",alignItems:"center",children:[o(h,{direction:"column",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Trace Status"}),e(x,{textSize:"xlarge",children:o(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(Ba,{statusCode:i}),e(x,{textSize:"xlarge",color:c,children:i})]})})]}),o(h,{direction:"column",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Latency"}),e(x,{textSize:"xlarge",children:typeof l=="number"?e(Ce,{latencyMs:l,textSize:"xlarge"}):"--"})]}),s?o(h,{direction:"column",gap:"size-50",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Feedback"}),e(h,{direction:"row",gap:"size-50",children:r.map(d=>e(ea,{annotation:d,children:e(un,{annotation:d,annotationDisplayPreference:"label"})},d.name))})]}):null,a&&e("span",{css:C`
              margin-left: auto;
            `,children:e(Ge,{to:`/projects/${t}/sessions/${a}`,children:o(h,{alignItems:"center",children:["View Session ",e(L,{svg:e(I.ArrowIosForwardOutline,{})})]})})})]})})}function kp({children:n}){return e("div",{"data-testid":"scrolling-tabs-wrapper",css:C`
        height: 100%;
        overflow: hidden;
        .ac-tabs {
          height: 100%;
          overflow: hidden;
          .ac-tabs__extra {
            width: 100%;
            padding-right: var(--ac-global-dimension-size-200);
            padding-bottom: var(--ac-global-dimension-size-50);
          }
          .ac-tabs__pane-container {
            min-height: 100%;
            height: 100%;
            overflow-y: auto;
            div[role="tabpanel"] {
              height: 100%;
            }
          }
        }
      `,children:n})}function bp({children:n}){return e("div",{"data-testid":"scrolling-panel-content",css:C`
        height: 100%;
        overflow-y: auto;
      `,children:n})}function $0(){const{traceId:n,projectId:a}=Ve(),t=X();return e(ee,{type:"slideOver",isDismissable:!0,onDismiss:()=>t(`/projects/${a}`),children:e(Z,{size:"fullscreen",title:"Trace Details",children:e(Ot,{traceId:n,projectId:a})})})}const Dr=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={kind:"Variable",name:"timeRange",variableName:"timeRange"},s=[{kind:"Literal",name:"first",value:50},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},r],c={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},d={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},p=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],f={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:p,storageKey:null},k={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:p,storageKey:null},b={alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},S={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},v={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},P=[r];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"TracesTable_spans"},{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"},{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:s,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,c,i,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},d,m,y,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},g,f,k,b,S,v,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"descendants",plural:!0,selections:[l,c,i,d,m,y,g,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},f,k,b,S,v],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:s,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"},{alias:null,args:P,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:P,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},r],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},r],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"400e3bc8456d6d9eb0f4f85fc862ad57",id:null,metadata:{},name:"ProjectPageQuery",operationKind:"query",text:`query ProjectPageQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...TracesTable_spans
    ...ProjectPageHeader_stats
    ...StreamToggle_data
    __isNode: __typename
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  tokenCountTotal(timeRange: $timeRange)
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}

fragment TracesTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: 50, sort: {col: startTime, dir: desc}, rootSpansOnly: true, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode: propagatedStatusCode
        startTime
        latencyMs
        cumulativeTokenCountTotal
        cumulativeTokenCountPrompt
        cumulativeTokenCountCompletion
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        context {
          spanId
          traceId
        }
        spanAnnotations {
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants {
          id
          spanKind
          name
          statusCode: propagatedStatusCode
          startTime
          latencyMs
          parentId
          cumulativeTokenCountTotal: tokenCountTotal
          cumulativeTokenCountPrompt: tokenCountPrompt
          cumulativeTokenCountCompletion: tokenCountCompletion
          input {
            value: truncatedValue
          }
          output {
            value: truncatedValue
          }
          context {
            spanId
            traceId
          }
          spanAnnotations {
            name
            label
            score
            annotatorKind
          }
          documentRetrievalMetrics {
            evaluationName
            ndcg
            precision
            hit
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Dr.hash="e2d168c52b9c1b5fd5543286f4d2786c";const Pr=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:50},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],r=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:i,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:i,filters:["sort","filterIoSubstring","timeRange"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"bea6d52a2d550bcdcc441e8ea3c6fdfc",id:null,metadata:{},name:"ProjectPageSessionsQuery",operationKind:"query",text:`query ProjectPageSessionsQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...SessionsTable_sessions
    __isNode: __typename
    id
  }
}

fragment SessionsTable_sessions on Project {
  name
  sessions(first: 50, sort: {col: startTime, dir: desc}, timeRange: $timeRange) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          prompt
          completion
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Pr.hash="58a3bc9becb7a255676ca0efafb8d0b7";const Lr=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r=[{kind:"Literal",name:"first",value:50},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],s=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageSpansQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageSpansQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:r,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:r,filters:["sort","filterCondition","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"09e4f18ba3f2a63560f542088a4329ff",id:null,metadata:{},name:"ProjectPageSpansQuery",operationKind:"query",text:`query ProjectPageSpansQuery(
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...SpansTable_spans
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: 50, sort: {col: startTime, dir: desc}, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        tokenCountTotal
        tokenCountPrompt
        tokenCountCompletion
        context {
          spanId
          traceId
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Lr.hash="18fe45fad1c124d8c29cdcabf463a213";const wr=function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],l={kind:"Variable",name:"timeRange",variableName:"timeRange"},i=[l];return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectPageHeaderQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectPageHeaderQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:i,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"264a748e3bb636d71fb6b75523a612fe",id:null,metadata:{},name:"ProjectPageHeaderQuery",operationKind:"query",text:`query ProjectPageHeaderQuery(
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ProjectPageHeader_stats
    __isNode: __typename
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  tokenCountTotal(timeRange: $timeRange)
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}
`}}}();wr.hash="dcce9d160db90e2b5c51eef9971101a4";const Er=function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"},a=[n];return{argumentDefinitions:[{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:wr,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ProjectPageHeader_stats",selections:[{alias:null,args:a,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:a,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null}}();Er.hash="dcce9d160db90e2b5c51eef9971101a4";const _r=u.createContext(null);function Qn(){const n=Se.useContext(_r);if(n===null)throw new Error("useStreamState must be used within a StreamStateProvider");return n}function Sp({initialFetchKey:n="initial",children:a}){const t=ze(c=>c.traceStreamingEnabled),l=ze(c=>c.setTraceStreamingEnabled),[i,r]=u.useState(n),s=u.useCallback(c=>{u.startTransition(()=>{r(c)})},[r]);return e(_r.Provider,{value:{isStreaming:t,setIsStreaming:l,fetchKey:i,setFetchKey:s},children:a})}const Rr=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"bae90b7000aa37d37050070d8504b41c",id:null,metadata:{},name:"AnnotationSummaryValueQuery",operationKind:"query",text:`query AnnotationSummaryValueQuery(
  $annotationName: String!
  $timeRange: TimeRange!
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    __isNode: __typename
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}}();Rr.hash="0a8e190e4d87acc87c161366f330e3af";const Ar={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"annotationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Rr,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"AnnotationSummaryValueFragment",selections:[{alias:null,args:[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};Ar.hash="0a8e190e4d87acc87c161366f330e3af";const Mr=function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"AnnotationSummaryQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,t],kind:"Operation",name:"AnnotationSummaryQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"88dfad5d25db7e03286a789f3ba37c75",id:null,metadata:{},name:"AnnotationSummaryQuery",operationKind:"query",text:`query AnnotationSummaryQuery(
  $id: GlobalID!
  $annotationName: String!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    __isNode: __typename
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}}();Mr.hash="6a15ba35fe9e1e35aa4c517ab6309a2b";function vp({annotationName:n}){const{projectId:a}=Ve(),{timeRange:t}=Ha(),l=D.useLazyLoadQuery(Mr,{annotationName:n,id:a,timeRange:{start:t.start.toISOString(),end:t.end.toISOString()}});return o(h,{direction:"column",flex:"none",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:n}),e(u.Suspense,{fallback:e(x,{textSize:"xlarge",children:"--"}),children:e(Cp,{annotationName:n,project:l.project})})]})}function Cp(n){var f,k;const{project:a,annotationName:t}=n,{fetchKey:l}=Qn(),[i,r]=D.useRefetchableFragment(Ar,a);u.useEffect(()=>{u.startTransition(()=>{r({},{fetchPolicy:"store-and-network"})})},[l,r]);const s=gn(),d=[Jl(t),s.default,s.gray600,s.gray400,s.gray200],m=(f=i==null?void 0:i.spanAnnotationSummary)==null?void 0:f.meanScore,y=(k=i==null?void 0:i.spanAnnotationSummary)==null?void 0:k.labelFractions,g=typeof m=="number",p=Array.isArray(y)&&y.length>0;return!g&&!p?e(x,{textSize:"xlarge",children:"--"}):o(pe,{delay:0,placement:"bottom",children:[e(je,{children:o(h,{direction:"row",alignItems:"center",gap:"size-50",children:[p?e(Gc,{width:24,height:24,children:e(Wc,{data:y,dataKey:"fraction",nameKey:"label",cx:"50%",cy:"50%",innerRadius:8,outerRadius:11,strokeWidth:0,stroke:"transparent",children:y.map((b,S)=>e(Jc,{fill:d[S%d.length]},`cell-${S}`))})}):null,e(x,{textSize:"xlarge",children:g?pn(m):"--"})]})}),e(Ca,{children:e(K,{width:"size-2400",children:o(h,{direction:"column",gap:"size-50",children:[p&&e("ul",{children:y.map((b,S)=>e("li",{children:e(we,{color:d[S%d.length],name:b.label,shape:"square",value:Zl(b.fraction*100)})},b.label))}),p&&g?e(Ua,{}):null,g?o(h,{direction:"row",justifyContent:"space-between",children:[e(x,{children:"mean"}),e(x,{children:pn(m)})]}):null]})})})]})}const Nr=function(){var n={defaultValue:null,kind:"LocalArgument",name:"evaluationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,t,a],kind:"Operation",name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"60d7798d88e1408e6b6b0bebdc1716f5",id:null,metadata:{},name:"DocumentEvaluationSummaryValueQuery",operationKind:"query",text:`query DocumentEvaluationSummaryValueQuery(
  $evaluationName: String!
  $timeRange: TimeRange!
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    __isNode: __typename
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}}();Nr.hash="15d0652aa260c80f62acec943f615d93";const zr={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Nr,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DocumentEvaluationSummaryValueFragment",selections:[{alias:null,args:[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};zr.hash="15d0652aa260c80f62acec943f615d93";const Vr=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"3ebd1cf66ef8f31c995ec6aae6505e94",id:null,metadata:{},name:"DocumentEvaluationSummaryQuery",operationKind:"query",text:`query DocumentEvaluationSummaryQuery(
  $evaluationName: String!
  $id: GlobalID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    __isNode: __typename
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}}();Vr.hash="4d50474ffa9b9e4a68d07f6e0777c144";function Fp({evaluationName:n}){const{projectId:a}=Ve(),{timeRange:t}=Ha(),l=D.useLazyLoadQuery(Vr,{id:a,evaluationName:n,timeRange:{start:t.start.toISOString(),end:t.end.toISOString()}});return o(h,{direction:"column",flex:"none",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:n}),e(u.Suspense,{fallback:e(x,{textSize:"xlarge",children:"--"}),children:e(Kp,{evaluationName:n,project:l==null?void 0:l.project})})]})}function Kp(n){var m,y,g,p;const{project:a}=n,{fetchKey:t}=Qn(),[l,i]=D.useRefetchableFragment(zr,a);u.useEffect(()=>{u.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[t,i]);const r=(m=l==null?void 0:l.documentEvaluationSummary)==null?void 0:m.averageNdcg,s=(y=l==null?void 0:l.documentEvaluationSummary)==null?void 0:y.averagePrecision,c=(g=l==null?void 0:l.documentEvaluationSummary)==null?void 0:g.hitRate,d=(p=l==null?void 0:l.documentEvaluationSummary)==null?void 0:p.meanReciprocalRank;return o(pe,{delay:0,placement:"bottom",children:[e(je,{children:e(h,{direction:"row",alignItems:"center",gap:"size-50",height:"28px",children:o(G,{children:[e($e,{metric:"ndcg",score:r},"ndcg"),e($e,{metric:"precision",score:s},"precision"),e($e,{metric:"hit rate",score:c},"hit")]})})}),e(Ca,{children:e(K,{width:"size-2400",children:o(h,{direction:"column",children:[o(h,{justifyContent:"space-between",children:[e(x,{children:"average ndcg"}),e(x,{children:typeof r=="number"?pn(r):"--"})]}),o(h,{justifyContent:"space-between",children:[e(x,{children:"average precision"}),e(x,{children:typeof s=="number"?pn(s):"--"})]}),o(h,{justifyContent:"space-between",children:[e(x,{children:"mean reciprocal rank"}),e(x,{children:typeof d=="number"?pn(d):"--"})]}),o(h,{justifyContent:"space-between",children:[e(x,{children:"hit rate"}),e(x,{children:typeof c=="number"?pn(c):"--"})]})]})})})]})}function xp(n){const{extra:a}=n,{fetchKey:t}=Qn(),[l,i]=D.useRefetchableFragment(Er,n.project);u.useEffect(()=>{u.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[t,i]);const r=l==null?void 0:l.latencyMsP50,s=l==null?void 0:l.latencyMsP99,c=l==null?void 0:l.tokenCountTotal,d=l==null?void 0:l.spanAnnotationNames,m=l==null?void 0:l.documentEvaluationNames;return e(K,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-50",flex:"none",children:o(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e("div",{css:C`
            overflow-x: auto;
            overflow-y: hidden;
            flex: 1 1 auto;
            background-image: linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              ),
              linear-gradient(
                to left,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              );
            background-repeat: no-repeat;
            background-size:
              32px 100%,
              32px 100%,
              32px 100%,
              32px 100%;
            background-position:
              left center,
              right center,
              left center,
              right center;
            background-attachment: local, local, scroll, scroll;
          `,children:o(h,{direction:"row",gap:"size-400",alignItems:"center",children:[o(h,{direction:"column",flex:"none",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Total Traces"}),e(x,{textSize:"xlarge",children:En(l==null?void 0:l.traceCount)})]}),o(h,{direction:"column",flex:"none",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Total Tokens"}),e(x,{textSize:"xlarge",children:En(c)})]}),o(h,{direction:"column",flex:"none",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Latency P50"}),r!=null?e(Ce,{latencyMs:r,textSize:"xlarge"}):e(x,{textSize:"xlarge",children:"--"})]}),o(h,{direction:"column",flex:"none",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Latency P99"}),s!=null?e(Ce,{latencyMs:s,textSize:"xlarge"}):e(x,{textSize:"xlarge",children:"--"})]}),d.map(y=>e(vp,{annotationName:y},y)),m.map(y=>e(Fp,{evaluationName:y},`document-${y}`))]})}),e(K,{flex:"none",paddingStart:"size-100",children:a})]})})}const $r=u.createContext(null);function Or(){const n=u.useContext($r);if(n===null)throw new Error("useSessionSubstring must be used within a SessionSubstringProvider");return n}function Tp(n){const[a,t]=u.useState(""),l=u.useCallback(i=>{u.startTransition(()=>{t(i)})},[]);return e($r.Provider,{value:{filterIoSubstring:a,setFilterIoSubstring:l},children:n.children})}const Qr=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},t={defaultValue:50,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},s=[{kind:"Variable",name:"id",variableName:"id"}],c={kind:"Variable",name:"after",variableName:"after"},d={kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},m={kind:"Variable",name:"first",variableName:"first"},y={kind:"Variable",name:"sort",variableName:"sort"},g={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f=[c,d,m,y,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],k=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,t,l,i,r],kind:"Fragment",metadata:null,name:"SessionsTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[c,d,m,y],kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,t,i,r,l],kind:"Operation",name:"SessionsTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,{kind:"TypeDiscriminator",abstractKey:"__isNode"},p,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:f,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[p,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:k,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:k,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[g],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:f,filters:["sort","filterIoSubstring","timeRange"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"07b07c6e6b2088166d9ae2faf0847ef8",id:null,metadata:{},name:"SessionsTableQuery",operationKind:"query",text:`query SessionsTableQuery(
  $after: String = null
  $filterIoSubstring: String = null
  $first: Int = 50
  $sort: ProjectSessionSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SessionsTable_sessions_2MhLSo
    __isNode: __typename
    id
  }
}

fragment SessionsTable_sessions_2MhLSo on Project {
  name
  sessions(first: $first, after: $after, sort: $sort, filterIoSubstring: $filterIoSubstring, timeRange: $timeRange) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          prompt
          completion
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Qr.hash="73d205acbb256ea1f2cf68875634a21b";const jr=function(){var n=["sessions"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Qr,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SessionsTable_sessions",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:"sessions",args:[{kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"__SessionsTable_sessions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Project",abstractKey:null}}();jr.hash="73d205acbb256ea1f2cf68875634a21b";const qr=u.createContext(null);function Ip({children:n,...a}){const[t]=u.useState(()=>fc(a));return e(qr.Provider,{value:t,children:n})}function cn(n,a){const t=Se.useContext(qr);if(!t)throw new Error("Missing TracingContext.Provider in the tree");return ba(t,n,a)}const Dp=C`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,Pp=C`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function Lp(n){const{placeholder:a="Search messages"}=n,[t,l]=u.useState(!1),{filterIoSubstring:i,setFilterIoSubstring:r}=Or(),{theme:s}=On(),c=s==="dark"?ra:void 0,d=i!=="";return e("div",{"data-is-focused":t,className:"sessions-substring-field",css:Pp,children:o(h,{direction:"row",children:[e(El,{children:e(L,{svg:e(I.Search,{})})}),e(ia,{css:Dp,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!1,syntaxHighlighting:!1,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>l(!0),onBlur:()=>l(!1),value:i,onChange:r,height:"36px",width:"100%",theme:c,placeholder:a}),e("button",{css:C`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${d?"visible":"hidden"};
          `,onClick:()=>r(""),className:"button--reset",children:e(L,{svg:e(I.CloseCircleOutline,{})})})]})})}const wp="pip install openinference-instrumentation",Ep=`import uuid

import openai
from openinference.instrumentation import using_session
from openinference.semconv.trace import SpanAttributes
from opentelemetry import trace

client = openai.Client()
session_id = str(uuid.uuid4())

tracer = trace.get_tracer(__name__)

@tracer.start_as_current_span(name="agent", attributes={SpanAttributes.OPENINFERENCE_SPAN_KIND: "agent"})
def assistant(
  messages: list[dict],
  session_id: str = str,
):
  current_span = trace.get_current_span()
  current_span.set_attribute(SpanAttributes.SESSION_ID, session_id)
  current_span.set_attribute(SpanAttributes.INPUT_VALUE, messages[-1].get('content'))

  # Propagate the session_id down to spans crated by the OpenAI instrumentation
  # This is not strictly necessary, but it helps to correlate the spans to the same session
  with using_session(session_id):
   response = client.chat.completions.create(
       model="gpt-3.5-turbo",
       messages=[{"role": "system", "content": "You are a helpful assistant."}] + messages,
   ).choices[0].message

  current_span.set_attribute(SpanAttributes.OUTPUT_VALUE, response.content)
  return response

messages = [
  {"role": "user", "content": "hi! im bob"}
]
response = assistant(
  messages,
  session_id=session_id,
)
messages = messages + [
  response,
  {"role": "user", "content": "what's my name?"}
]
response = assistant(
  messages,
  session_id=session_id,
)`;function _p(){return o("div",{children:[e(K,{paddingTop:"size-200",paddingBottom:"size-100",children:e(ce,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(K,{paddingBottom:"size-100",children:o(x,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Ne,{children:e(We,{value:wp})}),e(K,{paddingTop:"size-200",paddingBottom:"size-100",children:e(ce,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(K,{paddingBottom:"size-100",children:e(x,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Ne,{children:e(We,{value:Ep})}),e(K,{paddingBottom:"size-100",paddingTop:"size-100",children:o(x,{children:["For more information on how to use sessions, consult the"," ",e(He,{href:"https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}const Rp="npm install @arizeai/openinference-core --save",Ap=`import { trace } from "@opentelemetry/api";
import { SemanticConventions } from "@arizeai/openinference-semantic-conventions";
import { context } from "@opentelemetry/api";
import { setSession } from "@arizeai/openinference-core";

const tracer = trace.getTracer("agent");

const client = new OpenAI({
  apiKey: process.env["OPENAI_API_KEY"], // This is the default and can be omitted
});

async function assistant(params: {
  messages: { role: string; content: string }[];
  sessionId: string;
}) {
  return tracer.startActiveSpan("agent", async (span: Span) => {
    span.setAttribute(SemanticConventions.OPENINFERENCE_SPAN_KIND, "agent");
    span.setAttribute(SemanticConventions.SESSION_ID, params.sessionId);
    span.setAttribute(
      SemanticConventions.INPUT_VALUE,
      messages[messages.length - 1].content,
    );
    try {
      // This is not strictly necessary but it helps propagate the session ID
      // to all child spans
      return context.with(
        setSession(context.active(), { sessionId: params.sessionId }),
        async () => {
          // Calls within this block will generate spans with the session ID set
          const chatCompletion = await client.chat.completions.create({
            messages: params.messages,
            model: "gpt-3.5-turbo",
          });
          const response = chatCompletion.choices[0].message;
          span.setAttribute(SemanticConventions.OUTPUT_VALUE, response.content);
          span.end();
          return response;
        },
      );
    } catch (e) {
      span.error(e);
    }
  });
}

const sessionId = crypto.randomUUID();

let messages = [{ role: "user", content: "hi! im Tim" }];

const res = await assistant({
  messages,
  sessionId: sessionId,
});

messages = [res, { role: "assistant", content: "What is my name?" }];

await assistant({
  messages,
  sessionId: sessionId,
});
`;function Mp(){return o("div",{children:[e(K,{paddingTop:"size-200",paddingBottom:"size-100",children:e(ce,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(K,{paddingBottom:"size-100",children:o(x,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Ne,{children:e(We,{value:Rp})}),e(K,{paddingTop:"size-200",paddingBottom:"size-100",children:e(ce,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(K,{paddingBottom:"size-100",children:e(x,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Ne,{children:e(hc,{value:Ap})}),e(K,{paddingBottom:"size-100",children:o(x,{children:["For more information on how to use sessions, consult the"," ",e(He,{href:"https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}function Np(){const[n,a]=u.useState("Python");return e(Z,{title:"Setup Sessions for this Project",size:"L",children:o(K,{padding:"size-400",overflow:"auto",children:[e(K,{paddingBottom:"size-100",children:e(Et,{language:n,onChange:a})}),n==="Python"?e(_p,{}):e(Mp,{})]})})}function zp(){const[n,a]=u.useState(null),t=()=>{a(e(Np,{}))};return o("tbody",{className:"is-empty",children:[e("tr",{children:e("td",{colSpan:100,css:l=>C`
            text-align: center;
            padding: ${l.spacing.margin24}px ${l.spacing.margin24}px !important;
          `,children:o(h,{direction:"column",gap:"size-200",alignItems:"center",children:["No sessions found for this project",e(z,{variant:"default",icon:e(L,{svg:e(I.PlayCircleOutline,{})}),onClick:t,children:"Setup Sessions"})]})})}),e(ee,{onDismiss:()=>a(null),isDismissable:!0,type:"slideOver",children:n})]})}const Qt=C`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  overflow: hidden;
  .span-filter-condition-field {
    flex: 1 1 auto;
  }

  // Style the column selector
  .ac-dropdown-button {
    min-width: var(--ac-global-dimension-static-size-300);
  }
`,ul=50;function Vp(n){const a=u.useRef(null),[t,l]=u.useState([]),{filterIoSubstring:i}=Or(),r=X(),{fetchKey:s}=Qn(),{data:c,loadNext:d,hasNext:m,isLoadingNext:y,refetch:g}=D.usePaginationFragment(jr,n.project),p=u.useMemo(()=>c.sessions.edges.map(({session:F})=>({...F,tokenCountTotal:F.tokenUsage.total})),[c.sessions]),f=[{header:"session id",accessorKey:"sessionId",enableSorting:!1,cell:fe},{header:"first input",accessorKey:"firstInput.value",enableSorting:!1,cell:fe},{header:"last output",accessorKey:"lastOutput.value",enableSorting:!1,cell:fe},{header:"start time",accessorKey:"startTime",enableSorting:!0,cell:Ee},{header:"end time",accessorKey:"endTime",enableSorting:!0,cell:Ee},{header:"p50 latency",accessorKey:"traceLatencyMsP50",enableSorting:!1,cell:({getValue:F})=>{const T=F();return T===null||typeof T!="number"?null:e(Ce,{latencyMs:T})}},{header:"p99 latency",accessorKey:"traceLatencyMsP99",enableSorting:!1,cell:({getValue:F})=>{const T=F();return T===null||typeof T!="number"?null:e(Ce,{latencyMs:T})}},{header:"total tokens",accessorKey:"tokenCountTotal",enableSorting:!0,minSize:80,cell:({row:F,getValue:T})=>{const w=T();if(w==null||typeof w!="number")return"--";const{prompt:_,completion:Q}=F.original.tokenUsage;return e(Sn,{tokenCountTotal:w,tokenCountPrompt:_||0,tokenCountCompletion:Q||0})}},{header:"total traces",accessorKey:"numTraces",enableSorting:!0,cell:Yl}];u.useEffect(()=>{const F=t[0];u.startTransition(()=>{g({sort:F?{col:F.id,dir:F.desc?"desc":"asc"}:{col:"startTime",dir:"desc"},after:null,first:ul,filterIoSubstring:i},{fetchPolicy:"store-and-network"})})},[t,g,i,s]);const k=Se.useCallback(F=>{if(F){const{scrollHeight:T,scrollTop:w,clientHeight:_}=F;T-w-_<300&&!y&&m&&d(ul)}},[m,y,d]),[b,S]=u.useState({}),v=cn(F=>F.columnVisibility),P=Fe({columns:f,data:p,onExpandedChange:S,manualSorting:!0,state:{sorting:t,expanded:b,columnVisibility:v},enableSubRowSelection:!1,onSortingChange:l,getCoreRowModel:Ke(),getSortedRowModel:Mn(),getExpandedRowModel:Tl(),getRowId:F=>F.id}),E=P.getRowModel().rows,R=E.length===0;return o("div",{css:Qt,children:[e(K,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:e(Lp,{})}),e("div",{css:C`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:F=>k(F.target),ref:a,children:o("table",{css:$n,children:[e("thead",{children:P.getHeaderGroups().map(F=>e("tr",{children:F.headers.map(T=>e("th",{colSpan:T.colSpan,children:T.isPlaceholder?null:o("div",{"data-sortable":T.column.getCanSort(),className:T.column.getCanSort()?"cursor-pointer":"",onClick:T.column.getToggleSortingHandler(),style:{left:T.getStart(),width:T.getSize()},children:[J(T.column.columnDef.header,T.getContext()),T.column.getIsSorted()?e(L,{className:"sort-icon",svg:T.column.getIsSorted()==="asc"?e(I.ArrowUpFilled,{}):e(I.ArrowDownFilled,{})}):null]})},T.id))},F.id))}),R?e(zp,{}):e("tbody",{children:E.map(F=>e("tr",{onClick:()=>r(`sessions/${encodeURIComponent(F.id)}`),children:F.getVisibleCells().map(T=>e("td",{children:J(T.column.columnDef.cell,T.getContext())},T.id))},F.id))})]})})]})}const Ur=u.createContext(null);function Br(){const n=u.useContext(Ur);if(n===null)throw new Error("useSpanFilterCondition must be used within a SpanFilterConditionProvider");return n}function ml(n){const[a,t]=u.useState(""),l=u.useCallback(r=>{u.startTransition(()=>{t(r)})},[]),i=u.useCallback(r=>{u.startTransition(()=>{a.length>0?t(a+" and "+r):t(r)})},[a]);return e(Ur.Provider,{value:{filterCondition:a,setFilterCondition:l,appendFilterCondition:i},children:n.children})}const Hr=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},t={defaultValue:50,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},s=[{kind:"Variable",name:"id",variableName:"id"}],c={kind:"Variable",name:"after",variableName:"after"},d={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},m={kind:"Variable",name:"first",variableName:"first"},y={kind:"Variable",name:"sort",variableName:"sort"},g={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},k=[c,d,m,y,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],b=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,t,l,i,r],kind:"Fragment",metadata:null,name:"SpansTableSpansQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[c,d,m,y],kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,t,i,r,l],kind:"Operation",name:"SpansTableSpansQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,{kind:"TypeDiscriminator",abstractKey:"__isNode"},p,{kind:"InlineFragment",selections:[f,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:k,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[p,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},f,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:b,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:b,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[g],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:k,filters:["sort","filterCondition","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"21dc6f490cf749c02bc20bcdb43c199c",id:null,metadata:{},name:"SpansTableSpansQuery",operationKind:"query",text:`query SpansTableSpansQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 50
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...SpansTable_spans_1XEuU
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans_1XEuU on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: $first, after: $after, sort: $sort, filterCondition: $filterCondition, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        tokenCountTotal
        tokenCountPrompt
        tokenCountCompletion
        context {
          spanId
          traceId
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Hr.hash="4827989f55b1c0bd269253b6bc977439";const Gr=function(){var n=["spans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Hr,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SpansTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"spans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__SpansTable_spans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},t],type:"Project",abstractKey:null}}();Gr.hash="4827989f55b1c0bd269253b6bc977439";function Wr(n){const{appendFilterCondition:a}=Br(),{annotation:t}=n,{name:l,label:i,score:r}=t,s=u.useMemo(()=>{const c=[];return i!=null&&(c.push({filterName:"Match label",filterCondition:`annotations['${l}'].label == "${i}"`}),c.push({filterName:"Exclude label",filterCondition:`annotations['${l}'].label != "${i}"`})),typeof r=="number"&&(c.push({filterName:"Greater than score",filterCondition:`annotations['${l}'].score > ${r}`}),c.push({filterName:"Less than score",filterCondition:`annotations['${l}'].score < ${r}`}),c.push({filterName:"Equals score",filterCondition:`annotations['${l}'].score == ${r}`})),c},[l,i,r]);return o(K,{borderStartWidth:"thin",borderColor:"dark",paddingStart:"size-200",paddingEnd:"size-100",marginStart:"size-200",width:300,children:[e(x,{textSize:"large",weight:"heavy",children:"Filters"}),e("ul",{css:C`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-size-100);
          color: var(--ac-global-color-primary);
          padding: var(--ac-global-dimension-size-100) 0;
          flex-wrap: wrap;
        `,children:s.map(c=>e("li",{children:e($p,{onClick:()=>{a(c.filterCondition)},children:c.filterName})},c.filterName))})]})}function $p({onClick:n,children:a}){return e("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),n()},className:"button--reset",css:C`
        color: var(--ac-global-text-color-900);
        border: 1px solid var(--ac-global-color-gray-200);
        border-radius: 4px;
        padding: var(--ac-global-dimension-size-50)
          var(--ac-global-dimension-size-100);
        cursor: pointer;
        transition: background-color 0.2s;
        &:hover {
          background-color: var(--ac-global-color-gray-300);
        }
      `,children:a})}function Op({projectName:n}){const[a,t]=u.useState("Python");return e(Z,{title:"Send Traces to this Project",size:"L",children:o(K,{padding:"size-400",overflow:"auto",children:[e(K,{paddingBottom:"size-100",children:e(Et,{language:a,onChange:t})}),a==="Python"?e(Xl,{projectName:n}):e(ei,{projectName:n})]})})}function Jr({projectName:n}){const[a,t]=u.useState(null),l=()=>{t(e(Op,{projectName:n}))};return o("tbody",{className:"is-empty",children:[e("tr",{children:e("td",{colSpan:100,css:i=>C`
            text-align: center;
            padding: ${i.spacing.margin24}px ${i.spacing.margin24}px !important;
          `,children:o(h,{direction:"column",gap:"size-200",alignItems:"center",children:["No traces found for this project",e(z,{variant:"default",icon:e(L,{svg:e(I.PlayCircleOutline,{})}),onClick:l,children:"Get Started"})]})})}),e(ee,{onDismiss:()=>t(null),isDismissable:!0,type:"slideOver",children:a})]})}const Zr={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanColumnSelector_annotations",selections:[{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null}],type:"Project",abstractKey:null};Zr.hash="ad01e6897ad1ea779eb346d85783b8b4";const Qp=["spanKind","name"];function Yr(n){return e(Kt,{menu:e(jp,{...n}),triggerProps:{placement:"bottom end"},children:o(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(L,{svg:e(I.Column,{})}),"Columns"]})})}const $a=C`
  padding: var(--ac-global-dimension-static-size-50)
    var(--ac-global-dimension-static-size-100);
  label {
    display: flex;
    align-items: center;
    gap: var(--ac-global-dimension-static-size-100);
  }
`;function jp(n){const{columns:a}=n,t=cn(d=>d.columnVisibility),l=cn(d=>d.setColumnVisibility),i=u.useMemo(()=>a.filter(d=>!Qp.includes(d.id)),[a]),r=u.useMemo(()=>i.every(d=>{const m=t[d.id];return m??!0}),[i,t]),s=u.useCallback(d=>{const{name:m,checked:y}=d.target;l({...t,[m]:y})},[t,l]),c=u.useCallback(d=>{const{checked:m}=d.target,y=i.reduce((g,p)=>({...g,[p.id]:m}),{});l(y)},[i,l]);return e("div",{css:C`
        overflow-y: auto;
        max-height: calc(100vh - 200px);
      `,children:o(K,{paddingTop:"size-50",paddingBottom:"size-50",children:[e(K,{borderBottomColor:"dark",borderBottomWidth:"thin",paddingBottom:"size-50",children:e("div",{css:$a,children:o("label",{children:[e("input",{type:"checkbox",name:"toggle-all",checked:r,onChange:c}),"span columns"]})})}),e("ul",{children:i.map(d=>{const m=t[d.id],y=m??!0,g=typeof d.columnDef.header=="string"?d.columnDef.header:d.id;return e("li",{css:$a,children:o("label",{children:[e("input",{type:"checkbox",name:d.id,checked:y,onChange:s}),g]})},d.id)})}),e(qp,{...n})]})})}function qp({query:n}){const a=D.useFragment(Zr,n),t=cn(s=>s.annotationColumnVisibility),l=cn(s=>s.setAnnotationColumnVisibility),i=u.useMemo(()=>a.spanAnnotationNames.every(s=>t[s]||!1),[a.spanAnnotationNames,t]),r=u.useCallback(()=>{const s=a.spanAnnotationNames.reduce((c,d)=>({...c,[d]:!i}),{});l(s)},[a.spanAnnotationNames,l,i]);return o("section",{children:[e(K,{paddingTop:"size-50",paddingBottom:"size-50",borderColor:"dark",borderTopWidth:"thin",borderBottomWidth:"thin",children:e("div",{css:$a,children:o("label",{children:[e("input",{type:"checkbox",name:"toggle-evaluations-all",checked:i,onChange:r}),"feedback"]})})}),e("ul",{children:a.spanAnnotationNames.map(s=>{const c=t[s]??!1;return e("li",{css:$a,children:o("label",{children:[e("input",{type:"checkbox",name:s,checked:c,onChange:()=>{l({...t,[s]:!c})}}),s]})},s)})})]})}const Xr=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"condition"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"condition",variableName:"condition"}],concreteType:"ValidationResult",kind:"LinkedField",name:"validateSpanFilterCondition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isValid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"29583e7ec666cef832dc7effb9e75678",id:null,metadata:{},name:"SpanFilterConditionFieldValidationQuery",operationKind:"query",text:`query SpanFilterConditionFieldValidationQuery(
  $condition: String!
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      validateSpanFilterCondition(condition: $condition) {
        isValid
        errorMessage
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Xr.hash="22836f192038b0c40201d3b25aad65b4";const es=C`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,ns=C`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
`;function Up(n){const a=n.matchBefore(/\w*/);return!a||a.from==a.to&&!n.explicit?null:{from:a.from,options:[{label:"span_kind",type:"variable",info:"The span variant: CHAIN, LLM, RETRIEVER, TOOL, etc."},{label:"status_code",type:"variable",info:"The span status: OK, UNSET, or ERROR"},{label:"input.value",type:"variable",info:"The input value of a span, typically a query"},{label:"output.value",type:"variable",info:"The output value of a span, typically a response"},{label:"name",type:"variable",info:"The name given to a span - e.x. OpenAI"},{label:"latency_ms",type:"variable",info:"Latency (i.e. duration) in milliseconds"},{label:"cumulative_token_count.prompt",type:"variable",info:"Sum of token count for prompt from self and all child spans"},{label:"cumulative_token_count.completion",type:"variable",info:"Sum of token count for completion from self and all child spans"},{label:"cumulative_token_count.total",type:"variable",info:"Sum of token count total (prompt + completion) from self and all child spans"},{label:"llm spans",type:"text",apply:"span_kind == 'LLM'",detail:"macro"},{label:"retriever spans",type:"text",apply:"span_kind == 'RETRIEVER'",detail:"macro"},{label:"search input",type:"text",apply:"'' in input.value",detail:"macro"},{label:"search output",type:"text",apply:"'' in output.value",detail:"macro"},{label:"status_code error",type:"text",apply:"status_code == 'ERROR'",detail:"macro"},{label:"Latency >= 10s",type:"text",apply:"latency_ms >= 10_000",detail:"macro"},{label:"Tokens >= 1,000",type:"text",apply:"llm.token_count.total >= 1_000",detail:"macro"},{label:"Hallucinations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Annotations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Metadata",type:"text",apply:"metadata['topic'] == 'agent'",detail:"macro"},{label:"Substring",type:"text",apply:"'agent' in input.value",detail:"macro"}]}}async function Bp(n,a){if(!n)return{isValid:!0,errorMessage:null};const t=await St.fetchQuery(Me,Xr,{condition:n,id:a}).toPromise();if(!t)throw new Error("Filter condition validation is null");return t.project.validateSpanFilterCondition}const Hp=[Yc.of([{key:"Enter",run:n=>!0}]),Mt(),Xc({override:[Up]})];function as(n){const{onValidCondition:a,placeholder:t="filter condition (e.x. span_kind == 'LLM')"}=n,[l,i]=u.useState(!1),[r,s]=u.useState(""),{filterCondition:c,setFilterCondition:d,appendFilterCondition:m}=Br(),y=u.useDeferredValue(c),{theme:g}=On(),p=g==="dark"?ra:void 0,{projectId:f}=Ve();u.useEffect(()=>{Bp(y,f).then(S=>{S!=null&&S.isValid?(s(""),u.startTransition(()=>{a(y)})):s((S==null?void 0:S.errorMessage)??"Invalid filter condition")})},[a,y,f]);const k=r!=="",b=c!=="";return o("div",{"data-is-focused":l,"data-is-invalid":k,className:"span-filter-condition-field",css:ns,children:[o(h,{direction:"row",children:[e(El,{children:e(L,{svg:e(I.Search,{})})}),e(ia,{css:es,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>i(!0),onBlur:()=>i(!1),value:c,onChange:d,height:"36px",width:"100%",theme:p,placeholder:t,extensions:Hp}),e("button",{css:C`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${b?"visible":"hidden"};
          `,onClick:()=>d(""),className:"button--reset",children:e(L,{svg:e(I.CloseCircleOutline,{})})}),o(Zn,{placement:"bottom right",children:[e(je,{children:e("button",{css:C`
                color: var(--ac-global-text-color-700);
                background-color: var(--ac-global-color-grey-400);
                padding-left: var(--ac-global-dimension-static-size-100);
                padding-right: var(--ac-global-dimension-static-size-100);
                height: 100%;
              `,className:"button--reset",children:e(L,{svg:e(I.PlusCircleOutline,{})})})}),e(Gp,{onAddFilterConditionSnippet:m})]})]}),o(pe,{isOpen:k&&l,placement:"bottom",children:[e(je,{children:e("div",{})}),e(Ca,{children:r!=""?e(x,{color:"danger",children:r}):e(x,{color:"success",children:"Valid Expression"})})]})]})}function Gp(n){const{onAddFilterConditionSnippet:a}=n;return e(K,{width:"500px",paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",borderRadius:"medium",borderWidth:"thin",borderColor:"light",backgroundColor:"light",children:o(Re,{children:[e(In,{label:"filter by kind",initialSnippet:"span_kind == 'LLM'",onAddFilterConditionSnippet:a},"kind"),e(In,{label:"filter by token count",initialSnippet:"cumulative_token_count.total > 1000",onAddFilterConditionSnippet:a},"token_count"),e(In,{label:"filter by annotation label",initialSnippet:"annotations['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"annotation_label"),e(In,{label:"filter by evaluation label",initialSnippet:"evals['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"eval_label"),e(In,{label:"filter by evaluation score",initialSnippet:"evals['Hallucination'].score < 1",onAddFilterConditionSnippet:a},"eval_score"),e(In,{label:"filter by metadata",initialSnippet:"metadata['topic'] == 'agent'",onAddFilterConditionSnippet:a},"metadata"),e(In,{label:"filter by substring",initialSnippet:"'agent' in input.value",onAddFilterConditionSnippet:a},"substring")]})})}function In(n){const{initialSnippet:a,onAddFilterConditionSnippet:t}=n,[l,i]=u.useState(a),{theme:r}=On(),s=r==="light"?void 0:ra;return e(Vn,{label:n.label,children:o(h,{direction:"row",width:"100%",gap:"size-100",children:[e("div",{css:C(ns,C`
              flex: 1 1 auto;
            `),children:e(ia,{value:l,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[Mt()],editable:!0,onChange:i,theme:s,css:es})}),e(z,{title:"Add to filter condition",variant:"default",onClick:()=>t(l),icon:e(L,{svg:e(I.PlusCircleOutline,{})})})]})})}const ts=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addSpansToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a},params:{cacheID:"1c694540190478b8fba8ef3c0cacf30c",id:null,metadata:{},name:"SpanSelectionToolbarAddSpansToDatasetMutation",operationKind:"mutation",text:`mutation SpanSelectionToolbarAddSpansToDatasetMutation(
  $input: AddSpansToDatasetInput!
) {
  addSpansToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();ts.hash="5e3aef907285081a06c0e0360045e865";const ls={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"6d459b61a36b99979f025742892941f9",id:null,metadata:{},name:"DatasetSelectorPopoverContentDatasetsQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentDatasetsQuery {
  ...DatasetSelectorPopoverContent_datasets
}

fragment DatasetSelectorPopoverContent_datasets on Query {
  datasets {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}};ls.hash="40d5267ad0ec2335a73ff2a4d05bbed1";const is={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:ls}},name:"DatasetSelectorPopoverContent_datasets",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};is.hash="40d5267ad0ec2335a73ff2a4d05bbed1";const rs={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetSelectorPopoverContentQuery",selections:[{alias:null,args:null,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"5fb28a402f330dd235295da21efea58b",id:null,metadata:{},name:"DatasetSelectorPopoverContentQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentQuery {
  ...DatasetSelectorPopoverContent_datasets
}

fragment DatasetSelectorPopoverContent_datasets on Query {
  datasets {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}};rs.hash="7cd8a13144d97d2b5294f2a09c9e1351";function Wp(n){const{onCreateNewDataset:a,onDatasetSelected:t}=n,[l,i]=u.useState(""),r=D.useLazyLoadQuery(rs,{},{fetchPolicy:"network-only"});return o(q,{title:"Add to Dataset",variant:"compact",backgroundColor:"light",borderColor:"light",bodyStyle:{padding:0},extra:e(z,{variant:"default",size:"compact",onClick:a,children:"New Dataset"}),children:[e(K,{padding:"size-100",children:e(ae,{type:"search",placeholder:"Search datasets",addonBefore:e(L,{svg:e(I.Search,{})}),onChange:s=>{i(s)}})}),e(K,{borderTopWidth:"thin",borderColor:"light",children:e("div",{css:C`
            height: 400px;
            overflow-y: auto;
          `,children:e(Jp,{query:r,search:l,onDatasetSelected:t})})})]})}function Jp(n){const{search:a,onDatasetSelected:t}=n,[l]=D.useRefetchableFragment(is,n.query),i=u.useMemo(()=>{let s=l.datasets.edges.map(c=>c.dataset);return a&&(s=s.filter(c=>c.name.toLowerCase().includes(a.toLowerCase()))),s},[a,l]);return i.length===0?e(K,{padding:"size-200",children:e(h,{direction:"column",justifyContent:"center",alignItems:"center",flex:"1 1 auto",children:e(x,{children:"No datasets found"})})}):e(Qa,{selectionMode:"single",onSelectionChange:s=>{if(typeof s=="object"){const c=Array.from(s);t(c[0])}},children:i.map(s=>e(le,{children:s.name},s.id))})}function ss(n){const a=X(),[t,l]=u.useState(null),i=xe(),r=ve(),[s,c]=u.useState(!1),{selectedSpans:d,onClearSelection:m}=n,[y,g]=D.useMutation(ts),p=d.length!==1,f=u.useCallback(k=>{y({variables:{input:{datasetId:k,spanIds:d.map(b=>b.id)}},onCompleted:()=>{i({title:"Examples added to dataset",message:`${d.length} example${p?"s":""} have been added to the dataset.`,action:{text:"View dataset",onClick:()=>{a(`/datasets/${k}/examples`)}}}),m()},onError:b=>{r({title:"An error occurred",message:`Failed to add spans to dataset: ${b.message}`})}})},[y,d,i,p,m,a,r]);return o("div",{css:C`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(K,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:o(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(x,{children:`${d.length} span${p?"s":""} selected`}),o(h,{direction:"row",gap:"size-100",children:[e(z,{variant:"default",size:"compact",onClick:m,children:"Cancel"}),o(Zn,{placement:"top end",crossOffset:300,isOpen:s,onOpenChange:k=>{c(k)},children:[e(z,{variant:"primary",size:"compact",icon:e(L,{svg:e(I.DatabaseOutline,{})}),loading:g,disabled:g,children:g?"Adding to dataset":"Add to dataset"}),e(u.Suspense,{children:e(Wp,{onDatasetSelected:k=>{f(k),c(!1)},onCreateNewDataset:()=>{c(!1),l(e(Z,{title:"New Dataset",isDismissable:!0,onDismiss:()=>l(null),children:e(ni,{onDatasetCreateError:()=>{r({title:"Dataset creation failed",message:"Failed to create dataset."})},onDatasetCreated:k=>{l(null),i({title:"Dataset created",message:`${k.name} has been successfully created.`}),c(!0)}})}))}})})]})]})]})}),e(ee,{onDismiss:()=>{l(null)},children:t})]})}const ka="annotations",tn=":",os={col:"startTime",dir:"desc"};function ds(n){let a=null,t=null;if(n.id&&n.id.startsWith(ka)){const[,l,i]=n.id.split(tn);t={attr:l,name:i}}else a=n.id;return{col:a,evalResultKey:t,dir:n.desc?"desc":"asc"}}const gl=50;function Zp(n){const{fetchKey:a}=Qn(),t=u.useRef(null),[l,i]=u.useState({}),[r,s]=u.useState([]),[c,d]=u.useState(""),m=cn(N=>N.columnVisibility),y=X(),{data:g,loadNext:p,hasNext:f,isLoadingNext:k,refetch:b}=D.usePaginationFragment(Gr,n.project),S=cn(N=>N.annotationColumnVisibility),v=u.useMemo(()=>Object.keys(S).filter(N=>S[N]),[S]),P=u.useMemo(()=>g.spans.edges.map(({span:j})=>j),[g]),E=v.map(N=>({header:N,columns:[{header:"label",accessorKey:`${ka}${tn}label${tn}${N}`,cell:({row:j})=>{const M=j.original.spanAnnotations.find(U=>U.name===N);return M?M.label:null}},{header:"score",accessorKey:`${ka}${tn}score${tn}${N}`,cell:({row:j})=>{const M=j.original.spanAnnotations.find(U=>U.name===N);return M?M.score:null}}]})),R=[{header:()=>o(h,{direction:"row",gap:"size-50",children:[e("span",{children:"feedback"}),o(Yn,{children:[e(ce,{level:3,weight:"heavy",children:"Feedback"}),e(zn,{children:"Feedback includes evaluations and human annotations logged via the API or set via the UI."})]})]}),accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:N})=>o(h,{direction:"row",gap:"size-50",wrap:"wrap",children:[N.original.spanAnnotations.map(j=>e(ea,{annotation:j,layout:"horizontal",width:"500px",extra:e(Wr,{annotation:j}),children:e(un,{annotation:j,annotationDisplayPreference:"label"})},j.name)),N.original.documentRetrievalMetrics.map(j=>o(G,{children:[e($e,{name:j.evaluationName,metric:"ndcg",score:j.ndcg},"ndcg"),e($e,{name:j.evaluationName,metric:"precision",score:j.precision},"precision"),e($e,{name:j.evaluationName,metric:"hit",score:j.hit},"hit")]}))]})},...E],F=[{id:"select",maxSize:10,header:({table:N})=>e(fn,{checked:N.getIsAllRowsSelected(),indeterminate:N.getIsSomeRowsSelected(),onChange:N.getToggleAllRowsSelectedHandler()}),cell:({row:N})=>e(fn,{checked:N.getIsSelected(),disabled:!N.getCanSelect(),indeterminate:N.getIsSomeSelected(),onChange:N.getToggleSelectedHandler()})},{header:"kind",accessorKey:"spanKind",maxSize:100,enableSorting:!1,cell:({getValue:N})=>e(Lt,{spanKind:N()})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:N,row:j})=>{const M=j.original,{traceId:U}=M.context;return e(Ge,{to:`traces/${U}?selectedSpanNodeId=${M.id}`,children:N()})}},{header:"input",accessorKey:"input.value",cell:fe,enableSorting:!1},{header:"output",accessorKey:"output.value",cell:fe,enableSorting:!1},{header:"metadata",accessorKey:"metadata",cell:fe,enableSorting:!1},...R,{header:"start time",accessorKey:"startTime",cell:Ee},{header:"latency",accessorKey:"latencyMs",cell:({getValue:N})=>{const j=N();return j===null||typeof j!="number"?null:e(Ce,{latencyMs:j})}},{header:"total tokens",accessorKey:"tokenCountTotal",cell:({row:N,getValue:j})=>{const M=j();return M===null?"--":e(Sn,{tokenCountTotal:M,tokenCountPrompt:N.original.tokenCountPrompt||0,tokenCountCompletion:N.original.tokenCountCompletion||0})}},{header:"status",accessorKey:"statusCode",enableSorting:!1,cell:({getValue:N})=>e(Ba,{statusCode:N()})}];u.useEffect(()=>{const N=r[0];u.startTransition(()=>{b({sort:N?ds(N):os,after:null,first:gl,filterCondition:c},{fetchPolicy:"store-and-network"})})},[r,b,c,a]);const T=u.useCallback(N=>{if(N){const{scrollHeight:j,scrollTop:M,clientHeight:U}=N;j-M-U<300&&!k&&f&&p(gl)}},[f,k,p]),w=Fe({columns:F,data:P,state:{sorting:r,columnVisibility:m,rowSelection:l},manualSorting:!0,enableRowSelection:!0,onRowSelectionChange:i,onSortingChange:s,getCoreRowModel:Ke(),getSortedRowModel:Mn()}),_=w.getRowModel().rows,Q=w.getSelectedRowModel().rows,V=Q.map(N=>N.original),H=u.useCallback(()=>{i({})},[i]),te=_.length===0,oe=w.getAllColumns().filter(N=>N.columns.length===0);return o("div",{css:Qt,children:[e(K,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:o(h,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(as,{onValidCondition:d}),e(Yr,{columns:oe,query:g})]})}),e("div",{css:C`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:N=>T(N.target),ref:t,children:o("table",{css:$n,children:[e("thead",{children:w.getHeaderGroups().map(N=>e("tr",{children:N.headers.map(j=>e("th",{colSpan:j.colSpan,children:j.isPlaceholder?null:o("div",{className:j.column.getCanSort()?"cursor-pointer":"",onClick:j.column.getToggleSortingHandler(),style:{left:j.getStart(),width:j.getSize()},children:[J(j.column.columnDef.header,j.getContext()),j.column.getIsSorted()?e(L,{className:"sort-icon",svg:j.column.getIsSorted()==="asc"?e(I.ArrowUpFilled,{}):e(I.ArrowDownFilled,{})}):null]})},j.id))},N.id))}),te?e(Jr,{projectName:g.name}):e("tbody",{children:_.map(N=>e("tr",{onClick:()=>y(`traces/${N.original.context.traceId}?selectedSpanNodeId=${N.original.id}`),children:N.getVisibleCells().map(j=>e("td",{children:J(j.column.columnDef.cell,j.getContext())},j.id))},N.id))})]})}),Q.length?e(ss,{selectedSpans:V,onClearSelection:H}):null]})}const cs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"4e136f41c0942f253822336dc0c5b291",id:null,metadata:{},name:"StreamToggleRefetchQuery",operationKind:"query",text:`query StreamToggleRefetchQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...StreamToggle_data
    __isNode: __typename
    id
  }
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}
`}}}();cs.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";const us={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:cs,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"StreamToggle_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};us.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";function ms(n,a){const t=u.useRef(null);u.useEffect(()=>{t.current=n},[n]),u.useEffect(()=>{function l(){t.current&&t.current()}if(typeof a=="number"){const i=setInterval(l,a);return()=>clearInterval(i)}},[a])}const Yp=2e3;function Xp(n){const{isStreaming:a,setIsStreaming:t,setFetchKey:l}=Qn(),[i,r]=D.useRefetchableFragment(us,n.project),s=u.useRef(i.streamingLastUpdatedAt),c=u.useCallback(()=>{a&&u.startTransition(()=>{r({},{fetchPolicy:"store-and-network"})})},[a,r]),d=i.streamingLastUpdatedAt;return u.useEffect(()=>{d!=null&&(s.current==null||s.current<d)&&(s.current=d,l(`fetch-traces-${d}`))},[l,d]),ms(c,Yp),e(Xn,{labelPlacement:"start",isSelected:a,onChange:()=>{t(!a)},children:"Stream"})}const gs=function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},t={defaultValue:50,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},s=[{kind:"Variable",name:"id",variableName:"id"}],c={kind:"Variable",name:"after",variableName:"after"},d={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},m={kind:"Variable",name:"first",variableName:"first"},y={kind:"Variable",name:"sort",variableName:"sort"},g={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},k=[c,d,m,{kind:"Literal",name:"rootSpansOnly",value:!0},y,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],b={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},S={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},v={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},E={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},R=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],F={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:R,storageKey:null},T={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:R,storageKey:null},w={alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},_={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[f,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},Q={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a,t,l,i,r],kind:"Fragment",metadata:null,name:"TracesTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[c,d,m,y],kind:"FragmentSpread",name:"TracesTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,t,i,r,l],kind:"Operation",name:"TracesTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,{kind:"TypeDiscriminator",abstractKey:"__isNode"},p,{kind:"InlineFragment",selections:[f,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:k,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[p,b,f,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},S,v,P,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},E,F,T,w,_,Q,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"descendants",plural:!0,selections:[p,b,f,S,v,P,E,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},F,T,w,_,Q],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[g],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:k,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"572f8769fc0e90b681883b56222bdc65",id:null,metadata:{},name:"TracesTableQuery",operationKind:"query",text:`query TracesTableQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 50
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...TracesTable_spans_1XEuU
    __isNode: __typename
    id
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment TracesTable_spans_1XEuU on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: $first, after: $after, sort: $sort, rootSpansOnly: true, filterCondition: $filterCondition, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode: propagatedStatusCode
        startTime
        latencyMs
        cumulativeTokenCountTotal
        cumulativeTokenCountPrompt
        cumulativeTokenCountCompletion
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        context {
          spanId
          traceId
        }
        spanAnnotations {
          name
          label
          score
          annotatorKind
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants {
          id
          spanKind
          name
          statusCode: propagatedStatusCode
          startTime
          latencyMs
          parentId
          cumulativeTokenCountTotal: tokenCountTotal
          cumulativeTokenCountPrompt: tokenCountPrompt
          cumulativeTokenCountCompletion: tokenCountCompletion
          input {
            value: truncatedValue
          }
          output {
            value: truncatedValue
          }
          context {
            spanId
            traceId
          }
          spanAnnotations {
            name
            label
            score
            annotatorKind
          }
          documentRetrievalMetrics {
            evaluationName
            ndcg
            precision
            hit
          }
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();gs.hash="53b160969c87d5e35e08a1f4ca26aadb";const ps=function(){var n=["rootSpans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},i={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},d=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],m={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:d,storageKey:null},y={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:d,storageKey:null},g={alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},p={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null},f={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:gs,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"TracesTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"rootSpans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__TracesTable_rootSpans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,l,a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},i,r,s,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountCompletion",storageKey:null},c,m,y,g,p,f,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"descendants",plural:!0,selections:[t,l,a,i,r,s,c,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:"cumulativeTokenCountPrompt",args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:"cumulativeTokenCountCompletion",args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},m,y,g,p,f],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},t],type:"Project",abstractKey:null}}();ps.hash="53b160969c87d5e35e08a1f4ca26aadb";const pl=50;function ys(n){const a=[];for(const t of n){const l={...t.span,children:ys(t.children)};a.push(l)}return a}function ey(n){const a=u.useRef(null),[t,l]=u.useState({}),[i,r]=u.useState([]),[s,c]=u.useState(""),d=X(),{fetchKey:m}=Qn(),{data:y,loadNext:g,hasNext:p,isLoadingNext:f,refetch:k}=D.usePaginationFragment(ps,n.project),b=cn(M=>M.annotationColumnVisibility),S=u.useMemo(()=>Object.keys(b).filter(M=>b[M]),[b]),v=u.useMemo(()=>y.rootSpans.edges.map(({rootSpan:U})=>{const ie=kc([U,...U.descendants]),[$]=ys(ie);return $}),[y]),P=S.map(M=>({header:M,columns:[{header:"label",accessorKey:`${ka}${tn}label${tn}${M}`,cell:({row:U})=>{const ie=U.original.spanAnnotations.find($=>$.name===M);return ie?ie.label:null}},{header:"score",accessorKey:`${ka}${tn}score${tn}${M}`,cell:({row:U})=>{const ie=U.original.spanAnnotations.find($=>$.name===M);return ie?ie.score:null}}]})),E=[{header:()=>o(h,{direction:"row",gap:"size-50",children:[e("span",{children:"feedback"}),o(Yn,{children:[e(ce,{level:3,weight:"heavy",children:"Feedback"}),e(zn,{children:"Feedback includes evaluations and human annotations logged via the API or set via the UI."})]})]}),accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:M})=>{const U=M.original.spanAnnotations.length===0&&M.original.documentRetrievalMetrics.length===0;return o(h,{direction:"row",gap:"size-50",wrap:"wrap",children:[M.original.spanAnnotations.map(ie=>e(ea,{annotation:ie,layout:"horizontal",width:"500px",extra:e(Wr,{annotation:ie}),children:e(un,{annotation:ie,annotationDisplayPreference:"label"})},ie.name)),M.original.documentRetrievalMetrics.map(ie=>o(u.Fragment,{children:[e($e,{name:ie.evaluationName,metric:"ndcg",score:ie.ndcg},"ndcg"),e($e,{name:ie.evaluationName,metric:"precision",score:ie.precision},"precision"),e($e,{name:ie.evaluationName,metric:"hit",score:ie.hit},"hit")]},"doc-evals")),U?"--":null]})}},...P],R=[{id:"select",maxSize:10,header:({table:M})=>e(fn,{checked:M.getIsAllRowsSelected(),indeterminate:M.getIsSomeRowsSelected(),onChange:M.getToggleAllRowsSelectedHandler()}),cell:({row:M})=>e(fn,{checked:M.getIsSelected(),disabled:!M.getCanSelect(),indeterminate:M.getIsSomeSelected(),onChange:M.getToggleSelectedHandler()})},{header:()=>o(h,{gap:"size-50",direction:"row",alignItems:"center",children:[e(Xt,{isExpanded:Q.getIsAllRowsExpanded(),onClick:Q.getToggleAllRowsExpandedHandler(),"aria-label":"Expand all rows"}),"kind"]}),enableSorting:!1,accessorKey:"spanKind",maxSize:100,cell:M=>e("div",{css:C`
              // Since rows are flattened by default,
              // we can use the row.depth property
              // and paddingLeft to visually indicate the depth
              // of the row
              padding-left: ${M.row.depth*2}rem;
            `,children:o(h,{gap:"size-50",children:[M.row.getCanExpand()?e(Xt,{isExpanded:M.row.getIsExpanded(),onClick:M.row.getToggleExpandedHandler(),"aria-label":"Expand row"}):null,e(Lt,{spanKind:M.getValue()})]})})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:M,row:U})=>{const{traceId:ie}=U.original.context;return e(Ge,{to:`traces/${ie}?selectedSpanNodeId=${U.original.id}`,children:M()})}},{header:"input",accessorKey:"input.value",enableSorting:!1,cell:fe},{header:"output",accessorKey:"output.value",enableSorting:!1,cell:fe},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:fe},...E,{header:"start time",accessorKey:"startTime",cell:Ee},{header:"latency",accessorKey:"latencyMs",cell:({getValue:M})=>{const U=M();return U===null||typeof U!="number"?null:e(Ce,{latencyMs:U})}},{header:"total tokens",minSize:80,accessorKey:"cumulativeTokenCountTotal",cell:({row:M,getValue:U})=>{const ie=U();return ie===null?"--":e(Sn,{tokenCountTotal:ie,tokenCountPrompt:M.original.cumulativeTokenCountPrompt||0,tokenCountCompletion:M.original.cumulativeTokenCountCompletion||0})}},{header:"status",accessorKey:"statusCode",enableSorting:!1,cell:({getValue:M})=>e(Ba,{statusCode:M()})}];u.useEffect(()=>{const M=i[0];u.startTransition(()=>{k({sort:M?ds(M):os,after:null,first:pl,filterCondition:s},{fetchPolicy:"store-and-network"})})},[i,k,s,m]);const F=Se.useCallback(M=>{if(M){const{scrollHeight:U,scrollTop:ie,clientHeight:$}=M;U-ie-$<300&&!f&&p&&g(pl)}},[p,f,g]),[T,w]=u.useState({}),_=cn(M=>M.columnVisibility),Q=Fe({columns:R,data:v,onExpandedChange:w,manualSorting:!0,getSubRows:M=>M.children,state:{sorting:i,expanded:T,columnVisibility:_,rowSelection:t},onRowSelectionChange:l,enableSubRowSelection:!1,onSortingChange:r,getCoreRowModel:Ke(),getSortedRowModel:Mn(),getExpandedRowModel:Tl(),getRowId:M=>M.id}),V=Q.getRowModel().rows,H=Q.getSelectedRowModel().flatRows,te=H.map(M=>M.original),oe=u.useCallback(()=>{l({})},[l]),N=V.length===0,j=Q.getAllColumns().filter(M=>M.columns.length===0);return o("div",{css:Qt,children:[e(K,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:o(h,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(as,{onValidCondition:c}),e(Yr,{columns:j,query:y})]})}),e("div",{css:C`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:M=>F(M.target),ref:a,children:o("table",{css:$n,children:[e("thead",{children:Q.getHeaderGroups().map(M=>e("tr",{children:M.headers.map(U=>e("th",{colSpan:U.colSpan,children:U.isPlaceholder?null:o("div",{"data-sortable":U.column.getCanSort(),className:U.column.getCanSort()?"cursor-pointer":"",onClick:U.column.getToggleSortingHandler(),style:{left:U.getStart(),width:U.getSize()},children:[J(U.column.columnDef.header,U.getContext()),U.column.getIsSorted()?e(L,{className:"sort-icon",svg:U.column.getIsSorted()==="asc"?e(I.ArrowUpFilled,{}):e(I.ArrowDownFilled,{})}):null]})},U.id))},M.id))}),N?e(Jr,{projectName:y.name}):e("tbody",{children:V.map(M=>e("tr",{onClick:()=>d(`traces/${M.original.context.traceId}`),children:M.getVisibleCells().map(U=>e("td",{children:J(U.column.columnDef.cell,U.getContext())},U.id))},M.id))})]})}),H.length?e(ss,{selectedSpans:te,onClearSelection:oe}):null]})}const ny=C`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function O0(){const{projectId:n}=Ve(),{timeRange:a}=Ha();return e(u.Suspense,{fallback:e(ye,{}),children:e(ay,{projectId:n,timeRange:a})})}const fs=Lr,hs=Pr;function ay({projectId:n,timeRange:a}){const t=u.useMemo(()=>({start:a.start.toISOString(),end:a.end.toISOString()}),[a]),l=D.useLazyLoadQuery(Dr,{id:n,timeRange:t},{fetchPolicy:"store-and-network"}),[i,r,s]=D.useQueryLoader(fs),[c,d,m]=D.useQueryLoader(hs),y=u.useCallback(g=>{g===1?(m(),r({id:n,timeRange:t})):g===2?(s(),d({id:n,timeRange:t})):(s(),m())},[s,r,m,d,n,t]);return o("main",{css:ny,children:[e(xp,{project:l.project,extra:o(h,{direction:"row",alignItems:"center",gap:"size-100",children:[e(Xp,{project:l.project}),e(ai,{})]})}),o(Qe,{onChange:y,children:[e(ne,{name:"Traces",children:({isSelected:g})=>g&&e(ml,{children:e(u.Suspense,{children:e(ey,{project:l.project})})})}),e(ne,{name:"Spans",title:"Spans",children:({isSelected:g})=>g&&i&&e(ml,{children:e(u.Suspense,{fallback:e(ye,{}),children:e(ty,{queryReference:i})})})}),e(ne,{name:"Sessions",title:"Sessions",children:({isSelected:g})=>g&&c&&e(Tp,{children:e(u.Suspense,{children:e(ly,{queryReference:c})})})})]}),e(u.Suspense,{children:e(Oe,{})})]})}function ty({queryReference:n}){const a=D.usePreloadedQuery(fs,n);return e(Zp,{project:a.project})}function ly({queryReference:n}){const a=D.usePreloadedQuery(hs,n);return e(Vp,{project:a.project})}const ks=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"04c84b5bc2a01477851d347af75dcc11",id:null,metadata:{},name:"projectLoaderQuery",operationKind:"query",text:`query projectLoaderQuery(
  $id: GlobalID!
) {
  project: node(id: $id) {
    __typename
    id
    ... on Project {
      name
    }
  }
}
`}}}();ks.hash="3d31e323c06df38ec2eaa6f3adb55e79";async function Q0(n){const{projectId:a}=n.params;return await D.fetchQuery(Me,ks,{id:a}).toPromise()}function j0(){const n=nd(),a=u.useMemo(()=>n instanceof Error&&n.message==="Failed to fetch"?e(iy,{}):e(ry,{error:n}),[n]);return e("main",{css:C`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      `,children:e("section",{css:C`
          width: 500px;
          /* Add spacing on the bottom so it gets pushed down */
          margin-top: 200px;
          display: flex;
          flex-direction: column;
        `,children:a})})}function iy(){return o(G,{children:[o(h,{direction:"column",width:"100%",alignItems:"center",children:[e(ja,{graphicKey:"not found"}),e("h1",{children:"Server disconnected"})]}),e("p",{children:"We are unable to reach the Phoenix server. Please ensure that Phoenix is running and try again."})]})}function ry({error:n}){return o(G,{children:[o(h,{direction:"column",width:"100%",alignItems:"center",children:[e(ja,{graphicKey:"error"}),e("h1",{children:"Something went wrong"})]}),e("p",{children:"We strive to do our very best but 🐛 bugs happen. It would mean a lot to us if you could file a an issue. If you feel comfortable, please include the error details below in your issue. We will get back to you as soon as we can."}),e("p",{css:C`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:o("span",{css:C`
            display: inline-flex;
            flex-direction: row;
            align-items: baseline;
            gap: 0.2em;
          `,children:["💙 the",e(He,{href:"mailto:phoenix-devs@arize.com",children:"phoenix team"})]})}),o("div",{css:C`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(He,{href:"https://github.com/Arize-ai/phoenix/issues/new?assignees=&labels=bug&template=bug_report.md&title=%5BBUG%5D",children:"file an issue with us"}),e(z,{variant:"primary",size:"compact",onClick:()=>{window.location.href="/"},children:"Return Home"})]}),o("details",{open:!0,children:[e("summary",{children:"error details"}),e("pre",{css:C`
            white-space: pre-wrap;
            overflow-wrap: break-word;
            overflow: hidden;
            overflow-y: auto;
            max-height: 500px;
          `,children:n instanceof Error?n.message:null})]})]})}const bs=function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],a=[{alias:null,args:null,concreteType:"Model",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:n,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelRootQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ModelRootQuery",selections:a},params:{cacheID:"c3baccc5527002697b40a06eef432a4d",id:null,metadata:{},name:"ModelRootQuery",operationKind:"query",text:`query ModelRootQuery {
  model {
    primaryInferences {
      name
      startTime
      endTime
    }
    referenceInferences {
      name
      startTime
      endTime
    }
    corpusInferences {
      name
      startTime
      endTime
    }
  }
}
`}}}();bs.hash="b73d8f3f532a0c6f88863f3c6dd5734f";const sy=bs;function q0(){const n=D.useLazyLoadQuery(sy,{}),{model:{primaryInferences:a,referenceInferences:t,corpusInferences:l}}=n;return e(Sc,{primaryInferences:a,referenceInferences:t??null,corpusInferences:l??null,children:e(bc,{timeRangeBounds:{start:new Date(a.startTime),end:new Date(a.endTime)},children:e(Oe,{})})})}function U0(){return e(Ip,{children:e(Sp,{children:e(Oe,{})})})}function B0(){return e(vc,{children:e(Oe,{})})}const Ss=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={kind:"Variable",name:"timeRange",variableName:"timeRange"},l=[t];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageProjectsQuery",selections:[{args:a,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageProjectsQuery",selections:[{alias:null,args:a,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"ead527a5c3ddda0f6c906c99183edf06",id:null,metadata:{},name:"ProjectsPageProjectsQuery",operationKind:"query",text:`query ProjectsPageProjectsQuery(
  $after: String = null
  $first: Int = 50
  $timeRange: TimeRange
) {
  ...ProjectsPageProjectsFragment_2HEEH6
}

fragment ProjectsPageProjectsFragment_2HEEH6 on Query {
  projects(first: $first, after: $after) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        traceCount(timeRange: $timeRange)
        endTime
        latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
        tokenCountTotal(timeRange: $timeRange)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Ss.hash="56c501357948255461a24411fb6b5847";const vs=function(){var n=["projects"],a={kind:"Variable",name:"timeRange",variableName:"timeRange"},t=[a];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Ss}},name:"ProjectsPageProjectsFragment",selections:[{alias:"projects",args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"__ProjectsPage_projects_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},a],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:t,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();vs.hash="56c501357948255461a24411fb6b5847";const Cs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Literal",name:"first",value:50}],t={kind:"Variable",name:"timeRange",variableName:"timeRange"},l=[t];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageQuery",selections:[{args:null,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageQuery",selections:[{alias:null,args:a,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:l,kind:"ScalarField",name:"tokenCountTotal",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"projects(first:50)"},{alias:null,args:a,filters:null,handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"35a420462b10b0f0158d042fd39bfabb",id:null,metadata:{},name:"ProjectsPageQuery",operationKind:"query",text:`query ProjectsPageQuery(
  $timeRange: TimeRange!
) {
  ...ProjectsPageProjectsFragment
}

fragment ProjectsPageProjectsFragment on Query {
  projects(first: 50) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        traceCount(timeRange: $timeRange)
        endTime
        latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
        tokenCountTotal(timeRange: $timeRange)
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Cs.hash="c28f5ced0b3ec4b3b8277d0aac29de2d";const oy="https://docs.arize.com/phoenix/tracing/how-to-tracing/setup-tracing";function dy(){const[n,a]=u.useState(null);return o("div",{children:[e(z,{variant:"default",icon:e(L,{svg:e(I.GridOutline,{})}),onClick:()=>{a(e(cy,{}))},children:"New Project"}),e(ee,{isDismissable:!0,type:"slideOver",onDismiss:()=>a(null),children:n})]})}function cy(){const[n,a]=u.useState("Python");return e(Z,{title:"Create a New Project",size:"L",children:o(K,{padding:"size-400",overflow:"auto",children:[e(K,{paddingBottom:"size-200",children:e(Et,{language:n,onChange:a})}),e(K,{paddingBottom:"size-100",children:o(x,{children:["Projects are created when you log your first trace via OpenTelemetry. See the"," ",e(He,{href:oy,children:"documentation"})," ","for a complete guide."]})}),n==="Python"?e(Xl,{}):e(ei,{})]})})}const Fs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuClearMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuClearMutation",selections:a},params:{cacheID:"63319b4e42b499db2447817f1dc821fb",id:null,metadata:{},name:"ProjectActionMenuClearMutation",operationKind:"mutation",text:`mutation ProjectActionMenuClearMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}}();Fs.hash="c43eec4d6b882468c611dd9ebf3b095e";const Ks=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"}],a=[{alias:null,args:[{kind:"Variable",name:"id",variableName:"projectId"}],concreteType:"Query",kind:"LinkedField",name:"deleteProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuDeleteMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuDeleteMutation",selections:a},params:{cacheID:"8b00ab3aaef4c5fb3de24f7295d38499",id:null,metadata:{},name:"ProjectActionMenuDeleteMutation",operationKind:"mutation",text:`mutation ProjectActionMenuDeleteMutation(
  $projectId: GlobalID!
) {
  deleteProject(id: $projectId) {
    __typename
  }
}
`}}}();Ks.hash="3bf82e90b3f2d3485b4efb954e30b2cf";const xs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RemoveProjectDataFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RemoveProjectDataFormMutation",selections:a},params:{cacheID:"1b27a3f7535c3f3943b0f2248d1505a6",id:null,metadata:{},name:"RemoveProjectDataFormMutation",operationKind:"mutation",text:`mutation RemoveProjectDataFormMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}}();xs.hash="212501fe2d6367ec1503bd7a00c1730f";function uy(n){const{projectId:a}=n,t=u.useRef(null),[l,i]=D.useMutation(xs),{control:r,handleSubmit:s,setError:c,formState:{isValid:d}}=Ue({defaultValues:{endDate:new Date(Date.now()-Cc).toISOString().slice(0,16)}}),m=u.useCallback(y=>{const g=ad(y.endDate);if(!td(g))return c("endDate",{message:"Date is not in a valid format"});l({variables:{input:{id:a,endTime:new Date(g).toISOString()}},onCompleted:()=>{n.onComplete()},onError:p=>{alert("Failed to clear project traces: "+p)}})},[l,a,n,c]);return o("form",{onSubmit:s(m),ref:t,children:[o(K,{padding:"size-200",children:[e(x,{color:"danger",children:"You are about to remove all data before the following date. This cannot be undone."}),e(W,{name:"endDate",control:r,rules:{required:"field is required"},render:({field:{name:y,onChange:g,onBlur:p,value:f},fieldState:{invalid:k,error:b}})=>e(ae,{label:"End Date",type:"datetime-local",name:y,description:"The date up to which you want to remove data",errorMessage:b==null?void 0:b.message,validationState:k?"invalid":"valid",onChange:g,onBlur:p,defaultValue:f})})]}),e(K,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(z,{type:"submit",variant:"danger",isDisabled:!d,size:"compact",loading:i,onClick:()=>{var y;(y=t.current)==null||y.requestSubmit()},children:i?"Removing...":"Remove Data"})})})]})}function my({projectId:n,projectName:a,onProjectDelete:t,onProjectClear:l,onProjectRemoveData:i}){const[r,s]=u.useState(null),c=a!=="default",[d]=D.useMutation(Ks),[m]=D.useMutation(Fs),y=u.useCallback(()=>{u.startTransition(()=>{d({variables:{projectId:n}}),t()})},[d,n,t]),g=u.useCallback(()=>{u.startTransition(()=>{m({variables:{input:{id:n}},onCompleted:()=>{l()},onError:b=>{alert("Failed to clear project: "+b)}})})},[m,n,l]),p=u.useCallback(()=>{s(o(Z,{size:"S",title:"Delete Project",children:[e(K,{padding:"size-200",children:e(x,{color:"danger",children:`Are you sure you want to delete project ${a}? This cannot be undone.`})}),e(K,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(z,{variant:"danger",onClick:()=>{y(),s(null)},children:"Delete Project"})})})]}))},[y,a]),f=u.useCallback(()=>{s(o(Z,{size:"S",title:"Clear Project",children:[e(K,{padding:"size-200",children:e(x,{color:"danger",children:`Are you sure you want to clear project ${a}? All traces and evaluations for this project will be deleted. This cannot be undone.`})}),e(K,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(z,{variant:"danger",onClick:()=>{g(),s(null)},children:"Clear"})})})]}))},[g,a]),k=u.useCallback(()=>{s(e(Z,{size:"M",title:"Remove Data",children:e(uy,{projectId:n,onComplete:()=>{i(),s(null)}})}))},[i,n]);return o("div",{onClick:b=>{b.preventDefault(),b.stopPropagation()},children:[o(Nn,{buttonVariant:"quiet",align:"end",onAction:b=>{switch(b){case"deleteProject":return p();case"clearProject":return f();case"removeProjectData":return k()}},disabledKeys:c?[]:["deleteProject"],children:[e(le,{textValue:"Clear Traces",children:o(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(I.Refresh,{})}),e(x,{children:"Clear Data"})]})},"clearProject"),e(le,{textValue:"Remove Data",children:o(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(I.CloseCircleOutline,{})}),e(x,{children:"Remove Data"})]})},"removeProjectData"),c?e(le,{children:o(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(I.TrashOutline,{})}),e(x,{children:"Delete"})]})},"deleteProject"):null]}),e(ee,{type:"modal",isDismissable:!0,onDismiss:()=>s(null),children:r})]})}function gy(){const n=ze(t=>t.projectsAutoRefreshEnabled),a=ze(t=>t.setProjectAutoRefreshEnabled);return e(Xn,{labelPlacement:"start",isSelected:n,onChange:()=>{a(!n)},children:"Auto-Refresh"})}const py=1e4,yy=50;function H0(){const{timeRange:n}=Ha();return e(u.Suspense,{fallback:e(ye,{}),children:e(fy,{timeRange:n})})}function fy({timeRange:n}){const a=ze(v=>v.projectsAutoRefreshEnabled),[t,l]=vd(),i=u.useMemo(()=>({start:n.start.toISOString(),end:n.end.toISOString()}),[n]),r=D.useLazyLoadQuery(Cs,{timeRange:i}),{data:s,loadNext:c,hasNext:d,isLoadingNext:m,refetch:y}=D.usePaginationFragment(vs,r),g=s.projects.edges.map(v=>v.project),p=u.useRef(null),f=u.useCallback(v=>{if(v){const{scrollHeight:P,scrollTop:E,clientHeight:R}=v;P-E-R<300&&!m&&d&&c(yy)}},[d,m,c]);ms(()=>{u.startTransition(()=>{y({},{fetchPolicy:"store-and-network"})})},a?py:null);const k=u.useCallback(v=>{u.startTransition(()=>{y({},{fetchPolicy:"store-and-network"}),t({variant:"success",title:"Project Deleted",message:`Project ${v} has been deleted.`})})},[t,y]),b=u.useCallback(v=>{u.startTransition(()=>{y({},{fetchPolicy:"store-and-network"}),t({variant:"success",title:"Project Cleared",message:`Project ${v} has been cleared of traces.`})})},[t,y]),S=u.useCallback(v=>{u.startTransition(()=>{y({},{fetchPolicy:"store-and-network"}),t({variant:"success",title:"Project Data Removed",message:`Old data from project ${v} have been removed.`})})},[t,y]);return o("div",{css:C`
        flex: 1 1 auto;
        overflow-y: auto;
        overflow-x: hidden;
        padding-bottom: var(--ac-global-dimension-size-750);
      `,onScroll:v=>f(v.target),ref:p,children:[e(K,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",width:"100%",borderBottomColor:"grey-200",borderBottomWidth:"thin",children:o(h,{direction:"row",justifyContent:"end",alignItems:"center",gap:"size-100",children:[e(gy,{}),e(dy,{}),e(ai,{})]})}),e(K,{padding:"size-200",width:"100%",children:e("ul",{css:C`
            display: flex;
            flex-direction: row;
            gap: var(--ac-global-dimension-size-200);
            flex-wrap: wrap;
          `,children:g.map(v=>e("li",{children:e(Ge,{to:`/projects/${v.id}`,css:C`
                  text-decoration: none;
                `,children:e(ky,{project:v,onProjectDelete:()=>k(v.name),onProjectClear:()=>b(v.name),onProjectRemoveData:()=>S(v.name)})})},v.id))})}),l]})}function hy({gradientStartColor:n,gradientEndColor:a}){return e("div",{css:C`
        border-radius: 50%;
        width: 32px;
        height: 32px;
        background: linear-gradient(
          136.27deg,
          ${n} 14.03%,
          ${a} 84.38%
        );
        flex-shrink: 0;
      `})}function ky({project:n,onProjectDelete:a,onProjectClear:t,onProjectRemoveData:l}){const{endTime:i,traceCount:r,tokenCountTotal:s,latencyMsP50:c,gradientStartColor:d,gradientEndColor:m}=n,y=u.useMemo(()=>i?`Last updated  ${ld(new Date(i),new Date,{addSuffix:!0})}`:"No traces uploaded yet.",[i]);return o("div",{css:C`
        padding: var(--ac-global-dimension-size-200);
        border: 1px solid var(--ac-global-color-grey-400);
        background-color: var(--ac-global-color-grey-100);
        border-radius: var(--ac-global-rounding-medium);
        height: var(--ac-global-dimension-size-1250);
        width: var(--ac-global-dimension-size-3600);
        transition: border-color 0.2s;
        &:hover {
          border-color: var(--ac-global-color-primary);
        }
        display: flex;
        flex-direction: column;
        justify-content: space-between;
      `,children:[o(h,{direction:"row",justifyContent:"space-between",alignItems:"start",children:[o(h,{direction:"row",gap:"size-100",alignItems:"center",minWidth:0,children:[e(hy,{gradientStartColor:d,gradientEndColor:m}),o(h,{direction:"column",minWidth:0,children:[e(ce,{level:2,css:C`
                overflow: hidden;
                white-space: nowrap;
                text-overflow: ellipsis;
              `,children:n.name}),e(x,{color:"text-700",textSize:"small",fontStyle:"italic",children:y})]})]}),e(my,{projectId:n.id,projectName:n.name,onProjectDelete:a,onProjectClear:t,onProjectRemoveData:l})]}),o(h,{direction:"row",justifyContent:"space-between",children:[o(h,{direction:"column",flex:"none",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Total Traces"}),e(x,{textSize:"xlarge",children:En(r)})]}),o(h,{direction:"column",flex:"none",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Total Tokens"}),e(x,{textSize:"xlarge",children:En(s)})]}),o(h,{direction:"column",flex:"none",children:[e(x,{elementType:"h3",textSize:"medium",color:"text-700",children:"Latency P50"}),c!=null?e(Ce,{latencyMs:c,textSize:"xlarge"}):e(x,{textSize:"xlarge",children:"--"})]})]})]})}const Ts=function(){var n=[{kind:"Literal",name:"first",value:100},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetsPageQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetsPageQuery",selections:[{alias:null,args:n,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:'datasets(first:100,sort:{"col":"createdAt","dir":"desc"})'},{alias:null,args:n,filters:["sort"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"695b221e981c4795492d79faa7d007e4",id:null,metadata:{},name:"DatasetsPageQuery",operationKind:"query",text:`query DatasetsPageQuery {
  ...DatasetsTable_datasets
}

fragment DatasetsTable_datasets on Query {
  datasets(first: 100, sort: {col: createdAt, dir: desc}) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Ts.hash="985853a7939f44c0cefdd1a91472c67e";function by(n){const a=n.split(`
`);return a.length>0?a[0].split(",").map(t=>t.trim()):[]}function Sy(n){const{onDatasetCreated:a,onDatasetCreateError:t}=n,[l,i]=u.useState([]),{control:r,handleSubmit:s,resetField:c,formState:{isDirty:d,isValid:m}}=Ue({defaultValues:{name:"Dataset "+new Date().toISOString(),input_keys:[],output_keys:[],metadata_keys:[],description:"",metadata:{}}}),y=u.useCallback(g=>{const p=new FormData;return p.append("file",g.file[0]),p.append("name",g.name),p.append("description",g.description),p.append("metadata",JSON.stringify(g.metadata)),g.input_keys.forEach(f=>{p.append("input_keys[]",f)}),g.output_keys.forEach(f=>{p.append("output_keys[]",f)}),g.metadata_keys.forEach(f=>{p.append("metadata_keys[]",f)}),fetch("/v1/datasets/upload?sync=true",{method:"POST",body:p}).then(f=>{if(!f.ok)throw t(new Error(f.statusText||"Failed to create dataset"));return f.json()}).then(f=>{a({name:g.name,id:f.data.dataset_id})})},[t,a]);return o(Re,{onSubmit:s(y),children:[o("div",{css:C`
          padding: var(--ac-global-dimension-size-200);
          .ac-dropdown-button {
            width: 100%;
          }
        `,children:[e(W,{name:"name",control:r,rules:{required:"field is required"},render:({field:{onChange:g,onBlur:p,value:f},fieldState:{invalid:k,error:b}})=>e(ae,{label:"Dataset Name",description:"The name of the dataset",errorMessage:b==null?void 0:b.message,validationState:k?"invalid":"valid",onChange:g,onBlur:p,value:f.toString()})}),e(W,{name:"description",control:r,render:({field:{onChange:g,onBlur:p,value:f},fieldState:{invalid:k,error:b}})=>e(vt,{label:"description",placeholder:"Description of the dataset",isRequired:!1,height:100,errorMessage:b==null?void 0:b.message,validationState:k?"invalid":"valid",onChange:g,onBlur:p,value:f.toString()})}),e(W,{control:r,name:"file",rules:{required:"CSV file is required"},render:({field:{value:g,onChange:p,...f},fieldState:{invalid:k,error:b}})=>e(Vn,{label:"CSV file",validationState:k?"invalid":"valid",errorMessage:b==null?void 0:b.message,children:e("input",{...f,onChange:S=>{var P;p(S.target.files),c("input_keys"),c("output_keys"),c("metadata_keys");const v=(P=S.target.files)==null?void 0:P[0];if(v){const E=new FileReader;E.onload=function(R){if(!R.target)return;const F=R.target.result,T=by(F);i(T)},E.readAsText(v)}},type:"file",id:"file",accept:".csv"})})}),e(W,{name:"input_keys",control:r,rules:{required:"field is required"},render:({field:{value:g,onChange:p},fieldState:{invalid:f,error:k}})=>e(ct,{label:"input keys",validationState:f?"invalid":"valid",description:"the columns to use as input",columns:l,selectedColumns:g,onChange:p,errorMessage:k==null?void 0:k.message})}),e(W,{name:"output_keys",control:r,render:({field:{value:g,onChange:p},fieldState:{invalid:f,error:k}})=>e(ct,{label:"output keys",validationState:f?"invalid":"valid",description:"the columns to use as output",columns:l,selectedColumns:g,onChange:p,errorMessage:k==null?void 0:k.message})}),e(W,{name:"metadata_keys",control:r,render:({field:{value:g,onChange:p},fieldState:{invalid:f,error:k}})=>e(ct,{label:"metadata keys",validationState:f?"invalid":"valid",description:"the columns to use as metadata",columns:l,selectedColumns:g,onChange:p,errorMessage:k==null?void 0:k.message})})]}),e(K,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(z,{type:"submit",isDisabled:!m,variant:d?"primary":"default",size:"compact",loading:!1,children:"Create Dataset"})})})]})}function ct(n){const{columns:a,selectedColumns:t,onChange:l,label:i,validationState:r,description:s,errorMessage:c,...d}=n,m=a.length===0,y=u.useMemo(()=>m?"No columns to select":t.length>0?`${t.join(", ")}`:"No columns selected",[t,m]);return e(Vn,{label:i,isDisabled:m,validationState:r,description:s,errorMessage:c,children:e(Kt,{isDisabled:m,...d,menu:e(Qa,{selectionMode:"multiple",onSelectionChange:g=>{l(Array.from(g))},selectedKeys:new Set(t),children:a.map(g=>e(le,{children:g},g))}),triggerProps:{placement:"bottom end"},children:y})})}const Is=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"sort",variableName:"sort"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetsTableDatasetsQuery",selections:[{args:a,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetsTableDatasetsQuery",selections:[{alias:null,args:a,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:["sort"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"5ac1688f54e51f9bb3247c83e23d98fb",id:null,metadata:{},name:"DatasetsTableDatasetsQuery",operationKind:"query",text:`query DatasetsTableDatasetsQuery(
  $after: String = null
  $first: Int = 100
  $sort: DatasetSort = {col: createdAt, dir: desc}
) {
  ...DatasetsTable_datasets_dWkdd
}

fragment DatasetsTable_datasets_dWkdd on Query {
  datasets(first: $first, after: $after, sort: $sort) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}}();Is.hash="fa378bc7ec26f5e877e6cf90e5ee553d";const Ds=function(){var n=["datasets"];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Is}},name:"DatasetsTable_datasets",selections:[{alias:"datasets",args:[{kind:"Variable",name:"sort",variableName:"sort"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"__DatasetsTable_datasets_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}}();Ds.hash="fa378bc7ec26f5e877e6cf90e5ee553d";const Ps=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{alias:null,args:[{fields:[{kind:"Variable",name:"datasetId",variableName:"datasetId"}],kind:"ObjectValue",name:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeleteDatasetDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeleteDatasetDialogMutation",selections:a},params:{cacheID:"3d32b97acd630dd7dbc9c85a632a1d49",id:null,metadata:{},name:"DeleteDatasetDialogMutation",operationKind:"mutation",text:`mutation DeleteDatasetDialogMutation(
  $datasetId: GlobalID!
) {
  deleteDataset(input: {datasetId: $datasetId}) {
    __typename
  }
}
`}}}();Ps.hash="7066cca7015a7e344b77862b0bdab21c";function vy({datasetId:n,datasetName:a,onDatasetDelete:t,onDatasetDeleteError:l}){const[i,r]=D.useMutation(Ps),s=u.useCallback(()=>{u.startTransition(()=>{i({variables:{datasetId:n},onCompleted:()=>{t()},onError:c=>{l(c)}})})},[i,n,t,l]);return o(Z,{size:"S",title:"Delete Dataset",children:[e(K,{padding:"size-200",children:e(x,{color:"danger",children:`Are you sure you want to delete dataset ${a}? This will also delete all associated experiments and traces, and it cannot be undone.`})}),e(K,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(z,{variant:"danger",onClick:()=>{s()},disabled:r,loading:r,children:"Delete Dataset"})})})]})}function Cy({datasetName:n,datasetId:a,datasetDescription:t,datasetMetadata:l,onDatasetEdited:i,onDatasetEditError:r}){return e(Z,{title:"Edit Dataset",size:"M",children:e(Fc,{datasetName:n,datasetId:a,datasetDescription:t,datasetMetadata:l,onDatasetEdited:i,onDatasetEditError:r})})}function Fy(n){const{datasetId:a,datasetName:t,datasetDescription:l,datasetMetadata:i,onDatasetDelete:r,onDatasetDeleteError:s,onDatasetEdit:c,onDatasetEditError:d}=n,[m,y]=u.useState(null),g=u.useCallback(()=>{y(e(vy,{datasetId:a,datasetName:t,onDatasetDelete:()=>{r(),y(null)},onDatasetDeleteError:s}))},[a,t,r,s]),p=u.useCallback(()=>{y(e(Cy,{datasetId:a,datasetName:t,datasetDescription:l,datasetMetadata:i,onDatasetEdited:()=>{c(),y(null)},onDatasetEditError:d}))},[l,a,i,t,c,d]);return o("div",{onClick:f=>{f.preventDefault(),f.stopPropagation()},children:[o(Nn,{align:"end",buttonSize:"compact",onAction:f=>{switch(f){case"deleteDataset":g();break;case"editDataset":p();break}},children:[e(le,{children:o(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(I.TrashOutline,{})}),e(x,{children:"Delete"})]})},"deleteDataset"),e(le,{children:o(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(I.Edit2Outline,{})}),e(x,{children:"Edit"})]})},"editDataset")]}),e(ee,{type:"modal",isDismissable:!0,onDismiss:()=>y(null),children:m})]})}const yl=100;function Ky(n){const a=n.id;if(a!=="createdAt"&&a!=="name")throw new Error("Invalid sort column");return{col:a,dir:n.desc?"desc":"asc"}}function xy(n){const[a,t]=u.useState([]),l=u.useRef(null),i=X(),r=xe(),s=ve(),{data:c,loadNext:d,hasNext:m,isLoadingNext:y,refetch:g}=D.usePaginationFragment(Ds,n.query),p=u.useMemo(()=>c.datasets.edges.map(v=>v.node),[c]),f=Se.useCallback(v=>{if(v){const{scrollHeight:P,scrollTop:E,clientHeight:R}=v;P-E-R<300&&!y&&m&&d(yl)}},[m,y,d]),k=Fe({columns:[{header:"name",accessorKey:"name",cell:({row:v})=>{const E=v.original.experimentCount>0?`${v.original.id}/experiments`:`${v.original.id}/examples`;return e(Ge,{to:E,children:v.original.name})}},{header:"description",accessorKey:"description",enableSorting:!1},{header:"created at",accessorKey:"createdAt",cell:Ee},{header:"example count",accessorKey:"exampleCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"experiment count",accessorKey:"experimentCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:Wn},{header:"",id:"actions",enableSorting:!1,size:10,cell:({row:v})=>e(Fy,{datasetId:v.original.id,datasetName:v.original.name,datasetDescription:v.original.description,datasetMetadata:v.original.metadata,onDatasetEdit:()=>{r({title:"Dataset updated",message:`${v.original.name} has been successfully updated.`}),g({},{fetchPolicy:"store-and-network"})},onDatasetEditError:P=>{s({title:"Dataset update failed",message:P.message})},onDatasetDelete:()=>{r({title:"Dataset deleted",message:`${v.original.name} has been successfully deleted.`}),g({},{fetchPolicy:"store-and-network"})},onDatasetDeleteError:P=>{s({title:"Dataset deletion failed",message:P.message})}})}],data:p,state:{sorting:a},getCoreRowModel:Ke(),getSortedRowModel:Mn(),onSortingChange:t,manualSorting:!0});u.useEffect(()=>{const v=a[0];u.startTransition(()=>{g({sort:v?Ky(v):{col:"createdAt",dir:"desc"},after:null,first:yl},{fetchPolicy:"store-and-network"})})},[a,g]);const b=k.getRowModel().rows,S=b.length===0;return e("div",{css:C`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:v=>f(v.target),ref:l,children:o("table",{css:$n,children:[e("thead",{children:k.getHeaderGroups().map(v=>e("tr",{children:v.headers.map(P=>{var E;return e("th",{colSpan:P.colSpan,children:P.isPlaceholder?null:o("div",{className:P.column.getCanSort()?"cursor-pointer":"",onClick:P.column.getToggleSortingHandler(),style:{textAlign:(E=P.column.columnDef.meta)==null?void 0:E.textAlign},children:[J(P.column.columnDef.header,P.getContext()),P.column.getIsSorted()?e(L,{className:"sort-icon",svg:P.column.getIsSorted()==="asc"?e(I.ArrowUpFilled,{}):e(I.ArrowDownFilled,{})}):null]})},P.id)})},v.id))}),S?e(an,{}):e("tbody",{children:b.map(v=>e("tr",{onClick:()=>{const E=v.original.experimentCount>0?`${v.original.id}/experiments`:`${v.original.id}/examples`;i(E)},children:v.getVisibleCells().map(P=>{var E;return e("td",{align:(E=P.column.columnDef.meta)==null?void 0:E.textAlign,children:J(P.column.columnDef.cell,P.getContext())},P.id)})},v.id))})]})})}function G0(){return e(u.Suspense,{fallback:e(ye,{}),children:e(Ty,{})})}function Ty(){const[n,a]=u.useState(0),t=D.useLazyLoadQuery(Ts,{},{fetchKey:n,fetchPolicy:"store-and-network"}),l=u.useCallback(()=>{a(i=>i+1)},[a]);return o(h,{direction:"column",height:"100%",children:[e(K,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",flex:"none",children:o(h,{direction:"row",justifyContent:"space-between",children:[e(ce,{level:1,children:"Datasets"}),e(Iy,{onDatasetCreated:l})]})}),e(xy,{query:t})]})}function Iy({onDatasetCreated:n}){const a=X(),t=xe(),l=ve(),[i,r]=u.useState(null),s=()=>{r(e(Z,{size:"S",title:"New Dataset",children:e(ni,{onDatasetCreated:d=>{t({title:"Dataset created",message:`${d.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${d.id}`)}}}),r(null),n()},onDatasetCreateError:d=>{l({title:"Dataset creation failed",message:d.message})}})}))},c=()=>{r(e(Z,{size:"M",title:"New Dataset from CSV",children:e(Sy,{onDatasetCreated:d=>{t({title:"Dataset created",message:`${d.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${d.id}`)}}}),r(null),n()},onDatasetCreateError:d=>{l({title:"Dataset creation failed",message:d.message})}})}))};return o(G,{children:[o(Nn,{buttonText:"Create Dataset",align:"end",icon:e(L,{svg:e(I.DatabaseOutline,{})}),onAction:d=>{switch(d){case"newDataset":s();break;case"datasetFromCSV":c();break}},children:[e(le,{children:"New Dataset"},"newDataset"),e(le,{children:"Dataset from CSV"},"datasetFromCSV")]}),e(ee,{type:"modal",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const Ls=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"d7075240e4dae8871997e57616c05302",id:null,metadata:{},name:"datasetStore_latestVersionQuery",operationKind:"query",text:`query datasetStore_latestVersionQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}}();Ls.hash="a1349b92d8b0c745f5e8039c55b048c7";const Dy=n=>{const a=(t,l)=>({...n,isRefreshingLatestVersion:!1,refreshLatestVersion:async()=>{const i=l();t({isRefreshingLatestVersion:!0});const r=await Py({datasetId:i.datasetId});t({latestVersion:r,isRefreshingLatestVersion:!1})}});return Il()(id(a))};async function Py({datasetId:n}){var i;const a=await D.fetchQuery(Me,Ls,{datasetId:n}).toPromise(),t=(i=a==null?void 0:a.dataset.latestVersions)==null?void 0:i.edges;return t&&t.length&&t[0].version||null}const ws=u.createContext(null);function Ly({children:n,...a}){const[t]=u.useState(()=>Dy(a));return e(ws.Provider,{value:t,children:n})}function An(n,a){const t=u.useContext(ws);if(!t)throw new Error("Missing DatasetContext.Provider in the tree");return ba(t,n,a)}const Es=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"AddDatasetExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"AddDatasetExampleDialogMutation",selections:a},params:{cacheID:"718cf02ccb39b279132822bf503e51e6",id:null,metadata:{},name:"AddDatasetExampleDialogMutation",operationKind:"mutation",text:`mutation AddDatasetExampleDialogMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    __typename
  }
}
`}}}();Es.hash="8d99470f590cd5d28701fa6e3c0330e6";const ut={backgroundColor:"light",borderColor:"light",collapsible:!0,bodyStyle:{padding:0}};function wy(n){const{datasetId:a,onCompleted:t}=n,[l,i]=u.useState(null),[r,s]=D.useMutation(Es),{control:c,setError:d,handleSubmit:m,formState:{isValid:y}}=Ue({defaultValues:{input:"{}",output:"{}",metadata:"{}"}}),g=u.useCallback(p=>{if(i(null),!ln(p==null?void 0:p.input))return d("input",{message:"Input must be a valid JSON object"});if(!ln(p==null?void 0:p.output))return d("output",{message:"Output must be a valid JSON object"});if(!ln(p==null?void 0:p.metadata))return d("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{datasetId:a,examples:[{input:JSON.parse(p.input),output:JSON.parse(p.output),metadata:JSON.parse(p.metadata)}],datasetVersionDescription:p.description}},onCompleted:()=>{t()},onError:f=>{i(f.message)}})},[r,a,d,t]);return o(Z,{size:"L",title:"Add Example",children:[e("div",{css:C`
          overflow-y: auto;
          padding: var(--ac-global-dimension-size-400);
        `,children:e(h,{direction:"row",justifyContent:"center",children:e(K,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:o(h,{direction:"column",gap:"size-200",children:[l?e(ue,{variant:"danger",children:l}):null,e(W,{control:c,name:"input",render:({field:{onChange:p,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>o(q,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...ut,children:[b?e(ue,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(_e,{value:k,onChange:p,onBlur:f})]})}),e(W,{control:c,name:"output",render:({field:{onChange:p,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>o(q,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...ut,backgroundColor:"green-100",borderColor:"green-700",children:[b?e(ue,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(_e,{value:k,onChange:p,onBlur:f})]})}),e(W,{control:c,name:"metadata",render:({field:{onChange:p,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>o(q,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...ut,children:[b?e(ue,{variant:"danger",banner:!0,children:S==null?void 0:S.message}):null,e(_e,{value:k,onChange:p,onBlur:f})]})}),e(W,{control:c,name:"description",render:({field:{onChange:p,onBlur:f,value:k},fieldState:{invalid:b,error:S}})=>e(vt,{label:"Version Description",value:k,onChange:p,onBlur:f,errorMessage:S==null?void 0:S.message,validationState:b?"invalid":"valid",placeholder:"A description of the changes made. Will be displayed in the version history.",height:100})})]})})})}),e(K,{padding:"size-200",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",gap:"size-100",children:e(z,{variant:"primary",size:"compact",disabled:!y||s,loading:s,onClick:m(g),children:"Add Example"})})})]})}function Ey(n){const{datasetId:a,onAddExampleCompleted:t}=n,[l,i]=u.useState(null),r=u.useCallback(()=>{i(e(wy,{datasetId:a,onCompleted:()=>{t(),i(null)}}))},[a,t]);return o(G,{children:[e(z,{icon:e(L,{svg:e(I.PlusCircleOutline,{})}),size:"compact",variant:"default",onClick:r,children:"Add Example"}),e(ee,{isDismissable:!0,onDismiss:()=>{i(null)},children:l})]})}function _y(){const n=An(i=>i.datasetId),a=An(i=>i.latestVersion);let t=`${ft}/v1/datasets/${n}/examples`;a&&(t+=`?version-id=${a.id}`);const l=u.useMemo(()=>`import phoenix as px
client = px.Client()
# Get the current dataset version
dataset = client.get_dataset(id="${n}"${a?`, version_id="${a.id}"`:""})`,[n,a]);return e("div",{css:C`
        button.ac-dropdown-button {
          min-width: 80px;
          .ac-dropdown-button__text {
            padding-right: 10px;
          }
        }
      `,children:o(Zn,{placement:"bottom right",children:[e(Ft,{addonBefore:e(L,{svg:e(I.Code,{})}),children:"Code"}),e(Oa,{children:o("section",{css:C`
              width: 500px;
              .ac-field {
                flex: 1 1 auto;
              }
            `,children:[e(K,{padding:"size-200",children:o(Re,{children:[o(h,{direction:"row",gap:"size-100",alignItems:"end",width:"100%",children:[e(ae,{label:"Dataset ID",isReadOnly:!0,value:n}),e(se,{text:n,size:"default"})]}),o(h,{direction:"row",gap:"size-100",alignItems:"end",children:[e(ae,{label:"Version ID",isReadOnly:!0,value:(a==null?void 0:a.id)||"No Versions",validationState:a?"valid":"invalid"}),e(se,{text:(a==null?void 0:a.id)||"No Versions",disabled:!a,size:"default"})]})]})}),o(Qe,{children:[e(ne,{name:"Python",children:e(K,{margin:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"small",children:e(We,{value:l})})}),e(ne,{name:"REST",children:e(K,{padding:"size-200",children:e(Re,{children:o(h,{direction:"row",gap:"size-100",alignItems:"end",children:[e(ae,{label:"URL",isReadOnly:!0,value:t}),e(se,{text:t,size:"default"})]})})})})]})]})})]})})}const _s=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetHistoryDialogQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,{args:null,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetHistoryDialogQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},l],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"versions(first:100)"},{alias:null,args:i,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"df94b4e72c0187fd0fd1c8416af19354",id:null,metadata:{},name:"DatasetHistoryDialogQuery",operationKind:"query",text:`query DatasetHistoryDialogQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      id
      ...DatasetHistoryTable_versions
    }
    __isNode: __typename
    id
  }
}

fragment DatasetHistoryTable_versions on Dataset {
  versions(first: 100) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();_s.hash="7215c18bda690418c5ecbcb3131a288e";const Rs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},l],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"e8e3a05b4e86c8eaeea98172405fdc7e",id:null,metadata:{},name:"DatasetHistoryTableVersionsQuery",operationKind:"query",text:`query DatasetHistoryTableVersionsQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...DatasetHistoryTable_versions_2HEEH6
    __isNode: __typename
    id
  }
}

fragment DatasetHistoryTable_versions_2HEEH6 on Dataset {
  versions(first: $first, after: $after) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Rs.hash="37e453bc58759a1e89bc5862c460de6b";const As=function(){var n=["versions"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Rs,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DatasetHistoryTable_versions",selections:[{alias:"versions",args:null,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"__DatasetHistoryTable_versions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();As.hash="37e453bc58759a1e89bc5862c460de6b";const Ry=100;function Ay(n){const a=u.useRef(null),{data:t,loadNext:l,hasNext:i,isLoadingNext:r}=D.usePaginationFragment(As,n.dataset),s=u.useMemo(()=>t.versions.edges.map(g=>g.node),[t]),c=Se.useCallback(g=>{if(g){const{scrollHeight:p,scrollTop:f,clientHeight:k}=g;p-f-k<300&&!r&&i&&l(Ry)}},[i,r,l]),d=Fe({columns:[{header:"version ID",accessorKey:"id"},{header:"description",accessorKey:"description"},{header:"created at",accessorKey:"createdAt",cell:Ee}],data:s,getCoreRowModel:Ke(),getSortedRowModel:Mn()}),m=d.getRowModel().rows,y=m.length===0;return e("div",{css:C`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:g=>c(g.target),ref:a,children:o("table",{css:nn,children:[e("thead",{children:d.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(p=>e("th",{colSpan:p.colSpan,children:p.isPlaceholder?null:o("div",{className:p.column.getCanSort()?"cursor-pointer":"",onClick:p.column.getToggleSortingHandler(),style:{left:p.getStart(),width:p.getSize()},children:[J(p.column.columnDef.header,p.getContext()),p.column.getIsSorted()?e(L,{className:"sort-icon",svg:p.column.getIsSorted()==="asc"?e(I.ArrowUpFilled,{}):e(I.ArrowDownFilled,{})}):null]})},p.id))},g.id))}),y?e(an,{}):e("tbody",{children:m.map(g=>e("tr",{children:g.getVisibleCells().map(p=>e("td",{children:J(p.column.columnDef.cell,p.getContext())},p.id))},g.id))})]})})}function My(n){const{datasetId:a}=n,t=D.useLazyLoadQuery(_s,{datasetId:a});return e(Z,{size:"L",title:"Dataset History",children:e("div",{css:C`
          height: 500px;
        `,children:e(Ay,{dataset:t.dataset})})})}function Ny(n){const{datasetId:a}=n,[t,l]=u.useState(null);return o(G,{children:[o(pe,{children:[e(z,{variant:"default",icon:e(L,{svg:e(I.ClockOutline,{})}),"aria-label":"Version History",onClick:()=>{l(e(My,{datasetId:a}))}}),e(Ie,{children:"Dataset Version History"})]}),e(u.Suspense,{fallback:null,children:e(ee,{type:"modal",isDismissable:!0,onDismiss:()=>{l(null)},children:t})})]})}const zy=`pip install arize-phoenix>=${window.Config.platformVersion}`;function Vy({isAuthEnabled:n}){let a=`import os
# Set the phoenix collector endpoint. Commonly http://localhost:6060 
os.environ["PHOENIX_COLLECTOR_ENDPOINT"] = "<your-phoenix-url>"`;return n&&(a+=`
# Configure access
os.environ["PHOENIX_API_KEY"] = "<your-api-key>"`),a}const $y=`from phoenix.experiments.types import Example
# Define your task
# Typically should be an LLM call or a call to your application
def my_task(example: Example) -> str:
    # This is just an example of how to return a JSON serializable value
    return f"Hello {example.input["person"]}"`,Oy=`# Define an evaluator. This just an example.
def exact_match(input, output) -> float:
    return 1.0 if output is f"Hello {input}" else 0.0

# Store the evaluators for later use
evaluators = [exact_match]`,Qy=`# Run an experiment
from phoenix.experiments import run_experiment

experiment = run_experiment(dataset, my_task, evaluators=evaluators)`;function Ms(){const[n,a]=u.useState(null),t=u.useCallback(()=>{a(e(Z,{title:"Run Experiment",size:"XL",children:e(jy,{})}))},[]);return o(G,{children:[e(z,{size:"compact",variant:"default",icon:e(L,{svg:e(I.ExperimentOutline,{})}),onClick:t,children:"Run Experiment"}),e(ee,{isDismissable:!0,type:"slideOver",onDismiss:()=>{a(null)},children:n})]})}function jy(){const n=An(i=>i.datasetName),a=An(i=>i.latestVersion),t=window.Config.authenticationEnabled,l=u.useMemo(()=>`import phoenix as px
# Initialize a phoenix client
client = px.Client()
# Get the current dataset version. You can omit the version for the latest.
dataset = client.get_dataset(name="${n}"${a?`, version_id="${a.id}"`:""})`,[n,a]);return o(K,{padding:"size-400",overflow:"auto",children:[e(K,{paddingBottom:"size-100",children:e(x,{children:"Install Phoenix"})}),e(Ne,{children:e(We,{value:zy})}),e(K,{paddingTop:"size-100",paddingBottom:"size-100",children:e(x,{children:"Point to a running instance of Phoenix"})}),e(Ne,{children:e(We,{value:Vy({isAuthEnabled:t})})}),e(Kc,{children:e(K,{paddingBottom:"size-100",paddingTop:"size-100",children:e(ti,{fallback:o(x,{children:["Your personal API keys can be created and managed on your"," ",e(He,{href:"/profile",children:"Profile"})]}),children:o(x,{children:["System API keys can be created and managed in"," ",e(He,{href:"/settings",children:"Settings"})]})})})}),e(K,{paddingTop:"size-100",paddingBottom:"size-100",children:e(x,{children:"Pull down this dataset"})}),e(Ne,{children:e(We,{value:l})}),e(K,{paddingTop:"size-100",paddingBottom:"size-100",children:e(x,{children:"Define your task"})}),e(Ne,{children:e(We,{value:$y})}),e(K,{paddingTop:"size-100",paddingBottom:"size-100",children:e(x,{children:"Define evaluators"})}),e(Ne,{children:e(We,{value:Oy})}),e(K,{paddingTop:"size-100",paddingBottom:"size-100",children:e(x,{children:"Run an experiment"})}),e(Ne,{children:e(We,{value:Qy})})]})}function W0(){const n=kn(),a=u.useMemo(()=>{const t=n.dataset.latestVersions;return t!=null&&t.edges&&t.edges.length?t.edges[0].version:null},[n]);return e(Ly,{datasetId:n.dataset.id,datasetName:n.dataset.name,latestVersion:a,children:e(u.Suspense,{fallback:e(ye,{}),children:e(Uy,{dataset:n.dataset})})})}const qy=C`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function Uy({dataset:n}){const a=n.id,t=An(d=>d.refreshLatestVersion),l=xe(),i=X(),r=u.useCallback(d=>{d===0?i(`/datasets/${a}/experiments`):d===1&&i(`/datasets/${a}/examples`)},[i,a]),c=rd().pathname.includes("examples")?1:0;return o("main",{css:qy,children:[e(K,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-50",flex:"none",children:o(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(h,{direction:"column",justifyContent:"space-between",children:e(h,{direction:"row",gap:"size-200",alignItems:"center",children:o(h,{direction:"column",children:[e(x,{elementType:"h1",textSize:"xlarge",weight:"heavy",children:n.name}),e(x,{color:"text-700",children:n.description||"--"})]})})}),o(h,{direction:"row",gap:"size-100",children:[o(Nn,{align:"end",icon:e(L,{svg:e(I.DownloadOutline,{})}),onAction:d=>{switch(d){case"csv":window.open(`/v1/datasets/${n.id}/csv`,"_blank");break;case"openai-ft":window.open(`/v1/datasets/${n.id}/jsonl/openai_ft`,"_blank");break;case"openai-evals":window.open(`/v1/datasets/${n.id}/jsonl/openai_evals`,"_blank");break}},children:[e(le,{children:"Download CSV"},"csv"),e(le,{children:"Download OpenAI Fine-Tuning JSONL"},"openai-ft"),e(le,{children:"Download OpenAI Evals JSONL"},"openai-evals")]}),e(Ny,{datasetId:n.id}),e(_y,{}),e(Ms,{}),e(z,{variant:"default",icon:e(L,{svg:e(I.PlayCircleOutline,{})}),onClick:()=>{i(`/playground/datasets/${n.id}`)},children:"Playground"}),e(Ey,{datasetId:n.id,onAddExampleCompleted:()=>{l({title:"Example added",message:"The example has been added successfully and the version has been updated."}),t()}})]})]})}),o(Qe,{onChange:r,defaultIndex:c,children:[e(ne,{name:"Experiments",extra:e(Je,{children:n.experimentCount}),children:e(u.Suspense,{children:e(Oe,{})})}),e(ne,{name:"Examples",extra:e(Je,{children:n.exampleCount}),children:e(u.Suspense,{children:e(Oe,{})})})]})]})}const Ns=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,i],storageKey:null}]},params:{cacheID:"5b221627cf7e63f41fbec41027cc0951",id:null,metadata:{},name:"datasetLoaderQuery",operationKind:"query",text:`query datasetLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      name
      description
      exampleCount
      experimentCount
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}}();Ns.hash="469da2debdebd608c88a6ef83c2540aa";async function J0(n){const{datasetId:a}=n.params;return await D.fetchQuery(Me,Ns,{id:a}).toPromise()}function Z0(){const{exampleId:n,datasetId:a}=Ve(),t=X();return e($t,{exampleId:n,onDismiss:()=>{t(`/datasets/${a}/examples`)}})}const zs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{args:null,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"examples(first:100)"},{alias:null,args:i,filters:["datasetVersionId"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"7e303fa9a3c09ccd6a3dc1f3dbb2afb3",id:null,metadata:{},name:"examplesLoaderQuery",operationKind:"query",text:`query examplesLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ...ExamplesTableFragment
  }
}

fragment ExamplesTableFragment on Dataset {
  examples(first: 100) {
    edges {
      example: node {
        id
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();zs.hash="6406bbf43a2e850b384ba9573d8e69de";async function Y0(n){const{datasetId:a}=n.params;return await D.fetchQuery(Me,zs,{id:a}).toPromise()}const Vs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExamplesTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExamplesTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:["datasetVersionId"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"ca59c018695d41ca01b5f9d453386886",id:null,metadata:{},name:"ExamplesTableQuery",operationKind:"query",text:`query ExamplesTableQuery(
  $after: String = null
  $datasetVersionId: GlobalID
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExamplesTableFragment_4a6F8Z
    __isNode: __typename
    id
  }
}

fragment ExamplesTableFragment_4a6F8Z on Dataset {
  examples(datasetVersionId: $datasetVersionId, first: $first, after: $after) {
    edges {
      example: node {
        id
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Vs.hash="e04e697cdb44ab2dd115f4562211f6a4";const $s=function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Vs,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__ExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();$s.hash="e04e697cdb44ab2dd115f4562211f6a4";const Os=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDatasetExamples",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a},params:{cacheID:"b63159f3c325b9af3dc469692f9329e5",id:null,metadata:{},name:"ExampleSelectionToolbarDeleteExamplesMutation",operationKind:"mutation",text:`mutation ExampleSelectionToolbarDeleteExamplesMutation(
  $input: DeleteDatasetExamplesInput!
) {
  deleteDatasetExamples(input: $input) {
    dataset {
      id
    }
  }
}
`}}}();Os.hash="455bf9e5dc4b9cc655095dc829ef7e12";function By(n){const a=An(f=>f.refreshLatestVersion),{selectedExamples:t,onExamplesDeleted:l,onClearSelection:i}=n,[r,s]=u.useState(null),c=xe(),d=ve(),[m,y]=D.useMutation(Os),g=t.length!==1,p=u.useCallback(()=>{m({variables:{input:{exampleIds:t.map(f=>f.id)}},onCompleted:()=>{c({title:"Examples Deleted",message:`${t.length} example${g?"s":""} have been deleted.`}),l(),i(),a()},onError:f=>{d({title:"An error occurred",message:`Failed to delete examples: ${f.message}`})}})},[m,t,c,g,l,i,a,d]);return o("div",{css:C`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(K,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:o(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(x,{children:`${t.length} example${g?"s":""} selected`}),o(h,{direction:"row",gap:"size-100",children:[e(z,{variant:"default",size:"compact",onClick:i,children:"Cancel"}),e(z,{variant:"danger",size:"compact",icon:e(L,{svg:e(I.TrashOutline,{})}),loading:y,disabled:y,onClick:p,children:y?"Deleting...":"Delete Example"+(g?"s":"")})]})]})}),e(ee,{onDismiss:()=>{s(null)},children:r})]})}const Hy=100;function Gy({dataset:n}){const a=An(R=>R.latestVersion),t=u.useRef(null),[l,i]=Se.useState({}),{data:r,loadNext:s,hasNext:c,isLoadingNext:d,refetch:m}=D.usePaginationFragment($s,n);u.useEffect(()=>{u.startTransition(()=>{m({datasetVersionId:(a==null?void 0:a.id)||null},{fetchPolicy:"store-and-network"})})},[a,m]);const y=u.useMemo(()=>r.examples.edges.map(R=>{const F=R.example,T=F.revision;return{id:F.id,input:T.input,output:T.output,metadata:T.metadata}}),[r]),p=Fe({columns:[{id:"select",header:({table:R})=>e(fn,{checked:R.getIsAllRowsSelected(),indeterminate:R.getIsSomeRowsSelected(),onChange:R.getToggleAllRowsSelectedHandler()}),cell:({row:R})=>e(fn,{checked:R.getIsSelected(),disabled:!R.getCanSelect(),indeterminate:R.getIsSomeSelected(),onChange:R.getToggleSelectedHandler()})},{header:"example id",accessorKey:"id",cell:({getValue:R,row:F})=>{const T=F.original.id;return e(Ge,{to:`${T}`,children:R()})}},{header:"input",accessorKey:"input",cell:Wn},{header:"output",accessorKey:"output",cell:Wn},{header:"metadata",accessorKey:"metadata",cell:Wn}],data:y,state:{rowSelection:l},onRowSelectionChange:i,getCoreRowModel:Ke()}),f=p.getRowModel().rows,k=f.length===0,b=p.getSelectedRowModel().rows,S=b.map(R=>R.original),v=u.useCallback(()=>{i({})},[i]),P=u.useCallback(R=>{if(R){const{scrollHeight:F,scrollTop:T,clientHeight:w}=R;F-T-w<300&&!d&&c&&s(Hy)}},[c,d,s]),E=X();return o("div",{css:C`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:t,onScroll:R=>P(R.target),children:[o("table",{css:$n,children:[e("thead",{children:p.getHeaderGroups().map(R=>e("tr",{children:R.headers.map(F=>e("th",{children:e("div",{children:J(F.column.columnDef.header,F.getContext())})},F.id))},R.id))}),k?e(an,{}):e("tbody",{children:f.map(R=>e("tr",{onClick:()=>{E(`${R.original.id}`)},children:R.getVisibleCells().map(F=>e("td",{children:J(F.column.columnDef.cell,F.getContext())},F.id))},R.id))})]}),b.length?e(By,{selectedExamples:S,onClearSelection:v,onExamplesDeleted:()=>{m({},{fetchPolicy:"store-and-network"})}}):null]})}function X0(){const n=kn();return o(G,{children:[e(Gy,{dataset:n.dataset})," ",e(u.Suspense,{children:e(Oe,{})})]})}const Qs=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},r=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"experimentsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"ExperimentsTableFragment"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"experimentsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:r,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experiments(first:100)"},{alias:null,args:r,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"91f92395f5df4858554b124deed3f47a",id:null,metadata:{},name:"experimentsLoaderQuery",operationKind:"query",text:`query experimentsLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      ...ExperimentsTableFragment
    }
  }
}

fragment ExperimentsTableFragment on Dataset {
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: 100) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        averageRunLatencyMs
        project {
          id
        }
        annotationSummaries {
          annotationName
          meanScore
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Qs.hash="1461484d9e1232cbb99e1251edabbec3";async function e1(n){const{datasetId:a}=n.params;return await D.fetchQuery(Me,Qs,{id:a}).toPromise()}const js=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"ExperimentsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:t,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[i],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"1db5ce5523fa9a472c91d093b0e6160e",id:null,metadata:{},name:"ExperimentsTableQuery",operationKind:"query",text:`query ExperimentsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...ExperimentsTableFragment_2HEEH6
    __isNode: __typename
    id
  }
}

fragment ExperimentsTableFragment_2HEEH6 on Dataset {
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: $first, after: $after) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        averageRunLatencyMs
        project {
          id
        }
        annotationSummaries {
          annotationName
          meanScore
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();js.hash="c7c7580fe40888ceb86a1701fe4eedf4";const qs=function(){var n=["experiments"],a={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:js,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExperimentsTableFragment",selections:[{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:"experiments",args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"__ExperimentsTable_experiments_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},t],type:"Dataset",abstractKey:null}}();qs.hash="c7c7580fe40888ceb86a1701fe4eedf4";function Wy({getValue:n}){const a=n(),t=a!==null?a*100:null,l=u.useMemo(()=>{if(t!==null)return t>=80?"red-1100":t>0?"orange-1100":"green-1100"},[t]);return e(x,{color:l,children:yt(t)})}const Us=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ExperimentMutationPayload",kind:"LinkedField",name:"deleteExperiments",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a},params:{cacheID:"3af24cbaf3208c0d5ad1cd9313dd3823",id:null,metadata:{},name:"ExperimentSelectionToolbarDeleteExperimentsMutation",operationKind:"mutation",text:`mutation ExperimentSelectionToolbarDeleteExperimentsMutation(
  $input: DeleteExperimentsInput!
) {
  deleteExperiments(input: $input) {
    __typename
  }
}
`}}}();Us.hash="4ab310746eb51c6a3fcb799d2c972762";function Jy(n){const a=X(),[t,l]=u.useState(null),[i,r]=D.useMutation(Us),{datasetId:s,selectedExperiments:c,onClearSelection:d,onExperimentsDeleted:m}=n,y=c.length!==1,g=xe(),p=ve(),f=u.useCallback(()=>{i({variables:{input:{experimentIds:c.map(b=>b.id)}},onCompleted:()=>{g({title:"Examples Deleted",message:`${c.length} experiment${y?"s":""} have been deleted.`}),m(),d()},onError:b=>{p({title:"An error occurred",message:`Failed to delete examples: ${b.message}`})}})},[i,y,p,g,d,m,c]),k=u.useCallback(()=>{l(o(Z,{size:"S",title:"Delete Experiments",children:[e(K,{padding:"size-200",children:e(x,{color:"danger",children:"Are you sure you want to delete these experiments? This will also delete all associated annotations and traces, and it cannot be undone."})}),e(K,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(h,{direction:"row",justifyContent:"end",children:e(z,{variant:"danger",onClick:()=>{f(),l(null)},children:"Delete Experiments"})})})]}))},[f]);return o("div",{css:C`
        position: absolute;
        bottom: var(--ac-global-dimension-size-400);
        left: 50%;
        transform: translateX(-50%);
      `,children:[e(K,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:o(h,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(x,{children:`${c.length} experiment${y?"s":""} selected`}),o(h,{direction:"row",gap:"size-100",children:[e(z,{variant:"default",size:"compact",onClick:d,children:"Cancel"}),e(z,{variant:"danger",size:"compact",icon:e(L,{svg:e(I.TrashOutline,{})}),loading:r,disabled:r,onClick:k,children:r?"Deleting...":"Delete"}),e(z,{variant:"primary",size:"compact",onClick:()=>{a(`/datasets/${s}/compare?${c.map(b=>`experimentId=${b.id}`).join("&")}`)},icon:e(L,{svg:e(I.ArrowCompareOutline,{})}),children:"Compare Experiments"})]})]})}),e(ee,{onDismiss:()=>{l(null)},children:t})]})}const Zy=100;function Yy(){return e("tbody",{className:"is-empty",children:e("tr",{children:o("td",{colSpan:100,css:C`
            text-align: center;
            padding: var(--ac-global-dimension-size-400) !important;
            .ac-button {
              margin-top: var(--ac-global-dimension-size-200);
              margin-left: auto;
              margin-right: auto;
            }
          `,children:["No experiments for this dataset. To see how to run experiments on a dataset, check out the documentation.",e(Ms,{})]})})})}function Xy({dataset:n}){const a=u.useRef(null),[t,l]=u.useState({}),{data:i,loadNext:r,hasNext:s,isLoadingNext:c,refetch:d}=D.usePaginationFragment(qs,n),m=u.useMemo(()=>i.experiments.edges.map(F=>{const T=F.experiment.annotationSummaries.reduce((w,_)=>(w[_.annotationName]=_,w),{});return{...F.experiment,annotationSummaryMap:T}}),[i.experiments.edges]),y=[{id:"select",header:({table:F})=>e(fn,{checked:F.getIsAllRowsSelected(),indeterminate:F.getIsSomeRowsSelected(),onChange:F.getToggleAllRowsSelectedHandler()}),cell:({row:F})=>e(fn,{checked:F.getIsSelected(),disabled:!F.getCanSelect(),indeterminate:F.getIsSomeSelected(),onChange:F.getToggleSelectedHandler()})},{header:"name",accessorKey:"name",minSize:200,cell:({getValue:F,row:T})=>{const w=T.original.id,_=T.original.sequenceNumber;return o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Ga,{sequenceNumber:_}),e(Ge,{to:`/datasets/${n.id}/compare?experimentId=${w}`,children:F()})]})}},{header:"description",accessorKey:"description",minSize:300,cell:fe},{header:"created at",accessorKey:"createdAt",cell:Ee}],g=i.experimentAnnotationSummaries.map(F=>{const{annotationName:T,minScore:w,maxScore:_}=F;return{header:()=>o(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",justifyContent:"end",children:[e(x,{children:T}),e(xc,{annotationName:T})]}),id:`annotation-${T}`,meta:{textAlign:"right"},cell:({row:Q})=>{const V=Q.original.annotationSummaryMap[T];return!V||V.meanScore==null?e("span",{css:C`
                  float: right;
                `,children:"--"}):e(ef,{annotationName:T,value:V.meanScore,min:w,max:_})}}}),p=[{header:"run count",accessorKey:"runCount",meta:{textAlign:"right"},cell:Yl},{header:"avg latency",accessorKey:"averageRunLatencyMs",meta:{textAlign:"right"},cell:({getValue:F})=>{const T=F();return T===null||typeof T!="number"?"--":e(Ce,{latencyMs:T})}},{header:"error rate",accessorKey:"errorRate",meta:{textAlign:"right"},cell:Wy},{header:"metadata",accessorKey:"metadata",minSize:200,cell:Wn},{id:"actions",cell:({row:F})=>{const T=F.original.project,w=F.original.metadata;return e(li,{projectId:(T==null?void 0:T.id)||null,experimentId:F.original.id,metadata:w})}}],f=Fe({columns:[...y,...g,...p],data:m,getCoreRowModel:Ke(),state:{rowSelection:t},onRowSelectionChange:l}),k=f.getRowModel().rows,b=f.getSelectedRowModel().rows,S=b.map(F=>F.original),v=u.useCallback(()=>{l({})},[l]),P=k.length===0,E=u.useCallback(F=>{if(F){const{scrollHeight:T,scrollTop:w,clientHeight:_}=F;T-w-_<300&&!c&&s&&r(Zy)}},[s,c,r]),R=X();return o("div",{css:C`
        flex: 1 1 auto;
        overflow: auto;
        width: table.getTotalSize();
      `,ref:a,onScroll:F=>E(F.target),children:[o("table",{css:$n,children:[e("thead",{children:f.getHeaderGroups().map(F=>e("tr",{children:F.headers.map(T=>{var w,_;return e("th",{align:(_=(w=T.column.columnDef)==null?void 0:w.meta)==null?void 0:_.textAlign,children:e("div",{children:J(T.column.columnDef.header,T.getContext())})},T.id)})},F.id))}),P?e(Yy,{}):e("tbody",{children:k.map(F=>e("tr",{onClick:()=>{R(`/datasets/${n.id}/compare?experimentId=${F.original.id}`)},children:F.getVisibleCells().map(T=>e("td",{children:J(T.column.columnDef.cell,T.getContext())},T.id))},F.id))})]}),b.length?e(Jy,{datasetId:n.id,selectedExperiments:S,onClearSelection:v,onExperimentsDeleted:()=>{d({},{fetchPolicy:"store-and-network"})}}):null]})}function ef({annotationName:n,value:a,min:t,max:l}){const i=Jl(n),r=u.useMemo(()=>{const s=typeof t=="number"?t:0,c=typeof l=="number"?l:1;if(s===c&&c===a)return 100;const d=c-s||1;return(a-s)/d*100},[a,t,l]);return o(pe,{children:[e(je,{children:o("div",{css:C`
            float: right;
            --mod-barloader-fill-color: ${i};
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: var(--ac-global-dimension-size-100);
          `,children:[Gn(a),e(Cd,{width:"40px",value:r,"aria-label":"where the mean score lands between overall min max"})]})}),e(Ca,{children:o(K,{width:"size-2400",children:[e(ce,{level:3,weight:"heavy",children:n}),o(h,{direction:"column",children:[o(h,{justifyContent:"space-between",children:[e(x,{weight:"heavy",textSize:"small",children:"Mean Score"}),e(x,{textSize:"small",children:Gn(a)})]}),o(h,{justifyContent:"space-between",children:[e(x,{weight:"heavy",textSize:"small",children:"All Experiments Min"}),e(x,{textSize:"small",children:Gn(t)})]}),o(h,{justifyContent:"space-between",children:[e(x,{weight:"heavy",textSize:"small",children:"All Experiments Max"}),e(x,{textSize:"small",children:Gn(l)})]}),o(h,{justifyContent:"space-between",children:[e(x,{weight:"heavy",textSize:"small",children:"Mean Score Percentile"}),e(x,{textSize:"small",children:Zl(r)})]})]})]})})]})}function n1(){const n=kn();return o(G,{children:[e(Xy,{dataset:n.dataset}),e(u.Suspense,{children:e(Oe,{})})]})}const Bs=function(){var n={defaultValue:null,kind:"LocalArgument",name:"datasetId"},a={defaultValue:null,kind:"LocalArgument",name:"experimentIds"},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:"comparisons",args:[{kind:"Variable",name:"experimentIds",variableName:"experimentIds"}],concreteType:"ExperimentComparison",kind:"LinkedField",name:"compareExperiments",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[t,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RunComparisonItem",kind:"LinkedField",name:"runComparisonItems",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},l,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},l],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},s=[{kind:"Variable",name:"id",variableName:"datasetId"}],c={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ExperimentCompareTableQuery",selections:[r,{alias:"dataset",args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ExperimentCompareTableQuery",selections:[r,{alias:"dataset",args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,c],storageKey:null}]},params:{cacheID:"e8b3f1f7011d0059ded7076b4d83afea",id:null,metadata:{},name:"ExperimentCompareTableQuery",operationKind:"query",text:`query ExperimentCompareTableQuery(
  $experimentIds: [GlobalID!]!
  $datasetId: GlobalID!
) {
  comparisons: compareExperiments(experimentIds: $experimentIds) {
    example {
      id
      revision {
        input
        referenceOutput: output
      }
    }
    runComparisonItems {
      experimentId
      runs {
        output
        error
        startTime
        endTime
        trace {
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              score
              label
              annotatorKind
              explanation
              trace {
                traceId
                projectId
              }
            }
          }
        }
      }
    }
  }
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      experiments {
        edges {
          experiment: node {
            id
            name
            sequenceNumber
            metadata
            project {
              id
            }
          }
        }
      }
    }
  }
}
`}}}();Bs.hash="7e1c83a2fa6f2f46532902b526017663";const mt={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}},nf=C`
  flex: 1 1 auto;
  overflow: auto;
  // Make sure the table fills up the remaining space
  table {
    min-width: 100%;
    td {
      vertical-align: top;
    }
  }
`,af=C`
  display: flex;
  flex-direction: row;
  align-items: center;
  color: var(--ac-global-color-primary);
  gap: var(--ac-global-dimension-size-50);
`;function tf(n){const{datasetId:a,experimentIds:t,displayFullText:l}=n,i=D.useLazyLoadQuery(Bs,{experimentIds:t,datasetId:a}),r=u.useMemo(()=>{var S,v;return((v=(S=i.dataset)==null?void 0:S.experiments)==null?void 0:v.edges.reduce((P,E)=>{var R,F;return P[E.experiment.id]={...E.experiment,projectId:((F=(R=E.experiment)==null?void 0:R.project)==null?void 0:F.id)||null},P},{}))||{}},[i]),s=u.useMemo(()=>i.comparisons.map(S=>{const v=S.runComparisonItems.reduce((P,E)=>(P[E.experimentId]=E,P),{});return{...S,id:S.example.id,input:S.example.revision.input,referenceOutput:S.example.revision.referenceOutput,runComparisonMap:v}}),[i]),[c,d]=u.useState(null),m=u.useMemo(()=>[{header:"input",accessorKey:"input",minWidth:500,cell:({row:S})=>e(el,{controls:o(pe,{children:[e(z,{variant:"default",size:"compact","aria-label":"View example details",icon:e(L,{svg:e(I.ExpandOutline,{})}),onClick:()=>{u.startTransition(()=>{d(e(u.Suspense,{children:e($t,{exampleId:S.original.example.id,onDismiss:()=>{d(null)}})}))})}}),e(Ie,{children:"View Example"})]}),children:e(jt,{children:e(Ka,{json:S.original.input,disableTitle:!0,space:l?2:0})})})},{header:"reference output",accessorKey:"referenceOutput",minWidth:500,cell:l?of:Wn}],[l]),y=u.useMemo(()=>t.map(S=>({header:()=>{var F,T,w,_;const v=(F=r[S])==null?void 0:F.name,P=(T=r[S])==null?void 0:T.metadata,E=(w=r[S])==null?void 0:w.projectId,R=((_=r[S])==null?void 0:_.sequenceNumber)||0;return o(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",justifyContent:"space-between",children:[o(h,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",children:[e(Ga,{sequenceNumber:R}),e(x,{children:v})]}),e(li,{experimentId:S,metadata:P,isQuiet:!0,projectId:E})]})},accessorKey:S,minSize:500,cell:({row:v})=>{var Q,V;const P=v.original.runComparisonMap[S],E=(P==null?void 0:P.runs.length)||0;if(E===0)return e(fl,{});if(E>1)return e(x,{color:"warning",children:`${E} runs`});const R=P==null?void 0:P.runs[0];let F=null;const T=(Q=R==null?void 0:R.trace)==null?void 0:Q.traceId,w=(V=R==null?void 0:R.trace)==null?void 0:V.projectId;T&&w&&(F=o(pe,{children:[e(z,{variant:"default",className:"trace-button",size:"compact","aria-label":"View run trace",icon:e(L,{svg:e(I.Trace,{})}),onClick:H=>{H.preventDefault(),H.stopPropagation(),u.startTransition(()=>{d(e(Js,{traceId:T,projectId:w,title:"Experiment Run Trace"}))})}}),e(Ie,{children:"View Trace"})]}));const _=o(G,{children:[o(pe,{children:[e(z,{variant:"default",className:"expand-button",size:"compact","aria-label":"View example run details",icon:e(L,{svg:e(I.ExpandOutline,{})}),onClick:H=>{H.preventDefault(),H.stopPropagation(),u.startTransition(()=>{d(e(df,{selectedExample:v.original,datasetId:a,experimentInfoById:r}))})}}),e(Ie,{children:"View run details"})]}),F]});return R?e(el,{controls:_,children:e(sf,{...R,displayFullText:l,setDialog:d})}):e(fl,{})}})),[t,r,a,l]),g=u.useMemo(()=>[...m,...y,{id:"tail",minSize:500}],[m,y]),p=Fe({columns:g,data:s,getCoreRowModel:Ke(),columnResizeMode:"onChange"}),f=Se.useMemo(()=>{const S=p.getFlatHeaders(),v={};for(let P=0;P<S.length;P++){const E=S[P];v[`--header-${E.id}-size`]=E.getSize(),v[`--col-${E.column.id}-size`]=E.column.getSize()}return v},[p.getState().columnSizingInfo,p.getState().columnSizing]),b=p.getRowModel().rows.length===0;return o("div",{css:nf,children:[o("table",{css:S=>C(nn(S),ii),style:{...f,width:p.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:p.getHeaderGroups().map(S=>e("tr",{children:S.headers.map(v=>o("th",{style:{width:`calc(var(--header-${v==null?void 0:v.id}-size) * 1px)`},children:[e("div",{children:J(v.column.columnDef.header,v.getContext())}),e("div",{onMouseDown:v.getResizeHandler(),onTouchStart:v.getResizeHandler(),className:`resizer ${v.column.getIsResizing()?"isResizing":""}`})]},v.id))},S.id))}),b?e(an,{}):p.getState().columnSizingInfo.isResizingColumn?e(lf,{table:p}):e(Hs,{table:p})]}),e(ee,{isDismissable:!0,type:"slideOver",onDismiss:()=>{d(null)},children:c})]})}function Hs({table:n}){return e("tbody",{children:n.getRowModel().rows.map(a=>e("tr",{children:a.getVisibleCells().map(t=>e("td",{style:{width:`calc(var(--col-${t.column.id}-size) * 1px)`},children:J(t.column.columnDef.cell,t.getContext())},t.id))},a.id))})}const lf=Se.memo(Hs,(n,a)=>n.table.options.data===a.table.options.data);function rf(n){const{datasetId:a,exampleId:t}=n,l=X();return e("div",{onClick:i=>{i.preventDefault(),i.stopPropagation()},children:e(Nn,{buttonSize:"compact",align:"end",onAction:i=>{switch(i){case"gotoExample":return l(`/datasets/${a}/examples/${t}`);default:me()}},children:e(le,{children:o(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(I.ExternalLinkOutline,{})}),e(x,{children:"Go to example"})]})},"gotoExample")})})}function sf(n){const{output:a,error:t,startTime:l,endTime:i,annotations:r,displayFullText:s,setDialog:c}=n;if(t)return e(Gs,{error:t});const d=r!=null&&r.edges.length?r.edges.map(m=>m.annotation):[];return o(h,{direction:"column",gap:"size-100",height:"100%",justifyContent:"space-between",children:[e(jt,{children:e(Ka,{json:a,disableTitle:!0,space:s?2:0})}),o("ul",{css:C`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-static-size-100);
          align-items: center;
          flex-wrap: wrap;
        `,children:[e("li",{children:e(Ws,{startTime:l,endTime:i})},"run-latency"),d.map(m=>e("li",{children:e(ea,{annotation:m,extra:m.trace&&e(K,{paddingTop:"size-100",children:o("div",{css:af,children:[e(L,{svg:e(I.InfoOutline,{})}),e("span",{children:"Click to view evaluator trace"})]})}),children:e(un,{annotation:m,onClick:()=>{const y=m.trace;y&&u.startTransition(()=>{c(e(Js,{traceId:y.traceId,projectId:y.projectId,title:`Evaluator Trace: ${m.name}`}))})}})})},m.id))]})]})}function Gs({error:n}){return o(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(I.AlertCircleOutline,{}),color:"danger"}),e(x,{color:"danger",children:n})]})}function Ws({startTime:n,endTime:a}){const t=u.useMemo(()=>{let l=null;return n&&a&&(l=new Date(a).getTime()-new Date(n).getTime()),l},[n,a]);return t===null?null:e(Ce,{latencyMs:t})}function fl(){return o(h,{direction:"row",gap:"size-50",children:[e(L,{svg:e(I.MinusCircleOutline,{}),color:"grey-800"}),e(x,{color:"text-700",children:"not run"})]})}function of({getValue:n}){const a=n();return e(jt,{children:e(Ka,{json:a,space:2})})}function jt({children:n}){return e("div",{css:C`
        max-height: 300px;
        overflow-y: auto;
      `,children:n})}function df({selectedExample:n,datasetId:a,experimentInfoById:t}){return e(Z,{title:`Comparing Experiments for Example: ${n.id}`,size:"fullscreen",extra:e(rf,{datasetId:a,exampleId:n.id}),children:o(on,{direction:"vertical",autoSaveId:"example-compare-panel-group",children:[e(ke,{defaultSize:100,children:e("div",{css:C`
              overflow-y: auto;
              height: 100%;
            `,children:e(K,{overflow:"hidden",padding:"size-200",children:o(h,{direction:"row",gap:"size-200",flex:"1 1 auto",children:[e(K,{width:"50%",children:e(q,{title:"Input",...mt,bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},extra:e(se,{text:JSON.stringify(n.input)}),children:e(rn,{value:JSON.stringify(n.input,null,2)})})}),e(K,{width:"50%",children:e(q,{title:"Reference Output",...mt,extra:e(se,{text:JSON.stringify(n.referenceOutput)}),bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},children:e(rn,{value:JSON.stringify(n.referenceOutput,null,2)})})})]})})})}),e(sn,{css:bn}),e(ke,{defaultSize:200,children:o(h,{direction:"column",height:"100%",children:[e(K,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(ce,{level:2,children:"Experiments"})}),e("div",{css:C`
                overflow-y: auto;
                height: 100%;
                padding: var(--ac-global-dimension-static-size-200);
              `,children:e("ul",{css:C`
                  display: flex;
                  flex-direction: column;
                  gap: var(--ac-global-dimension-static-size-200);
                `,children:n.runComparisonItems.map(l=>{const i=t[l.experimentId];return e("li",{children:e(q,{...mt,title:i==null?void 0:i.name,titleExtra:e(Ga,{sequenceNumber:(i==null?void 0:i.sequenceNumber)||0}),children:e("ul",{children:l.runs.map((r,s)=>{var c;return e("li",{children:o(h,{direction:"row",children:[e(K,{flex:!0,children:r.error?e(K,{padding:"size-200",children:e(Gs,{error:r.error})}):e(rn,{value:JSON.stringify(r.output,null,2)})}),o(Dn,{width:"size-3000",children:[e(Ws,{startTime:r.startTime,endTime:r.endTime}),e("ul",{css:C`
                                      margin-top: var(
                                        --ac-global-dimension-static-size-100
                                      );
                                      display: flex;
                                      flex-direction: column;
                                      justify-content: flex-start;
                                      align-items: flex-end;
                                      gap: var(
                                        --ac-global-dimension-static-size-100
                                      );
                                    `,children:(c=r.annotations)==null?void 0:c.edges.map(d=>e("li",{children:e(un,{annotation:d.annotation})},d.annotation.id))})]})]})},s)})})})},l.experimentId)})})})]})})]})})}function Js({traceId:n,projectId:a,title:t}){const l=X();return e(Z,{title:t,size:"fullscreen",extra:e(z,{variant:"default",onClick:()=>l(`/projects/${a}/traces/${n}`),children:"View Trace in Project"}),children:e(Ot,{traceId:n,projectId:a})})}const Zs={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExperimentMultiSelector__experiments",selections:[{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null};Zs.hash="1aa376b1e9425f49268ac231dc2c0412";function cf(n){const{dataset:a,selectedExperimentIds:t,onChange:l,label:i,validationState:r,description:s,errorMessage:c,...d}=n,m=D.useFragment(Zs,a),y=u.useMemo(()=>m.experiments.edges.map(f=>f.experiment),[m]),g=y.length===0,p=u.useMemo(()=>{if(g)return"No experiments";const f=t.length;return f>0?`${f} experiment${f>1?"s":""}`:"No experiments selected"},[t,g]);return e(Vn,{label:i,isDisabled:g,validationState:r,description:s,errorMessage:c,children:e(Kt,{isDisabled:g,...d,menu:e(Qa,{selectionMode:"multiple",onSelectionChange:f=>{l(Array.from(f))},selectedKeys:new Set(t),children:y.map(f=>e(le,{textValue:f.name,children:o(h,{direction:"column",gap:"size-50",children:[o(h,{direction:"row",gap:"size-100",children:[e(Ga,{sequenceNumber:f.sequenceNumber}),e(x,{children:f.name})]}),e(x,{textSize:"small",color:"text-700",children:new Date(f.createdAt).toLocaleString()})]})},f.id))}),triggerProps:{placement:"bottom start"},children:p})})}function a1(){const n=kn(),[a,t]=u.useState(!1),[l,i]=Sa(),r=l.getAll("experimentId"),s=r.length>0;return o("main",{css:C`
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(K,{padding:"size-200",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:o(h,{direction:"column",gap:"size-100",children:[e(ce,{level:1,children:"Compare Experiments"}),o(h,{direction:"row",justifyContent:"space-between",alignItems:"end",children:[e(cf,{dataset:n.dataset,selectedExperimentIds:r,label:"experiments",onChange:c=>{u.startTransition(()=>{l.delete("experimentId"),c.forEach(d=>{l.append("experimentId",d)}),i(l)})}}),e(Xn,{onChange:c=>{t(c)},defaultSelected:!1,labelPlacement:"start",children:"Full Text"})]})]})}),s?e(u.Suspense,{fallback:e(ye,{}),children:e(tf,{datasetId:n.dataset.id,experimentIds:r,displayFullText:a})}):e(K,{padding:"size-200",children:e(ue,{variant:"info",title:"No Experiment Selected",children:"Please select one or more experiments."})})]})}const Ys=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"experimentCompareLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[l,{args:null,kind:"FragmentSpread",name:"ExperimentMultiSelector__experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"experimentCompareLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"InlineFragment",selections:[l,{alias:null,args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"7e89f99f940098a21985137aae870de7",id:null,metadata:{},name:"experimentCompareLoaderQuery",operationKind:"query",text:`query experimentCompareLoaderQuery(
  $id: GlobalID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      name
      ...ExperimentMultiSelector__experiments
    }
  }
}

fragment ExperimentMultiSelector__experiments on Dataset {
  experiments {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        createdAt
      }
    }
  }
}
`}}}();Ys.hash="fa02088830fd16688f0f2fba9a0009eb";async function t1(n){const{datasetId:a}=n.params;return await D.fetchQuery(Me,Ys,{id:a}).toPromise()}const Xs=function(){var n={defaultValue:null,kind:"LocalArgument",name:"description"},a={defaultValue:null,kind:"LocalArgument",name:"expiresAt"},t={defaultValue:null,kind:"LocalArgument",name:"name"},l=[{fields:[{kind:"Variable",name:"description",variableName:"description"},{kind:"Variable",name:"expiresAt",variableName:"expiresAt"},{kind:"Variable",name:"name",variableName:"name"}],kind:"ObjectValue",name:"input"}],i={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[r],storageKey:null};return{fragment:{argumentDefinitions:[n,a,t],kind:"Fragment",metadata:null,name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:l,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],storageKey:null},s],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,n,a],kind:"Operation",name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:l,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],storageKey:null},s],storageKey:null}]},params:{cacheID:"799e8f0a627c6ae06e2a87c051d299d0",id:null,metadata:{},name:"APIKeysCardCreateSystemAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysCardCreateSystemAPIKeyMutation(
  $name: String!
  $description: String = null
  $expiresAt: DateTime = null
) {
  createSystemApiKey(input: {name: $name, description: $description, expiresAt: $expiresAt}) {
    jwt
    query {
      ...SystemAPIKeysTableFragment
    }
    apiKey {
      id
    }
  }
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}
`}}}();Xs.hash="a6f84fa9e14f363d2e7317d3d6507590";const eo=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"APIKeysCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"},{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"APIKeysCardQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[n,a,t,l,i],storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[n,a,t,l,i,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"a8cfba9eaaac34bc497efaacbff45c05",id:null,metadata:{},name:"APIKeysCardQuery",operationKind:"query",text:`query APIKeysCardQuery {
  ...SystemAPIKeysTableFragment
  ...UserAPIKeysTableFragment
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}}}();eo.hash="ad967afd45af0d5976982c70eaadb330";const no=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteSystemApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"a8c45c42b5becca8efa65334285a2f97",id:null,metadata:{},name:"SystemAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation SystemAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteSystemApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}}();no.hash="55ab8200b5bfda0aa73594ad5cfce96f";const ao={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SystemAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SystemAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}]},params:{cacheID:"94e06b8cd5879701a5d73bee083ad614",id:null,metadata:{},name:"SystemAPIKeysTableQuery",operationKind:"query",text:`query SystemAPIKeysTableQuery {
  ...SystemAPIKeysTableFragment
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
}
`}};ao.hash="de0fc04de739f0adfcbdeaff28b16265";const to={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:ao}},name:"SystemAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};to.hash="de0fc04de739f0adfcbdeaff28b16265";function uf({query:n}){const[a,t]=D.useRefetchableFragment(to,n),l=ve(),i=xe(),[r]=D.useMutation(no),s=u.useCallback(p=>{r({variables:{input:{id:p}},onCompleted:()=>{i({title:"System key deleted",message:"The system key has been deleted and is no longer active."}),u.startTransition(()=>{t({},{fetchPolicy:"network-only"})})},onError:f=>{l({title:"Error deleting system key",message:f.message})}})},[r,l,i,t]),c=u.useMemo(()=>[...a.systemApiKeys],[a]),d=u.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:fe},{header:"Created At",accessorKey:"createdAt",cell:Ee},{header:"Expires At",accessorKey:"expiresAt",cell:Ee},{header:"",accessorKey:"id",size:10,cell:({row:f})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(_t,{handleDelete:()=>{s(f.original.id)}})}),meta:{textAlign:"right"}}],[s]),m=Fe({columns:d,data:c,getCoreRowModel:Ke()}),y=m.getRowModel().rows,g=m.getRowModel().rows.length===0;return o("table",{css:nn,children:[e("thead",{children:m.getHeaderGroups().map(p=>e("tr",{children:p.headers.map(f=>e("th",{colSpan:f.colSpan,children:f.isPlaceholder?null:o("div",{className:f.column.getCanSort()?"cursor-pointer":"",onClick:f.column.getToggleSortingHandler(),style:{left:f.getStart(),width:f.getSize()},children:[J(f.column.columnDef.header,f.getContext()),f.column.getIsSorted()?e(L,{className:"sort-icon",svg:f.column.getIsSorted()==="asc"?e(I.ArrowUpFilled,{}):e(I.ArrowDownFilled,{})}):null]})},f.id))},p.id))}),g?e(an,{message:"No Keys"}):e("tbody",{children:y.map(p=>e("tr",{children:p.getVisibleCells().map(f=>e("td",{children:J(f.column.columnDef.cell,f.getContext())},f.id))},p.id))})]})}const lo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"d137498515ff43864f5525b3c1847376",id:null,metadata:{},name:"UserAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation UserAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}}();lo.hash="9b1d898d1d9858016bed85000ce3906e";const io={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UserAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"e70d413b072841dff8565a332590a549",id:null,metadata:{},name:"UserAPIKeysTableQuery",operationKind:"query",text:`query UserAPIKeysTableQuery {
  ...UserAPIKeysTableFragment
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}};io.hash="c2b3a579bcb0ba915523ecb35cae3b44";const ro={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:io}},name:"UserAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};ro.hash="c2b3a579bcb0ba915523ecb35cae3b44";const hl=70;function mf({query:n}){const[a,t]=D.useRefetchableFragment(ro,n),l=ve(),i=xe(),[r]=D.useMutation(lo),s=u.useCallback(p=>{r({variables:{input:{id:p}},onCompleted:()=>{i({title:"User key deleted",message:"The user key has been deleted and is no longer active."}),u.startTransition(()=>{t({},{fetchPolicy:"network-only"})})},onError:f=>{l({title:"Error deleting user key",message:f.message})}})},[r,l,i,t]),c=u.useMemo(()=>[...a.userApiKeys],[a]),d=u.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:fe},{header:"Description",accessorKey:"description",cell:fe},{header:"Created At",accessorKey:"createdAt",size:hl,cell:Ee},{header:"Expires At",accessorKey:"expiresAt",size:hl,cell:Ee},{header:"User",size:120,accessorKey:"user.email",cell:fe},{header:"",accessorKey:"id",size:10,cell:({row:f})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(_t,{handleDelete:()=>{s(f.original.id)}})}),meta:{textAlign:"right"}}],[s]),m=Fe({columns:d,data:c,getCoreRowModel:Ke()}),y=m.getRowModel().rows,g=m.getRowModel().rows.length===0;return o("table",{css:nn,children:[e("thead",{children:m.getHeaderGroups().map(p=>e("tr",{children:p.headers.map(f=>e("th",{colSpan:f.colSpan,children:f.isPlaceholder?null:o("div",{className:f.column.getCanSort()?"cursor-pointer":"",onClick:f.column.getToggleSortingHandler(),style:{left:f.getStart(),width:f.getSize()},children:[J(f.column.columnDef.header,f.getContext()),f.column.getIsSorted()?e(L,{className:"sort-icon",svg:f.column.getIsSorted()==="asc"?e(I.ArrowUpFilled,{}):e(I.ArrowDownFilled,{})}):null]})},f.id))},p.id))}),g?e(an,{message:"No Keys"}):e("tbody",{children:y.map(p=>e("tr",{children:p.getVisibleCells().map(f=>e("td",{children:J(f.column.columnDef.cell,f.getContext())},f.id))},p.id))})]})}function gf(){const n=D.useLazyLoadQuery(eo,{},{fetchPolicy:"network-only"});return o(Qe,{children:[e(ne,{title:"System Keys",name:"System Keys",children:e(uf,{query:n})}),e(ne,{title:"User Keys",name:"User Keys",children:e(mf,{query:n})})]})}function pf(){const[n,a]=u.useState(null),t=ve(),l=d=>{a(e(ri,{jwt:d}))},[i,r]=D.useMutation(Xs),s=u.useCallback(d=>{i({variables:{...d,expiresAt:d.expiresAt||null},onCompleted:m=>{l(m.createSystemApiKey.jwt)},onError:m=>{t({title:"Error creating system key",message:m.message})}})},[i,t]),c=()=>{a(e(si,{onSubmit:s,isCommitting:r,defaultName:"System"}))};return o("div",{children:[e(Ct,{title:"API Keys",variant:"compact",extra:e(z,{variant:"default",size:"compact",icon:e(L,{svg:e(I.PlusCircleOutline,{})}),onClick:c,children:"System Key"}),children:e(u.Suspense,{fallback:e(K,{padding:"size-100",children:e(ye,{})}),children:e(gf,{})})}),e(ee,{onDismiss:()=>{a(null)},children:n})]})}const so={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsersCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UsersCardQuery",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"926faf98cad4bc437a919677347e277c",id:null,metadata:{},name:"UsersCardQuery",operationKind:"query",text:`query UsersCardQuery {
  ...UsersTable_users
}

fragment UsersTable_users on Query {
  users {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
        }
      }
    }
  }
}
`}};so.hash="2b3e260c950dd1a6a1a6883ff6fb78c4";const oo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"createUser",plural:!1,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"NewUserDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"NewUserDialogMutation",selections:a},params:{cacheID:"a9bf3794a5355d9d0e0a3acebe7f3809",id:null,metadata:{},name:"NewUserDialogMutation",operationKind:"mutation",text:`mutation NewUserDialogMutation(
  $input: CreateUserInput!
) {
  createUser(input: $input) {
    user {
      id
      email
    }
  }
}
`}}}();oo.hash="97d1aefa41e8831e57b6bb0d1a078a7c";function yf({onNewUserCreated:n,onNewUserCreationError:a,onDismiss:t}){const[l,i]=D.useMutation(oo),r=u.useCallback(s=>{l({variables:{input:{email:s.email,username:s.username,password:s.password,role:s.role}},onCompleted:c=>{n(c.createUser.user.email)},onError:c=>{a(c)}})},[l,n,a]);return e(ee,{onDismiss:t,isDismissable:!0,type:"modal",isKeyboardDismissDisabled:!0,children:e(Z,{title:"Add user",children:e(Tc,{onSubmit:r,isSubmitting:i})})})}const co={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsersTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UsersTableQuery",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"d3f85064b63f026a47a8ef139638b933",id:null,metadata:{},name:"UsersTableQuery",operationKind:"query",text:`query UsersTableQuery {
  ...UsersTable_users
}

fragment UsersTable_users on Query {
  users {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
        }
      }
    }
  }
}
`}};co.hash="acd5e44c43deb927fea733697593c97d";const uo={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:co}},name:"UsersTable_users",selections:[{alias:null,args:null,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};uo.hash="acd5e44c43deb927fea733697593c97d";const mo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],kind:"ScalarField",name:"deleteUsers",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeleteUserDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeleteUserDialogMutation",selections:a},params:{cacheID:"00d3d0f3855e92e529bc446d0f426123",id:null,metadata:{},name:"DeleteUserDialogMutation",operationKind:"mutation",text:`mutation DeleteUserDialogMutation(
  $input: DeleteUsersInput!
) {
  deleteUsers(input: $input)
}
`}}}();mo.hash="a718ceab0ec0a7d461f6cd5e5b178a1f";function ff({userId:n,onDeleted:a,onClose:t}){const[l,i]=D.useMutation(mo),r=xe(),s=ve(),c=u.useCallback(()=>{l({variables:{input:{userIds:[n]}},onCompleted:()=>{r({title:"User deleted",message:"User has been deleted."}),a(),t()},onError:d=>{s({title:"Failed to delete user",message:d.message})}})},[l,s,r,t,a,n]);return o(Z,{title:"Delete User",isDismissable:!0,onDismiss:t,children:[e(K,{padding:"size-200",children:e(x,{color:"danger",children:"Are you sure you want to delete this user? This action cannot be undone."})}),e(K,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(z,{variant:"default",onClick:t,children:"Cancel"}),e(z,{variant:"danger",onClick:()=>{c()},disabled:i,children:"Delete user"})]})})]})}const go=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordDialogMutation",selections:a},params:{cacheID:"6ccff8dd53d97eeb41f656bcd2758da1",id:null,metadata:{},name:"ResetPasswordDialogMutation",operationKind:"mutation",text:`mutation ResetPasswordDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    __typename
  }
}
`}}}();go.hash="85b22da61ec094c28e97db2759622b69";const ua=4;function hf({userId:n,onClose:a}){const t=ve(),l=xe(),[i,r]=D.useMutation(go),{control:s,handleSubmit:c,formState:{isDirty:d}}=Ue({defaultValues:{newPassword:"",confirmPassword:""}}),m=u.useCallback(y=>{i({variables:{input:{userId:n,newPassword:y.newPassword}},onCompleted:()=>{l({title:"Password reset",message:"Users password has been reset."}),a()},onError:g=>{t({title:"Failed to reset password",message:g.message})}})},[i,t,l,a,n]);return e(Z,{title:"Reset Password",isDismissable:!0,onDismiss:a,children:e(Re,{children:o(K,{padding:"size-200",children:[e(W,{name:"newPassword",control:s,rules:{required:"Password is required",minLength:{value:ua,message:`Password must be at least ${ua} characters`}},render:({field:{name:y,onChange:g,onBlur:p,value:f},fieldState:{invalid:k,error:b}})=>e(ae,{label:"New Password",type:"password",isRequired:!0,description:`Password must be at least ${ua} characters`,name:y,errorMessage:b==null?void 0:b.message,validationState:k?"invalid":"valid",onChange:g,onBlur:p,defaultValue:f})}),e(W,{name:"confirmPassword",control:s,rules:{required:"Password is required",minLength:{value:ua,message:`Password must be at least ${ua} characters`},validate:(y,g)=>y===g.newPassword||"Passwords do not match"},render:({field:{name:y,onChange:g,onBlur:p,value:f},fieldState:{invalid:k,error:b}})=>e(ae,{label:"Confirm Password",isRequired:!0,type:"password",description:"Confirm the new password",name:y,errorMessage:b==null?void 0:b.message,validationState:k?"invalid":"valid",onChange:g,onBlur:p,defaultValue:f})}),e(K,{paddingTop:"size-200",children:e(h,{direction:"row",gap:"size-100",justifyContent:"end",children:e(z,{variant:d?"primary":"default",type:"submit",disabled:r,onClick:c(m),children:r?"Resetting...":"Reset Password"})})})]})})})}function kf(n){return n==="LOCAL"}function bf(n){const{userId:a,onUserDeleted:t,authMethod:l}=n,[i,r]=u.useState(null),s=u.useCallback(()=>{r(e(ff,{userId:a,onClose:()=>r(null),onDeleted:()=>{t(),r(null)}}))},[a,t]),c=u.useCallback(()=>{r(e(hf,{userId:a,onClose:()=>r(null)}))},[a]),d=u.useMemo(()=>{const m=e(le,{children:o(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(I.TrashOutline,{})}),e(x,{children:"Delete"})]})},"deleteUser"),y=e(le,{children:o(h,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(L,{svg:e(I.Refresh,{})}),e(x,{children:"Reset Password"})]})},"resetPassword"),g=[m];return kf(l)&&g.push(y),g},[l]);return o("div",{onClick:m=>{m.preventDefault(),m.stopPropagation()},children:[e(Nn,{align:"end","aria-label":"User Actions",buttonSize:"compact",onAction:m=>{switch(m){case"deleteUser":s();break;case"resetPassword":c();break}},children:d}),e(ee,{type:"modal",isDismissable:!0,onDismiss:()=>r(null),children:i})]})}const po=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserRoleChangeDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserRoleChangeDialogMutation",selections:a},params:{cacheID:"44e970c967f83a0b7a6bd1cbafc3a936",id:null,metadata:{},name:"UserRoleChangeDialogMutation",operationKind:"mutation",text:`mutation UserRoleChangeDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    __typename
  }
}
`}}}();po.hash="468eff05b42e39b55f9aa5b9a7d2c483";function Sf({userId:n,email:a,currentRole:t,newRole:l,onRoleChanged:i,onClose:r}){const[s,c]=D.useMutation(po),d=xe(),m=ve(),y=u.useCallback(()=>{s({variables:{input:{userId:n,newRole:l}},onCompleted:()=>{d({title:"Role Changed",message:"Users role has been changed."}),i(),r()},onError:g=>{m({title:"Failed to delete user",message:g.message})}})},[s,l,m,d,r,i,n]);return o(Z,{title:"Confirm role change",children:[e(K,{padding:"size-200",children:o(x,{children:[`Are you sure you want to change the role for ${a} from `," ",e("b",{children:ht(t)})," to"," ",e("b",{children:ht(l)}),"?"]})}),e(K,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(h,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(z,{variant:"default",onClick:r,children:"Cancel"}),e(z,{variant:"primary",onClick:()=>{y()},disabled:c,children:"Change role"})]})})]})}const vf=55,Cf=C`
  text-decoration: none;
  color: var(--ac-global-color-grey-600);
  font-size: 12px;
  &:hover {
    text-decoration: underline;
  }
`,Ff=C`
  height: ${vf}px;
`,kl=n=>n.email==="admin@localhost"||n.username==="admin";function Kf({query:n}){const[a,t]=u.useState(null),[l,i]=D.useRefetchableFragment(uo,n),r=u.useMemo(()=>l.users.edges.map(({user:g})=>({id:g.id,email:g.email,username:g.username,profilePictureUrl:g.profilePictureUrl,createdAt:g.createdAt,role:g.role.name,authMethod:g.authMethod})),[l]),s=u.useCallback(()=>{u.startTransition(()=>{i({},{fetchPolicy:"network-only"})})},[i]),c=u.useMemo(()=>[{header:"user",accessorKey:"username",cell:({row:g})=>o(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(oi,{name:g.original.username,profilePictureUrl:g.original.profilePictureUrl,size:20}),e("span",{children:g.original.username}),e("a",{href:`mailto:${g.original.email}`,css:Cf,children:g.original.email})]})},{header:"method",accessorKey:"authMethod",size:10,cell:({row:g})=>g.original.authMethod.toLowerCase()},{header:"role",accessorKey:"role",cell:({row:g})=>kl(g.original)?ht(g.original.role):e(Dc,{includeLabel:!1,onChange:p=>{p!==g.original.role&&t(e(Sf,{onClose:()=>t(null),onRoleChanged:s,currentRole:g.original.role,newRole:p,email:g.original.email,userId:g.original.id}))},role:Ic(g.original.role)?g.original.role:void 0})},{header:"created at",accessorKey:"createdAt",cell:Ee},{header:"",accessorKey:"id",size:10,cell:({row:g})=>kl(g.original)?null:e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(bf,{userId:g.original.id,onUserDeleted:s,authMethod:g.original.authMethod})}),meta:{textAlign:"right"}}],[s]),d=Fe({columns:c,data:r,getCoreRowModel:Ke(),getSortedRowModel:Mn()}),m=d.getRowModel().rows,y=d.getRowModel().rows.length===0;return o("table",{css:nn,children:[e("thead",{children:d.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(p=>e("th",{colSpan:p.colSpan,children:p.isPlaceholder?null:o("div",{className:p.column.getCanSort()?"cursor-pointer":"",onClick:p.column.getToggleSortingHandler(),style:{left:p.getStart(),width:p.getSize()},children:[J(p.column.columnDef.header,p.getContext()),p.column.getIsSorted()?e(L,{className:"sort-icon",svg:p.column.getIsSorted()==="asc"?e(I.ArrowUpFilled,{}):e(I.ArrowDownFilled,{})}):null]})},p.id))},g.id))}),y?e(an,{}):e("tbody",{children:m.map(g=>e("tr",{css:Ff,children:g.getVisibleCells().map(p=>e("td",{children:J(p.column.columnDef.cell,p.getContext())},p.id))},g.id))}),e(ee,{onDismiss:()=>t(null),isDismissable:!0,type:"modal",children:a})]})}function xf(){const[n,a]=u.useState(0),[t,l]=u.useState(null),i=xe(),r=ve(),s=D.useLazyLoadQuery(so,{},{fetchKey:n,fetchPolicy:"store-and-network"});return o(q,{title:"Users",variant:"compact",bodyStyle:{padding:0,overflowX:"auto"},extra:e(z,{onClick:()=>{l(e(yf,{onDismiss:()=>{l(null)},onNewUserCreated:c=>{l(null),i({title:"User added",message:`User ${c} has been added.`}),a(d=>d+1)},onNewUserCreationError:c=>{r({title:"Error adding user",message:c.message})}}))},variant:"default",size:"compact",icon:e(L,{svg:e(I.PlusCircleOutline,{})}),children:"Add User"}),children:[e(u.Suspense,{fallback:e(K,{padding:"size-200",children:e(ye,{})}),children:e(Kf,{query:s})}),e(ee,{onDismiss:()=>{l(null)},children:t})]})}const Tf=C`
  overflow-y: auto;
`,If=C`
  padding: var(--ac-global-dimension-size-400);
  max-width: 1000px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`,Df=C`
  .ac-field {
    // Hacky solution to make the text fields fill the remaining space
    width: calc(100% - var(--ac-global-dimension-size-600));
  }
`;function l1(){return e("main",{css:Tf,children:e("div",{css:If,children:o(h,{direction:"column",gap:"size-200",width:"100%",children:[e(q,{title:"Platform Settings",variant:"compact",children:o("form",{css:Df,children:[o(h,{direction:"row",gap:"size-100",alignItems:"end",children:[e(ae,{label:"Hostname",value:ft,isReadOnly:!0,description:"Connect to Phoenix over HTTP"}),e(gt,{text:ft})]}),o(h,{direction:"row",gap:"size-100",alignItems:"end",children:[e(ae,{label:"Platform Version",isReadOnly:!0,value:Pa,description:"The version of the Phoenix server"}),e(gt,{text:Pa})]}),o(h,{direction:"row",gap:"size-100",alignItems:"end",justifyContent:"center",children:[e(ae,{label:"Python Version",isReadOnly:!0,value:`pip install 'arize-phoenix==${Pa}'`,description:"The version of the Python client library to use to connect to this Phoenix"}),e(gt,{text:Pa})]})]})}),e(ti,{children:o(G,{children:[e(pf,{}),e(xf,{})]})})]})})})}function gt(n){return e(K,{paddingBottom:"19px",children:e(se,{text:n.text,size:"default"})})}const bl=window.Config.basename,Sl={width:"100%",height:"100%",border:"none",backgroundColor:"white"};function i1(){return o("div",{css:C`
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        height: 100%;
        .ac-tabs {
          flex: 1 1 auto;
        }
        .ac-tabs__pane-container,
        .ac-tabs__pane-container > div {
          flex: 1 1 auto;
          height: 100%;
        }
      `,children:[e(ue,{variant:"info",banner:!0,icon:e(L,{svg:e(I.InfoFilled,{})}),children:"These APIs are under active development and are subject to change."}),o(Qe,{children:[e(ne,{name:"REST",children:({isSelected:n})=>n&&e("iframe",{src:`${bl}/docs`,style:Sl})}),e(ne,{name:"GraphQL",children:({isSelected:n})=>n&&e("iframe",{src:`${bl}/graphql`,style:Sl})})]})]})}function Za({children:n}){return o("main",{css:C`
        padding-top: 200px;
        width: 100%;
        height: 100vh;
        overflow: hidden;
        background: radial-gradient(
          90% 60% at 50% 30%,
          rgba(5, 145, 193, 0.4) 0%,
          transparent 100%
        );
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        box-sizing: border-box;
      `,children:[e(K,{borderColor:"light",borderWidth:"thin",width:"size-5000",padding:"size-400",backgroundColor:"dark",marginStart:"auto",marginEnd:"auto",borderRadius:"medium",overflow:"auto",children:n}),o("footer",{css:C`
          display: flex;
          justify-content: center;
          padding: var(--ac-global-dimension-size-400);
          gap: var(--ac-global-dimension-size-200);
          a {
            color: var(--ac-global-text-color-700);
            transition: color 0.2s ease-in-out;
            text-decoration: none;
            &:hover {
              color: var(--ac-global-text-color-900);
              text-decoration: underline;
            }
          }
        `,children:[e("a",{href:"https://docs.arize.com/phoenix",children:"Documentation"}),"|",e("a",{href:"https://join.slack.com/t/arize-ai/shared_invite/zt-1px8dcmlf-fmThhDFD_V_48oU7ALan4Q",children:"Community"}),"|",e("a",{href:"https://twitter.com/ArizePhoenix",children:"Social"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix",children:"GitHub"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix/releases",children:`arize-phoenix v${window.Config.platformVersion}`})]})]})}function Pf(n){const a=X(),{initialError:t,onSubmit:l}=n,[i,r]=u.useState(t),[s,c]=u.useState(!1),d=u.useCallback(async g=>{l==null||l(),r(null),c(!0);try{const f=await fetch(Fa("/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(!f.ok){const k=f.status===429?"Too many requests. Please try again later.":"Invalid login";r(k);return}}catch{r("Invalid login");return}finally{c(()=>!1)}const p=Pc();a(p)},[a,l,r]),{control:m,handleSubmit:y}=Ue({defaultValues:{email:"",password:""}});return o(G,{children:[i?o(K,{paddingBottom:"size-100",children:[e(ue,{variant:"danger",children:i})," "]}):null,o(Re,{children:[e(W,{name:"email",control:m,render:({field:{onChange:g,value:p}})=>e(ae,{label:"Email",name:"email",isRequired:!0,type:"email",onChange:g,value:p,placeholder:"your email address"})}),o("div",{css:C`
            position: relative;
            a {
              position: absolute;
              float: right;
              right: 0;
              top: var(--ac-global-dimension-size-50);
              font-size: 12px;
            }
          `,children:[e(W,{name:"password",control:m,render:({field:{onChange:g,value:p}})=>e(ae,{label:"Password",name:"password",type:"password",isRequired:!0,onChange:g,value:p,placeholder:"your password",onKeyDown:f=>{f.key==="Enter"&&y(d)()}})}),e(Ge,{to:"/forgot-password",children:"Forgot your password?"})]}),e("div",{css:C`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(z,{variant:"primary",loading:s,onClick:y(d),children:"Login"})})]})]})}const Lf=C`
  button {
    width: 100%;
  }
  i {
    display: block;
    width: 20px;
    height: 20px;
    padding-right: var(--ac-global-dimension-size-50);
  }
  &[data-provider^="aws"],
  &[data-provider^="google"] {
    button {
      background-color: white;
      color: black;
      &:hover {
        background-color: #ececec !important;
      }
    }
  }
`;function wf({idpName:n,idpDisplayName:a,returnUrl:t}){return e("form",{action:Fa(`/oauth2/${n}/login${t?`?returnUrl=${t}`:""}`),method:"post",css:Lf,"data-provider":n,children:o(z,{variant:"default",type:"submit",icon:e(Ef,{idpName:n}),children:["Login with ",a]})})}function Ef({idpName:n}){return n==="github"||n==="google"||n==="microsoft_entra_id"||n.startsWith("aws")?e("i",{children:e("div",{css:C`
          display: inline-block;
          width: 20px;
          height: 20px;
          position: relative;
          background-size: contain;
          background-repeat: no-repeat;
          background-position: 50%;
          &[data-provider^="github"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='20' height='20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 0C4.477 0 0 4.36 0 9.74c0 4.304 2.865 7.955 6.839 9.243.5.09.682-.211.682-.47 0-.23-.008-.843-.013-1.656-2.782.588-3.369-1.306-3.369-1.306-.454-1.125-1.11-1.425-1.11-1.425-.908-.604.069-.592.069-.592 1.003.069 1.531 1.004 1.531 1.004.892 1.488 2.341 1.059 2.91.81.092-.63.35-1.06.636-1.303-2.22-.245-4.555-1.081-4.555-4.814 0-1.063.39-1.933 1.029-2.613-.103-.247-.446-1.238.098-2.578 0 0 .84-.262 2.75.998A9.818 9.818 0 0 1 10 4.71c.85.004 1.705.112 2.504.328 1.909-1.26 2.747-.998 2.747-.998.546 1.34.203 2.331.1 2.578.64.68 1.028 1.55 1.028 2.613 0 3.742-2.339 4.566-4.566 4.807.359.3.678.895.678 1.804 0 1.301-.012 2.352-.012 2.671 0 .261.18.564.688.47C17.137 17.69 20 14.042 20 9.74 20 4.36 15.522 0 10 0z' fill='%23161514' fill-rule='evenodd'/%3E%3C/svg%3E");
          }

          &[data-provider^="google"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 48 48'%3E%3Cdefs%3E%3Cpath id='a' d='M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z'/%3E%3C/defs%3E%3CclipPath id='b'%3E%3Cuse xlink:href='%23a' overflow='visible'/%3E%3C/clipPath%3E%3Cpath clip-path='url(%23b)' fill='%23FBBC05' d='M0 37V11l17 13z'/%3E%3Cpath clip-path='url(%23b)' fill='%23EA4335' d='M0 11l17 13 7-6.1L48 14V0H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%2334A853' d='M0 37l30-23 7.9 1L48 0v48H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%234285F4' d='M48 48L17 24l-4-3 35-10z'/%3E%3C/svg%3E");
          }
          &[data-provider^="microsoft"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='21' height='21'%3E%3Cpath fill='%23f25022' d='M1 1h9v9H1z'/%3E%3Cpath fill='%2300a4ef' d='M1 11h9v9H1z'/%3E%3Cpath fill='%237fba00' d='M11 1h9v9h-9z'/%3E%3Cpath fill='%23ffb900' d='M11 11h9v9h-9z'/%3E%3C/svg%3E");
          }
          &[data-provider^="aws"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='400' height='334' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M236.578 94.824c-9.683.765-20.854 1.502-32.021 3.006-17.12 2.211-34.24 5.219-48.386 11.907-27.544 11.208-46.163 35.053-46.163 70.114 0 44.018 28.298 66.354 64.026 66.354 11.93 0 21.606-1.466 30.522-3.71 14.156-4.481 26.07-12.67 40.209-27.596 8.192 11.205 10.413 16.428 24.575 28.338 3.725 1.502 7.448 1.502 10.413-.742 8.932-7.458 24.561-20.873 32.773-28.33 3.71-3.012 2.955-7.463.739-11.204-8.198-10.435-16.381-19.401-16.381-39.506V96.324c0-28.359 2.214-54.453-18.614-73.822C261.147 6.815 234.34.86 213.5.86h-8.947c-37.965 2.247-78.169 18.635-87.122 65.629-1.462 5.955 3.012 8.198 5.989 8.962l41.677 5.224c4.471-.773 6.691-4.491 7.432-8.233 3.74-16.388 17.136-24.583 32.024-26.087h2.998c8.905 0 18.586 3.743 23.813 11.168 5.932 8.965 5.21 20.904 5.21 31.339v5.961h.004v.001zm0 43.278c0 17.162.723 30.571-8.195 45.461-5.208 10.437-14.141 17.154-23.827 19.4-1.481 0-3.698.766-5.947.766-16.371 0-26.077-12.673-26.077-31.334 0-23.856 14.159-35.056 32.023-40.277 9.687-2.241 20.86-2.982 32.021-2.982v8.966h.002z'/%3E%3Cpath d='M373.71 315.303c18.201-15.398 25.89-43.349 26.29-57.939v-2.44c0-3.255-.803-5.661-1.6-6.88-3.646-4.445-30.369-8.523-53.402-1.627-6.468 2.045-12.146 4.865-17.396 8.507-4.051 2.854-3.238 6.464.802 6.08 4.447-.823 10.126-1.208 16.594-2.048 14.159-1.18 30.742-1.592 34.784 3.662 5.642 6.87-6.468 36.868-11.749 49.838-1.593 4.065 2.03 5.696 5.677 2.847z' fill='%23FE9900'/%3E%3Cpath d='M2.008 257.364c52.17 47.404 120.925 75.775 197.791 75.775 47.725 0 102.727-13.381 145.199-38.899 5.676-3.27 11.316-6.912 16.565-10.952 7.286-5.25.817-13.38-6.463-10.147-3.229 1.215-6.873 2.857-10.103 4.066-46.539 18.248-95.441 26.76-140.762 26.76-72.008 0-141.56-19.87-197.786-52.684-5.259-2.822-8.907 2.428-4.441 6.081z' fill='%23FE9900'/%3E%3C/svg%3E");
          }
        `,"data-provider":n})}):null}function qt(){return o("svg",{width:"253",height:"63",viewBox:"0 0 682 169",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o("g",{clipPath:"url(#clip0_290_1904)",children:[e("path",{d:"M147.458 105.593C147.022 103.63 146.028 101.824 144.492 100.222C143.901 99.6064 143.244 99.0233 142.529 98.4978C142.184 98.2432 141.815 98.005 141.437 97.7669C140.969 97.4712 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3897 133.699 92.9299 133.157 92.4535C131.851 91.312 130.972 90.3348 130.315 89.3C130.102 88.9715 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8957C129.173 87.7233 128.869 87.6494 128.565 87.6986C128.097 87.789 127.736 88.1667 127.678 88.6431C127.637 89.0126 127.637 89.4068 127.687 89.8092C127.719 90.0474 127.588 90.2773 127.366 90.3758C127.317 90.4005 127.259 90.4087 127.21 90.4169C126.898 90.4498 126.619 90.6222 126.438 90.885C126.257 91.1478 126.208 91.4681 126.282 91.7719C126.348 92.0347 126.438 92.2236 126.512 92.3714L126.578 92.5028C126.627 92.5931 126.676 92.6917 126.726 92.782C126.873 93.0612 127.021 93.3405 127.202 93.6033C127.547 94.1042 127.933 94.6052 128.393 95.1389C128.541 95.3114 128.565 95.5578 128.459 95.7549C128.352 95.952 128.13 96.0669 127.908 96.0341C125.321 95.681 122.996 95.0979 120.836 94.3013C120.59 94.211 120.335 94.1206 120.097 94.0221C118.158 93.2009 121.658 89.7189 123.259 87.247C130.282 76.4479 131.736 64.0802 131.794 51.5647C131.851 39.4681 130.545 27.5357 128.138 15.7593V15.7429C126.569 5.87173 125.239 2.168 124.401 0.796558C124.22 0.435219 124.023 0.205276 123.818 0.0985162C123.588 -0.0575166 123.465 0.0163937 123.465 0.0163937C123.013 0.0328182 122.495 0.435219 121.871 1.08399C119.251 3.83509 119.399 7.11178 120.122 10.5363C123.432 26.0903 125.921 41.7346 124.787 57.7157C124.007 68.7365 121.953 79.3468 114.248 87.9779C113.789 88.4952 113.287 88.9798 112.786 89.4725C112.211 90.0391 111.316 91.1396 110.651 90.6797C109.764 90.0638 110.552 88.7991 110.831 88.1421C115.341 77.5729 116.639 66.5275 115.949 55.1453C115.932 54.8825 115.908 54.6197 115.891 54.3569V54.3405C115.883 54.1269 115.858 53.9298 115.842 53.7245C115.727 52.2217 115.587 50.7189 115.398 49.2242C113.46 31.1655 111.127 29.9911 111.127 29.9911C110.971 29.8515 110.782 29.7448 110.528 29.6955C109.304 29.4409 108.638 30.5167 108.096 31.3297C105.648 34.9924 106.733 38.8932 107.521 42.753C110.289 56.2703 110.33 69.6645 105.583 82.8124C105.147 84.0113 104.63 85.1775 104.08 86.3272C103.496 87.5508 103.119 89.0783 101.131 88.4213C99.2662 87.8054 99.7918 86.3929 100.03 85.1036C100.654 81.8269 101.155 78.542 101.467 75.2489V75.2653C101.509 74.9368 101.525 74.6247 101.55 74.3127C101.599 73.746 101.632 73.1712 101.665 72.6045C101.689 72.1282 101.714 71.6601 101.739 71.2002C101.747 70.9621 101.763 70.7321 101.763 70.494C102.141 60.0562 100.383 55.3095 99.7179 53.9052C99.644 53.7328 99.5619 53.5767 99.4715 53.4371C98.7815 52.4024 97.6398 52.5256 96.6541 53.5028C94.8388 55.2931 93.8367 57.4118 94.2967 60.0808C95.6438 67.8496 94.8552 75.5445 93.4096 83.1983C93.2124 84.2249 92.7524 86.0973 90.5593 85.6127C89.0644 85.2842 88.7194 84.6437 88.6372 83.3461C88.6537 82.3689 88.6372 81.3916 88.6044 80.4144C88.6044 80.3897 88.6044 80.3651 88.6044 80.3405C88.6044 80.2009 88.588 80.0612 88.588 79.9299C88.588 79.8559 88.5797 79.7902 88.5715 79.7245C88.5058 78.3942 88.399 77.0556 88.2347 75.717C88.2183 75.5856 88.1937 75.4624 88.1773 75.331C87.3394 67.7921 86.247 67.0612 86.247 67.0612C85.5488 66.1497 84.4563 66.3057 83.5117 67.2419C81.6964 69.0322 80.7764 71.1427 81.1543 73.8199C81.4336 75.7745 81.3596 75.175 81.5568 76.8831C81.7128 77.7618 81.8771 79.3632 81.8935 79.8724C81.8525 80.324 81.7375 80.7182 81.4582 81.0139C80.53 82.0076 79.0351 80.9892 77.9015 80.5211C55.9209 71.4302 37.1108 58.6683 20.691 42.523C14.2513 35.945 3.25273 22.6329 3.25273 22.6329C2.84203 22.1566 2.33276 21.8856 1.55243 22.2223C0.114982 22.8383 0.156052 24.6778 0.0246278 26.2217C-0.23822 29.3177 1.42101 31.5597 3.21987 33.662C28.0179 62.5856 58.2783 83.3708 94.8059 93.7675L101.377 95.5085C101.451 95.5249 101.533 95.5496 101.607 95.566C101.624 95.566 101.632 95.566 101.64 95.5742L107.299 97.077L107.456 97.1181C107.267 97.1756 107.061 97.2167 106.839 97.2577C100.613 98.4895 88.2923 96.223 78.3944 93.9153C73.4988 92.8888 68.6854 91.6405 63.9788 90.1541C63.7653 90.0884 63.642 90.0556 63.642 90.0556C45.3577 84.2331 28.6093 74.7972 13.9556 60.4093C12.5674 59.0461 11.286 57.5761 10.0211 56.0897C8.86289 54.71 6.47262 51.8275 5.643 50.8338C5.55265 50.7024 5.45408 50.5875 5.35551 50.4807C5.10909 50.2261 4.80517 50.0619 4.36983 50.1604C3.3513 50.3986 3.05559 51.4498 2.86667 52.3367C2.1192 55.9008 3.25273 58.8983 5.65122 61.5755C20.6582 78.3942 39.4929 89.1358 60.6439 96.1819C72.6528 100.181 85.0067 102.612 97.6069 104.164C90.0911 106.595 82.3617 107.334 74.5667 107.137C59.4775 106.759 45.3248 103.138 32.0264 96.6746C27.1226 94.1535 22.5556 91.3449 21.3564 90.5894C20.6664 90.1213 19.9518 89.8338 19.2454 90.3758C17.9229 91.4024 18.8347 93.2009 19.2618 94.6051C20.075 97.307 21.956 99.1712 24.3956 100.46C46.0641 111.917 68.9401 116.499 93.2946 112.434C95.7588 112.023 98.0998 111.572 100.679 110.701C96.6048 114.224 91.89 116.524 86.9369 118.339C71.6835 123.915 56.5287 123.693 41.4314 119.915C36.5851 118.618 30.9668 116.507 30.9668 116.507C30.1536 116.154 29.3486 116.031 28.7243 116.926C27.6237 118.503 28.5847 120.145 29.5375 121.632C31.7882 125.138 36.1416 125.483 39.5832 126.674C40.7578 127.052 37.5544 129.187 36.5276 129.975C31.5335 133.794 26.6462 137.284 21.6767 140.98L18.424 143.378C17.8654 143.764 17.3726 144.199 17.6272 145.004C17.9229 145.915 18.8675 146.08 19.7875 146.268C23.3442 147.008 26.3833 145.825 29.1925 143.723C35.2134 139.214 41.3493 134.837 47.2387 130.156C49.4811 128.374 51.5182 128.522 54.582 129.31C46.9183 135.083 39.7475 140.495 32.5685 145.899C25.2827 151.376 17.9969 156.854 10.711 162.323L5.89764 165.888C5.82371 165.937 5.758 165.986 5.69229 166.044L5.61836 166.093C5.20766 166.421 4.90374 166.791 4.9941 167.267C5.19123 168.351 6.4644 168.622 7.50758 168.803C11.8117 169.542 14.4813 167.924 17.4219 165.715C32.1496 154.661 46.9266 143.682 61.5721 132.521C64.8577 130.016 68.2337 128.604 72.9731 129.138C68.9401 132.152 65.0631 135.051 61.2436 137.908L50.8611 145.587C50.7871 145.636 50.7132 145.694 50.6475 145.751C50.0972 146.186 49.7111 146.695 49.9247 147.451C50.3189 148.822 51.97 148.987 53.3745 149.2C55.9537 149.586 58.1387 148.675 60.1675 147.164C61.3339 146.293 62.5085 145.439 63.6831 144.593L79.5361 132.004C79.5361 132.004 83.2817 129.327 87.6187 126.871C88.0048 126.633 88.3908 126.387 88.7851 126.148C88.9494 126.075 89.3601 125.886 89.9843 125.59C90.4525 125.352 90.9207 125.114 91.3807 124.892C92.0625 124.547 92.851 124.128 93.7381 123.644C96.2927 122.584 103.611 119.168 109.657 112.73C112.532 110.512 116.581 107.613 119.735 106.217H119.752C119.99 106.111 120.228 106.012 120.458 105.93C120.458 105.93 120.475 105.93 120.483 105.922C120.639 105.864 120.787 105.815 120.935 105.766L121.337 105.61C122.479 105.289 124.335 105.166 124.582 107.679C124.623 108.295 124.615 108.927 124.541 109.593C124.491 110.093 124.393 110.627 124.319 111.054C124.245 111.465 124.417 111.876 124.746 112.122C124.795 112.163 124.853 112.196 124.91 112.22C125.346 112.434 125.871 112.335 126.2 111.974C126.323 111.834 126.446 111.703 126.569 111.572C128.122 109.937 129.699 108.804 131.375 108.114C133.822 107.104 136.303 107.096 138.94 108.106C140.197 108.582 141.379 109.239 142.554 110.102C143.055 110.471 143.556 110.882 144.057 111.334C144.353 111.605 144.648 111.9 144.911 112.163L144.952 112.204L145.166 112.418C145.166 112.418 145.248 112.491 145.289 112.524C145.536 112.705 145.856 112.779 146.168 112.713C146.529 112.631 146.825 112.376 146.957 112.032C146.981 111.966 147.006 111.9 147.031 111.834C147.778 109.617 147.934 107.581 147.499 105.593H147.458Z",fill:"url(#paint0_linear_290_1904)"}),e("path",{d:"M120.113 94.0303C120.195 94.0632 120.269 94.096 120.351 94.1207C120.269 94.0878 120.187 94.0632 120.113 94.0303Z",fill:"#FEDBB5"}),e("path",{d:"M111.283 87.1238C111.283 87.1238 111.267 87.1567 111.267 87.1731C111.267 87.1567 111.283 87.1402 111.283 87.1238Z",fill:"#FEDBB5"}),e("path",{d:"M123.383 87.1074C123.383 87.1074 123.358 87.1487 123.341 87.1652C123.358 87.1487 123.366 87.1239 123.383 87.1074Z",fill:"#FEDBB5"}),e("path",{d:"M104.104 86.3354C103.965 86.6229 103.841 86.9267 103.71 87.2142C103.85 86.9267 103.973 86.6229 104.104 86.3354Z",fill:"#FEDBB5"}),e("path",{d:"M89.0233 84.7422C89.0233 84.7422 89.0233 84.7505 89.0316 84.7588C89.0316 84.7588 89.0316 84.7505 89.0233 84.7422Z",fill:"#FEDBB5"}),e("path",{d:"M89.0644 84.7998C89.1876 84.964 89.3437 85.1118 89.5408 85.235C89.3437 85.1118 89.1876 84.9722 89.0644 84.7998ZM89.0644 84.7833C89.0644 84.7833 89.0644 84.7833 89.0644 84.7915C89.0644 84.7915 89.0644 84.7915 89.0644 84.7833ZM89.0562 84.7751C89.0562 84.7751 89.0562 84.7751 89.0562 84.7833C89.0562 84.7833 89.0562 84.7833 89.0562 84.7751ZM88.6947 83.3626C88.6947 83.3626 88.6947 83.3708 88.6947 83.379C88.6947 83.379 88.6947 83.3708 88.6947 83.3626ZM79.1665 81.0878C79.1665 81.0878 79.1829 81.0878 79.1829 81.096C79.6429 81.2931 80.1029 81.4492 80.53 81.4492C80.7107 81.4492 80.8832 81.4245 81.0393 81.3588C80.875 81.4245 80.7025 81.4492 80.53 81.4492C80.0947 81.4492 79.6265 81.2849 79.1665 81.0878ZM88.629 79.6507C88.629 79.6507 88.629 79.6507 88.629 79.6589C88.629 79.6589 88.629 79.6589 88.629 79.6507Z",fill:"#E5B4A6"}),e("path",{d:"M120.36 94.1206C120.36 94.1206 120.434 94.1535 120.475 94.1617C120.475 94.1617 120.401 94.1289 120.36 94.1206ZM110.273 89.8749C110.273 90.187 110.38 90.4662 110.684 90.6797C110.79 90.7536 110.905 90.7865 111.029 90.7865C111.209 90.7865 111.398 90.7126 111.595 90.5894C111.406 90.7126 111.218 90.7865 111.029 90.7865C110.905 90.7865 110.79 90.7536 110.684 90.6797C110.38 90.4744 110.273 90.187 110.273 89.8749ZM110.914 88.0189C110.914 88.0189 110.881 88.1011 110.864 88.1421C110.881 88.1011 110.897 88.06 110.914 88.0189ZM111.226 87.2798C111.127 87.5262 111.02 87.7726 110.914 88.0189C111.02 87.7726 111.119 87.5262 111.226 87.2798ZM111.267 87.1731C111.267 87.1731 111.234 87.2388 111.226 87.2798C111.242 87.247 111.259 87.2141 111.267 87.1731ZM123.341 87.1731C123.341 87.1731 123.341 87.1813 123.333 87.1895C123.333 87.1895 123.333 87.1813 123.341 87.1731ZM123.391 87.0992C123.391 87.0992 123.391 87.1074 123.382 87.1156C123.382 87.1156 123.382 87.1074 123.391 87.0992ZM111.308 87.0992C111.308 87.0992 111.3 87.132 111.291 87.1402C111.291 87.1238 111.3 87.1074 111.308 87.0992ZM99.8001 86.7707C99.8001 87.4769 100.079 88.0928 101.155 88.446C101.484 88.5527 101.771 88.602 102.026 88.602C102.93 88.602 103.365 87.9615 103.71 87.2306C103.357 87.9697 102.921 88.602 102.026 88.602C101.78 88.602 101.492 88.5527 101.155 88.446C100.088 88.0928 99.8001 87.4769 99.8001 86.7707ZM92.7689 84.9886C92.4486 85.4074 91.9722 85.7195 91.2575 85.7195C91.1836 85.7195 91.1097 85.7195 91.0358 85.7113C91.1097 85.7113 91.1836 85.7195 91.2575 85.7195C91.9722 85.7195 92.4486 85.4157 92.7689 84.9886ZM106.651 79.7081C106.651 79.7081 106.651 79.7081 106.642 79.7081C106.322 80.7511 105.985 81.8023 105.616 82.8452C105.993 81.8023 106.338 80.7593 106.659 79.7081M94.1571 79.1251C93.9846 80.2748 93.7875 81.4163 93.5739 82.566C93.7875 81.4245 93.9846 80.2748 94.1571 79.1251ZM122.191 73.6311C120.623 78.7884 118.175 83.65 114.29 88.0025C113.83 88.5199 113.329 89.0044 112.828 89.4972C113.329 89.0126 113.821 88.5199 114.29 88.0025C118.175 83.65 120.623 78.7884 122.2 73.6311",fill:"#E5B4A6"}),e("path",{opacity:"0.4",d:"M2.20136 22.0745C2.00423 22.0745 1.79066 22.1238 1.55246 22.2223C0.53392 22.6658 0.254644 23.7252 0.139648 24.8503C5.61017 32.0196 27.213 58.4548 61.1943 76.5875C61.1943 76.5875 94.4692 94.1453 127.933 96.0423C125.346 95.6892 123.021 95.1061 120.861 94.3095C120.729 94.2602 120.606 94.2192 120.475 94.1699C108.318 91.542 97.9519 88.2571 90.6168 85.6292C90.7565 85.662 90.8961 85.6784 91.0193 85.6949C90.8879 85.6867 90.7401 85.662 90.5922 85.6292C90.1486 85.5306 89.8037 85.4074 89.5408 85.2432C83.7417 83.1244 80.0454 81.4984 79.1583 81.096C78.7312 80.9153 78.3123 80.6936 77.9344 80.5376C55.9538 71.4466 37.1437 58.6848 20.7239 42.5395C14.2513 35.945 3.25275 22.633 3.25275 22.633C2.97348 22.3045 2.6367 22.0745 2.20136 22.0745Z",fill:"url(#paint1_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M4.62448 50.1358C4.55056 50.1358 4.46842 50.144 4.37806 50.1687C3.35953 50.4068 3.06382 51.458 2.8749 52.3449C2.84204 52.5009 2.80919 52.6652 2.78455 52.8212C19.7711 75.832 42.5732 85.235 42.5732 85.235C65.3341 95.952 84.0128 98.12 95.3892 98.12C100.096 98.12 103.554 97.7505 105.533 97.463C104.63 97.5616 103.636 97.6109 102.568 97.6109C95.8984 97.6109 86.362 95.7795 78.4026 93.9235C73.5071 92.897 68.6937 91.6488 63.987 90.1623C63.7735 90.0966 63.6503 90.0638 63.6503 90.0638C45.3659 84.2413 28.6176 74.8054 13.9638 60.4175C12.5756 59.0543 11.2942 57.5843 10.0293 56.0979C8.87112 54.7182 6.48084 51.8357 5.65123 50.8421C5.56088 50.7107 5.46231 50.5957 5.36374 50.4889C5.16661 50.2836 4.9284 50.1358 4.62448 50.1358Z",fill:"url(#paint2_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M20.0669 90.1049C19.7958 90.1049 19.5247 90.187 19.2537 90.4005C18.1037 91.2874 18.6458 92.7738 19.0812 94.0632C27.5991 99.2287 47.132 109.289 70.2626 109.289C79.0023 109.289 88.243 107.86 97.607 104.189C90.8469 106.382 83.9061 107.195 76.9077 107.195C76.1274 107.195 75.3471 107.186 74.5667 107.162C59.4776 106.784 45.3249 103.162 32.0264 96.6993C27.1227 94.1781 22.5557 91.3695 21.3565 90.614C20.9293 90.3266 20.5022 90.1049 20.0669 90.1049Z",fill:"url(#paint3_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M99.1759 111.949C95.4632 114.791 91.2987 116.762 86.937 118.355C78.7559 121.344 70.5994 122.666 62.4675 122.666C55.4363 122.666 48.4298 121.681 41.4315 119.932C36.5852 118.634 30.9668 116.524 30.9668 116.524C30.6136 116.368 30.2604 116.261 29.9237 116.261C29.4883 116.261 29.0776 116.442 28.7326 116.951C28.2234 117.682 28.1577 118.429 28.3219 119.168C33.6939 121.665 45.2181 126.099 59.2723 126.099C71.4536 126.099 85.5406 122.765 99.1759 111.949Z",fill:"url(#paint4_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M62.9356 129.368C49.7358 129.368 39.7557 126.699 38.4908 126.346C38.8604 126.452 39.2218 126.567 39.5833 126.69C40.7579 127.068 37.5544 129.203 36.5276 129.992C32.8396 132.817 29.2008 135.461 25.5537 138.138H36.7576C40.2897 135.527 43.8052 132.907 47.2387 130.172C48.5119 129.154 49.7275 128.768 51.0993 128.768C52.1342 128.768 53.2678 128.99 54.582 129.335C46.9184 135.108 39.7475 140.52 32.5685 145.924C28.3711 149.077 24.1738 152.231 19.9764 155.384H31.246C41.3821 147.804 51.51 140.216 61.5721 132.546C63.8967 130.78 66.2623 129.557 69.1208 129.179C67.0016 129.318 64.9316 129.376 62.9439 129.376L62.9356 129.368Z",fill:"url(#paint5_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M60.5782 138.409H71.47L79.5115 132.02C79.5115 132.02 83.2571 129.343 87.5941 126.888C87.9801 126.649 88.3662 126.403 88.7605 126.165C88.9248 126.091 89.3354 125.902 89.9597 125.606C90.4279 125.368 90.8961 125.13 91.3561 124.908C92.0625 124.547 92.8921 124.112 93.8121 123.603C86.0499 126.855 78.0987 128.44 70.739 129.056C70.8375 129.056 70.9443 129.056 71.0429 129.056C71.6589 129.056 72.2996 129.088 72.965 129.162C68.9319 132.176 65.0549 135.075 61.2354 137.933L60.5782 138.418V138.409Z",fill:"url(#paint6_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M88.6701 83.3544C88.6865 82.3771 88.6701 81.3999 88.6373 80.4226V80.3487C88.6373 80.2091 88.6208 80.0695 88.6208 79.9381L88.6044 79.7328C88.5633 78.9115 88.4976 78.0903 88.4237 77.2609C85.8281 76.1687 83.3803 74.7726 81.1215 73.1301C81.1379 73.3601 81.1461 73.59 81.179 73.8364C81.4582 75.7909 81.3843 75.1914 81.5814 76.8995C81.7375 77.7783 81.9018 79.3797 81.9182 79.8888C81.8771 80.3405 81.7621 80.7347 81.4829 81.0303C81.1954 81.3342 80.8586 81.4491 80.4972 81.4491C80.0619 81.4491 79.5937 81.2849 79.1337 81.0878C79.9961 81.4738 83.7007 83.108 89.5408 85.2432C88.9165 84.8572 88.7194 84.2742 88.6619 83.3626L88.6701 83.3544Z",fill:"url(#paint7_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M131.022 64.885C128.59 68.2685 125.6 71.2331 122.175 73.6146C120.606 78.7719 118.158 83.6336 114.273 87.9861C113.813 88.5035 113.312 88.988 112.811 89.4807C112.326 89.9488 111.628 90.8029 111.02 90.8029C110.897 90.8029 110.782 90.77 110.675 90.6961C109.788 90.0802 110.577 88.8155 110.856 88.1585C112.31 84.7505 113.427 81.2931 114.257 77.7865C111.825 78.698 109.271 79.3386 106.634 79.6999C106.314 80.7429 105.977 81.794 105.607 82.837C105.172 84.036 104.655 85.2021 104.104 86.3518C103.62 87.3702 103.275 88.602 102.018 88.602C101.771 88.602 101.484 88.5527 101.147 88.446C99.2827 87.83 99.8084 86.4175 100.047 85.1282C100.367 83.4201 100.663 81.7119 100.909 79.9956C98.5927 79.9217 96.3256 79.626 94.1325 79.1168C93.9271 80.4883 93.6889 81.8515 93.4261 83.2148C93.2536 84.1263 92.8675 85.7113 91.2412 85.7113C91.044 85.7113 90.8305 85.6867 90.6005 85.6374C97.9356 88.2735 108.293 91.5584 120.458 94.1863C120.335 94.1371 120.22 94.096 120.105 94.0467C118.167 93.2255 121.666 89.7435 123.268 87.2716C127.777 80.3323 129.987 72.7523 131.005 64.8932L131.022 64.885Z",fill:"url(#paint8_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M129.206 102.497C127.687 102.497 126.151 102.645 124.647 102.916C124.36 102.965 124.081 102.99 123.818 102.99C123.391 102.99 122.988 102.924 122.61 102.809C122.668 102.883 122.734 102.957 122.791 103.039C123.448 103.959 123.793 104.961 123.925 106.004C124.089 106.184 124.229 106.406 124.344 106.694C124.344 106.694 124.344 106.694 124.344 106.71C124.344 106.71 124.344 106.71 124.344 106.718C124.344 106.718 124.344 106.718 124.344 106.726C124.344 106.726 124.344 106.726 124.344 106.735C124.344 106.735 124.344 106.735 124.344 106.743C124.344 106.743 124.344 106.743 124.344 106.751C124.344 106.751 124.344 106.751 124.344 106.759C124.344 106.759 124.344 106.759 124.344 106.768V106.784C124.344 106.784 124.344 106.784 124.344 106.792C124.344 106.792 124.344 106.792 124.344 106.8C124.344 106.8 124.344 106.8 124.344 106.809C124.344 106.809 124.344 106.809 124.344 106.817C124.344 106.817 124.344 106.817 124.344 106.825C124.344 106.825 124.344 106.833 124.344 106.841C124.344 106.841 124.344 106.841 124.344 106.858C124.344 106.858 124.344 106.858 124.344 106.866C124.344 106.866 124.344 106.866 124.344 106.874C124.344 106.874 124.344 106.874 124.344 106.882C124.344 106.882 124.344 106.883 124.344 106.891C124.344 106.891 124.344 106.891 124.344 106.899C124.344 106.899 124.344 106.899 124.344 106.907C124.344 106.907 124.344 106.907 124.344 106.915C124.344 106.915 124.344 106.915 124.344 106.924C124.344 106.924 124.344 106.924 124.344 106.932C124.344 106.932 124.344 106.932 124.344 106.94C124.344 106.94 124.344 106.94 124.344 106.948C124.344 106.948 124.344 106.948 124.344 106.965C124.344 106.965 124.344 106.973 124.344 106.981C124.344 106.981 124.344 106.989 124.344 106.997V107.014C124.344 107.014 124.344 107.022 124.344 107.03C124.344 107.03 124.344 107.039 124.344 107.047C124.344 107.047 124.344 107.055 124.344 107.063C124.344 107.063 124.344 107.071 124.344 107.08C124.344 107.08 124.344 107.088 124.344 107.096C124.344 107.096 124.344 107.104 124.344 107.112C124.344 107.112 124.344 107.121 124.344 107.129C124.344 107.145 124.344 107.162 124.344 107.178C124.344 107.178 124.344 107.186 124.344 107.195C124.344 107.195 124.344 107.227 124.344 107.244C124.344 107.244 124.344 107.252 124.344 107.26V107.277C124.344 107.277 124.344 107.301 124.344 107.31C124.344 107.31 124.344 107.318 124.344 107.326V107.342V107.359C124.36 107.597 124.368 107.843 124.368 108.09C124.368 108.476 124.344 108.87 124.302 109.272C124.253 109.773 124.155 110.307 124.081 110.734C124.072 110.8 124.064 110.865 124.064 110.923C124.064 111.268 124.229 111.588 124.508 111.793L124.672 111.892C124.828 111.966 124.992 112.007 125.157 112.007C125.461 112.007 125.748 111.884 125.962 111.654C126.085 111.514 126.208 111.383 126.331 111.251C127.884 109.617 129.461 108.484 131.136 107.794C132.369 107.285 133.601 107.03 134.857 107.03C136.114 107.03 137.387 107.285 138.702 107.786C139.958 108.262 141.141 108.919 142.316 109.781C142.817 110.151 143.318 110.562 143.819 111.013C144.115 111.284 144.41 111.58 144.673 111.843L144.714 111.884L144.928 112.097L145.051 112.204C145.232 112.335 145.453 112.409 145.675 112.418C144.632 110.192 143.318 108.123 141.461 106.513C137.946 103.466 133.51 102.177 129.001 102.177",fill:"url(#paint9_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M128.779 87.6905L128.582 87.7069C128.114 87.7972 127.752 88.175 127.695 88.6513C127.654 89.0208 127.654 89.415 127.703 89.8174C127.72 89.9488 127.687 90.072 127.629 90.1706C129.51 92.9627 133.584 97.9065 139.769 99.7789C139.769 99.7789 149.331 104.78 146.916 112.032L146.99 111.834C147.737 109.617 147.893 107.581 147.458 105.593C147.022 103.63 146.029 101.824 144.492 100.222C143.901 99.6064 143.244 99.0234 142.529 98.4978C142.184 98.2432 141.815 98.0051 141.437 97.7669C140.969 97.4713 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3898 133.699 92.9299 133.157 92.4536C131.851 91.3121 130.972 90.3348 130.315 89.3001C130.102 88.9716 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8958C129.231 87.7562 129.001 87.6823 128.763 87.6823",fill:"url(#paint10_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M116.647 107.893L118.586 106.768L126.734 95.8535C126.734 95.8535 122.274 95.0076 120.122 94.0303C120.122 94.0303 117.887 104.222 109.632 112.738L112.672 110.488C113.887 109.634 114.988 108.903 116.647 107.893Z",fill:"url(#paint11_linear_290_1904)"}),e("path",{d:"M209.416 49.9962H230.197C245.221 49.9962 252.104 57.7157 252.104 73.5818V81.4409C252.104 97.307 245.221 105.027 230.197 105.027H218.123V148.264H209.416V49.9962ZM230.197 97.0196C239.323 97.0196 243.397 92.9463 243.397 81.8598V73.0152C243.397 62.0682 239.323 57.8553 230.197 57.8553H218.123V97.0196H230.197Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M284.114 49.9962H292.821V93.0941H319.64V49.9962H328.346V148.256H319.64V100.953H292.821V148.256H284.114V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M362.451 125.656V72.5963C362.451 57.0177 370.312 48.5919 384.497 48.5919C398.683 48.5919 406.544 57.0177 406.544 72.5963V125.656C406.544 141.234 398.683 149.66 384.497 149.66C370.312 149.66 362.451 141.234 362.451 125.656ZM397.829 126.214V72.0297C397.829 61.5016 393.056 56.451 384.489 56.451C375.922 56.451 371.15 61.5016 371.15 72.0297V126.214C371.15 136.742 375.922 141.653 384.489 141.653C393.056 141.653 397.829 136.742 397.829 126.214Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M440.796 49.9962H480.108V57.8553H449.503V93.0859H474.638V100.945H449.503V140.249H480.108V148.248H440.796V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M511.56 49.9962H523.076L548.629 125.935V49.9962H556.769V148.256H547.504L519.56 64.458V148.256H511.56V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M592.007 49.9962H600.714V148.256H592.007V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M651.674 98.1447L632.437 49.9962H641.702L657.144 89.0209L672.726 49.9962H681.154L661.917 98.1447L681.992 148.256H672.726L656.438 106.989L640.01 148.256H631.591L651.666 98.1447H651.674Z",fill:"var(--ac-global-text-color-900)"})]}),o("defs",{children:[o("linearGradient",{id:"paint0_linear_290_1904",x1:"22.0956",y1:"10.3474",x2:"97.4433",y2:"140.879",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#14BAB6"}),e("stop",{offset:"0.5",stopColor:"#00ADEE"}),e("stop",{offset:"1",stopColor:"#0095C4"})]}),o("linearGradient",{id:"paint1_linear_290_1904",x1:"95.422",y1:"114.807",x2:"31.8741",y2:"4.70214",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint2_linear_290_1904",x1:"76.6695",y1:"114.126",x2:"30.8746",y2:"34.7951",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint3_linear_290_1904",x1:"70.3612",y1:"119.915",x2:"44.7991",y2:"75.6384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint4_linear_290_1904",x1:"71.4208",y1:"128.85",x2:"55.5071",y2:"101.279",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint5_linear_290_1904",x1:"44.5363",y1:"126.346",x2:"44.5363",y2:"155.384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.9"}),e("stop",{offset:"0.22",stopColor:"#231F20",stopOpacity:"0.4"}),e("stop",{offset:"0.42",stopColor:"#231F20",stopOpacity:"0.1"}),e("stop",{offset:"0.65",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint6_linear_290_1904",x1:"77.1952",y1:"123.603",x2:"77.1952",y2:"138.409",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint7_linear_290_1904",x1:"84.3413",y1:"85.235",x2:"84.3413",y2:"73.1301",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.95"}),e("stop",{offset:"0.51",stopColor:"#231F20",stopOpacity:"0.26"}),e("stop",{offset:"0.81",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint8_linear_290_1904",x1:"110.815",y1:"94.1699",x2:"110.815",y2:"64.885",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.18",stopColor:"#231F20",stopOpacity:"0.48"}),e("stop",{offset:"0.38",stopColor:"#231F20",stopOpacity:"0.12"}),e("stop",{offset:"0.58",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint9_linear_290_1904",x1:"138.077",y1:"117.246",x2:"127.969",y2:"99.7278",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint10_linear_290_1904",x1:"146.226",y1:"112.434",x2:"131.084",y2:"86.1931",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint11_linear_290_1904",x1:"106.889",y1:"107.999",x2:"128.941",y2:"95.2581",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.31",stopColor:"#231F20",stopOpacity:"0.5"}),e("stop",{offset:"0.67",stopColor:"#231F20",stopOpacity:"0.13"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),e("clipPath",{id:"clip0_290_1904",children:e("rect",{width:"682",height:"169",fill:"white"})})]})]})}const _f=C`
  text-align: center;
  margin-top: var(--ac-global-dimension-size-200);
  margin-bottom: var(--ac-global-dimension-size-200);
  color: var(--ac-global-text-color-700);
`,Rf=C`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  flex-wrap: wrap;
  justify-content: center;
`;function r1(){const n=window.Config.oAuth2Idps,a=n.length>0,[t,l]=Sa(),i=t.get("returnUrl"),r=t.get("message");return o(Za,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(K,{paddingBottom:"size-200",children:e(qt,{})})}),r&&e(K,{paddingBottom:"size-100",children:e(ue,{variant:"success",children:r})}),e(Pf,{initialError:t.get("error"),onSubmit:()=>{l(s=>{const c=new URLSearchParams(s);return c.delete("message"),c.delete("error"),c})}}),a&&o(G,{children:[e("div",{css:_f,children:"or"}),e("ul",{css:Rf,children:n.map(s=>e("li",{children:e(wf,{idpName:s.name,idpDisplayName:s.displayName,returnUrl:i},s.name)},s.name))})]})]})}const yo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordFormMutation",selections:a},params:{cacheID:"d09af5e3a2a3d10f117373e25bef11e6",id:null,metadata:{},name:"ResetPasswordFormMutation",operationKind:"mutation",text:`mutation ResetPasswordFormMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}}();yo.hash="f8f5c30b0e00c17cdda7557c73c3c2d3";const ma=4;function Af(){const n=X(),a=ve(),[t,l]=D.useMutation(yo),{control:i,handleSubmit:r}=Ue({defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}}),s=u.useCallback(c=>{t({variables:{input:{currentPassword:c.currentPassword,newPassword:c.newPassword}},onCompleted:()=>{const d=di({path:"/login",searchParams:{message:"Password has been reset."}});n(d)},onError:d=>{a({title:"Failed to reset password",message:d.message})}})},[t,n,a]);return o(Re,{onSubmit:r(s),children:[e(W,{name:"currentPassword",control:i,rules:{required:"the current is required"},render:({field:{name:c,onChange:d,onBlur:m,value:y},fieldState:{invalid:g,error:p}})=>e(ae,{label:"Old Password",type:"password",name:c,isRequired:!0,description:"The current password",errorMessage:p==null?void 0:p.message,validationState:g?"invalid":"valid",onChange:d,onBlur:m,value:y})}),e(W,{name:"newPassword",control:i,rules:{required:"Password is required",minLength:{value:ma,message:`Password must be at least ${ma} characters`},validate:(c,d)=>c!==d.currentPassword||"New password must be different"},render:({field:{name:c,onChange:d,onBlur:m,value:y},fieldState:{invalid:g,error:p}})=>e(ae,{label:"New Password",type:"password",isRequired:!0,description:`Password must be at least ${ma} characters`,name:c,errorMessage:p==null?void 0:p.message,validationState:g?"invalid":"valid",onChange:d,onBlur:m,defaultValue:y})}),e(W,{name:"confirmPassword",control:i,rules:{required:"Password is required",minLength:{value:ma,message:`Password must be at least ${ma} characters`},validate:(c,d)=>c===d.newPassword||"Passwords do not match"},render:({field:{name:c,onChange:d,onBlur:m,value:y},fieldState:{invalid:g,error:p}})=>e(ae,{label:"Confirm Password",isRequired:!0,type:"password",description:"Confirm the new password",name:c,errorMessage:p==null?void 0:p.message,validationState:g?"invalid":"valid",onChange:d,onBlur:m,defaultValue:y})}),e(K,{paddingTop:"size-200",children:o("div",{css:C`
            display: flex;
            flex-direction: row;
            gap: var(--ac-global-dimension-size-200);
            & > * {
              width: 50%;
            }
          `,children:[e(z,{variant:"default",onClick:()=>{n(-1)},children:"Cancel"}),e(z,{variant:"primary",type:"submit",disabled:l,children:l?"Resetting...":"Reset Password"})]})})]})}function s1(){return o(Za,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(K,{paddingBottom:"size-200",children:e(qt,{})})}),e(Af,{})]})}const ga=4,Mf="An error occurred. Please try resetting again.";function Nf({resetToken:n}){const a=X(),[t,l]=u.useState(null),[i,r]=u.useState(!1),s=u.useCallback(async({resetToken:y,newPassword:g})=>{l(null),r(!0);try{const p=await fetch(Fa("/auth/password-reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:y,password:g})});if(!p.ok){const f=await p.text();l(f);return}}catch{l(Mf);return}finally{r(()=>!1)}a(`/login?message=${encodeURIComponent("Password has been reset.")}`)},[l,a]),{control:c,handleSubmit:d,formState:{isDirty:m}}=Ue({defaultValues:{resetToken:n,newPassword:"",confirmPassword:""}});return o(G,{children:[t?e(K,{paddingBottom:"size-100",children:e(ue,{variant:"danger",children:t})}):null,o(Re,{onSubmit:d(s),children:[e(W,{name:"newPassword",control:c,rules:{required:"Password is required",minLength:{value:ga,message:`Password must be at least ${ga} characters`}},render:({field:{name:y,onChange:g,onBlur:p,value:f},fieldState:{invalid:k,error:b}})=>e(ae,{label:"New Password",type:"password",isRequired:!0,description:`Password must be at least ${ga} characters`,name:y,errorMessage:b==null?void 0:b.message,validationState:k?"invalid":"valid",onChange:g,onBlur:p,defaultValue:f})}),e(W,{name:"confirmPassword",control:c,rules:{required:"Password is required",minLength:{value:ga,message:`Password must be at least ${ga} characters`},validate:(y,g)=>y===g.newPassword||"Passwords do not match"},render:({field:{name:y,onChange:g,onBlur:p,value:f},fieldState:{invalid:k,error:b}})=>e(ae,{label:"Confirm Password",isRequired:!0,type:"password",description:"Confirm the new password",name:y,errorMessage:b==null?void 0:b.message,validationState:k?"invalid":"valid",onChange:g,onBlur:p,defaultValue:f})}),e("div",{css:C`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(z,{variant:m?"primary":"default",type:"submit",disabled:i,children:i?"Resetting...":"Reset Password"})})]})]})}function o1(){const n=X(),[a]=Sa(),t=a.get("token");return t?o(Za,{children:[e(h,{direction:"column",gap:"size-200",alignItems:"center",children:e(K,{paddingBottom:"size-200",children:e(qt,{})})}),e(Nf,{resetToken:t}),e(K,{paddingTop:"size-200",children:e(h,{direction:"column",alignItems:"center",justifyContent:"center",children:e(Ge,{to:"/login",children:"Back to Login"})})})]}):(n("/login"),null)}const fo=function(){var n=[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"resetPasswordLoaderQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"resetPasswordLoaderQuery",selections:n},params:{cacheID:"c97389cd896f3e1746d0adf67c759462",id:null,metadata:{},name:"resetPasswordLoaderQuery",operationKind:"query",text:`query resetPasswordLoaderQuery {
  viewer {
    id
    email
  }
}
`}}}();fo.hash="ccd75708c3ba7c1b283f7858dfa8d20e";async function d1(){const n=await D.fetchQuery(Me,fo,{}).toPromise();return n!=null&&n.viewer?n:Ma("/login")}function zf({onResetSent:n}){const[a,t]=u.useState(null),[l,i]=u.useState(!1),r=u.useCallback(async d=>{t(null),i(!0);try{const m=await fetch(Fa("/auth/password-reset-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(!m.ok){const y=await m.text();t(y);return}n()}finally{i(()=>!1)}},[n,t]),{control:s,handleSubmit:c}=Ue({defaultValues:{email:""}});return o(G,{children:[a?e(K,{paddingBottom:"size-100",children:e(ue,{variant:"danger",children:a})}):null,o(Re,{onSubmit:c(r),children:[e(W,{name:"email",control:s,render:({field:{onChange:d,value:m}})=>e(ae,{label:"Email",name:"email",isRequired:!0,type:"email",onChange:d,value:m,placeholder:"your email address",description:"Enter the email address associated with your account."})}),e("div",{css:C`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(z,{variant:"primary",type:"submit",loading:l,children:"Send"})})]})]})}function c1(){const[n,a]=u.useState(!1),t=n?o(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(ce,{level:1,children:"Check your email"}),e("p",{children:"Thanks! If an account with that email address exists, we sent you a link to reset your password."})]}):o(G,{children:[o(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(ce,{level:1,children:"Forgot Password"}),e("p",{children:`Enter the email address associated with your account and we'll send you
        a link to reset your password.`})]}),e(zf,{onResetSent:()=>a(!0)})]});return e(Za,{children:o("div",{css:C`
          & a {
            text-align: center;
            width: 100%;
            display: block;
            text-align: center;
            padding-top: var(--ac-global-dimension-size-200);
          }
        `,children:[t,e(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:e(Ge,{to:"/login",children:"Back to Login"})})]})})}const ho=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},l],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"572bf0f64678128defccf833e6a5d4ce",id:null,metadata:{},name:"ViewerAPIKeysCreateUserAPIKeyMutation",operationKind:"mutation",text:`mutation ViewerAPIKeysCreateUserAPIKeyMutation(
  $input: CreateUserApiKeyInput!
) {
  createUserApiKey(input: $input) {
    jwt
    apiKey {
      id
      user {
        ...APIKeysTableFragment
      }
    }
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}}();ho.hash="28061ae008e197468be6fd5f2775ccb0";const ko=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[t,l,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[t,l,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"f28a00e7a6eb2e18b1f8b31c8231c2b7",id:null,metadata:{},name:"APIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    __typename
    apiKeyId
    query {
      ...UserAPIKeysTableFragment
    }
  }
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      email
    }
  }
}
`}}}();ko.hash="3a505d9d13944798a57fc873ddf0992d";const bo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"TypeDiscriminator",abstractKey:"__isNode"},t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}]},params:{cacheID:"e677b5974fa137ac3a26acde353767d8",id:null,metadata:{},name:"APIKeysTableQuery",operationKind:"query",text:`query APIKeysTableQuery(
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...APIKeysTableFragment
    __isNode: __typename
    id
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}}();bo.hash="6c32098d55e4cba859dcec73f3ccd28c";const So=function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:bo,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"APIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},n],type:"User",abstractKey:null}}();So.hash="6c32098d55e4cba859dcec73f3ccd28c";const vl=70;function Vf({query:n}){const[a,t]=D.useRefetchableFragment(So,n),l=xe(),[i]=D.useMutation(ko),r=u.useCallback(g=>{i({variables:{input:{id:g}},onCompleted:()=>{l({title:"API key deleted",message:"The key has been deleted and is no longer active."}),u.startTransition(()=>{t({},{fetchPolicy:"network-only"})})}})},[i,l,t]),s=u.useMemo(()=>[...a.apiKeys],[a]),c=u.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:fe},{header:"Description",accessorKey:"description",cell:fe},{header:"Created At",accessorKey:"createdAt",size:vl,cell:Ee},{header:"Expires At",accessorKey:"expiresAt",size:vl,cell:Ee},{header:"",accessorKey:"id",size:10,cell:({row:p})=>e(h,{direction:"row",justifyContent:"end",width:"100%",children:e(_t,{handleDelete:()=>{r(p.original.id)}})}),meta:{textAlign:"right"}}],[r]),d=Fe({columns:c,data:s,getCoreRowModel:Ke()}),m=d.getRowModel().rows,y=d.getRowModel().rows.length===0;return o("table",{css:nn,children:[e("thead",{children:d.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(p=>e("th",{colSpan:p.colSpan,children:p.isPlaceholder?null:o("div",{className:p.column.getCanSort()?"cursor-pointer":"",onClick:p.column.getToggleSortingHandler(),style:{left:p.getStart(),width:p.getSize()},children:[J(p.column.columnDef.header,p.getContext()),p.column.getIsSorted()?e(L,{className:"sort-icon",svg:p.column.getIsSorted()==="asc"?e(I.ArrowUpFilled,{}):e(I.ArrowDownFilled,{})}):null]})},p.id))},g.id))}),y?e(an,{message:"No Keys"}):e("tbody",{children:m.map(g=>e("tr",{children:g.getVisibleCells().map(p=>e("td",{children:J(p.column.columnDef.cell,p.getContext())},p.id))},g.id))})]})}function $f({viewer:n}){const[a,t]=u.useState(null),l=ve(),[i,r]=D.useMutation(ho),s=u.useCallback(c=>{i({variables:{input:{...c,expiresAt:c.expiresAt||null}},onCompleted:d=>{t(e(ri,{jwt:d.createUserApiKey.jwt}))},onError:d=>{l({title:"Error creating API key",message:d.message})}})},[i,l]);return o(q,{title:"API Keys",variant:"compact",bodyStyle:{padding:0},extra:e(z,{variant:"default",size:"compact",icon:e(L,{svg:e(I.PlusCircleOutline,{})}),onClick:()=>t(e(si,{onSubmit:s,isCommitting:r})),children:"New Key"}),children:[e(Vf,{query:n}),e(ee,{onDismiss:()=>{t(null)},children:a})]})}const vo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerProfileCardMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerProfileCardMutation",selections:a},params:{cacheID:"03f161df42c71b5924a8ee665e01cdce",id:null,metadata:{},name:"ViewerProfileCardMutation",operationKind:"mutation",text:`mutation ViewerProfileCardMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}}();vo.hash="4a11ca65151d84fe95f636763c91dc68";function Of(){const{viewer:n,refetchViewer:a}=ci(),t=ve(),l=xe(),[i,r]=D.useMutation(vo),s=X(),{control:c,handleSubmit:d,formState:{isDirty:m},reset:y}=Ue({defaultValues:{username:(n==null?void 0:n.username)||""}}),g=u.useCallback(p=>{i({variables:{input:{newUsername:p.username}},onCompleted:()=>{l({title:"Profile updated",message:"Your profile has been updated"}),y({username:p.username}),a()},onError:f=>{t({title:"Failed update profile",message:f.message})}})},[i,l,y,a,t]);return n?o(q,{title:"Profile",variant:"compact",bodyStyle:{padding:0},extra:n.authMethod==="LOCAL"&&e(z,{variant:"default",size:"compact",onClick:()=>{s("/reset-password")},children:"Reset Password"}),children:[e(K,{paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",children:o(h,{direction:"row",gap:"size-200",alignItems:"center",children:[e(oi,{name:n.username||n.email,profilePictureUrl:n.profilePictureUrl}),o(h,{direction:"column",gap:"size-50",children:[e(ce,{level:2,weight:"heavy",children:n.username||n.email}),e(x,{children:n.role.name.toLocaleLowerCase()})]})]})}),e(K,{children:o(Re,{onSubmit:d(g),children:[o(K,{padding:"size-200",children:[e(ae,{label:"Email",value:n.email,isReadOnly:!0}),e(W,{name:"username",control:c,rules:{required:"A username is required as it needs to be unique"},render:({field:{name:p,onChange:f,onBlur:k,value:b},fieldState:{invalid:S,error:v}})=>e(ae,{label:"Username",isRequired:!0,description:"A unique username",name:p,errorMessage:v==null?void 0:v.message,validationState:S?"invalid":"valid",onChange:f,onBlur:k,defaultValue:b})})]}),e(K,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderTopColor:"dark",borderTopWidth:"thin",children:e(h,{direction:"row",gap:"size-100",justifyContent:"end",children:e(z,{variant:m?"primary":"default",size:"compact",disabled:!m,onClick:()=>{d(g)()},children:r?"Saving...":"Save"})})})]})})]}):null}const Qf=C`
  overflow-y: auto;
`,jf=C`
  padding: var(--ac-global-dimension-size-400);
  max-width: 800px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`;function u1(){const{viewer:n}=ci();return n?e("main",{css:Qf,children:e("div",{css:jf,children:o(h,{direction:"column",gap:"size-200",children:[e(Of,{}),e($f,{viewer:n})]})})}):null}const Co=function(){var n=[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PlaygroundQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PlaygroundQuery",selections:n},params:{cacheID:"f19ebe151a3a9794fa2566c66751d259",id:null,metadata:{},name:"PlaygroundQuery",operationKind:"query",text:`query PlaygroundQuery {
  modelProviders {
    name
    dependenciesInstalled
    dependencies
  }
}
`}}}();Co.hash="9802d9d44657ca300abc1be4d0938560";const Ut=u.createContext(null);function qf({children:n,...a}){const[t]=u.useState(()=>Lc(a));return e(Ut.Provider,{value:t,children:n})}function O(n,a){const t=Se.useContext(Ut);if(!t)throw new Error("Missing PlaygroundContext.Provider in the tree");return ba(t,n,a)}function Fo(){const n=Se.useContext(Ut);if(!n)throw new Error("Missing PlaygroundContext.Provider in the tree");return n}const Uf=`
The playground is not available until an LLM provider client is installed on the server.
`,Bf=n=>`
# Installing one or more of the clients will enable the playground
${Array.from(n.reduce((a,t)=>(t.dependencies.forEach(l=>a.add(l)),a),new Set)).map(a=>`pip install ${a}`).join(`
`)}
`,Hf=n=>e(K,{height:"100%",width:"100%",children:o(h,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:[e(ql,{message:Uf,graphicKey:"not found",size:"L"}),e(x,{children:"The following clients are supported:"}),e(wc,{value:Bf(n.availableProviders)})]})}),Gf={OPENAI:"OPENAI_API_KEY",ANTHROPIC:"ANTHROPIC_API_KEY",AZURE_OPENAI:"AZURE_OPENAI_API_KEY",GEMINI:"GEMINI_API_KEY"};function Wf(){const n=O(s=>Array.from(new Set(s.instances.map(c=>c.model.provider)))),a=O(s=>s.instances.some(c=>c.activeRunId!=null)),t=Va(s=>s.setCredential),l=Va(s=>s),[i,r]=u.useState(!1);return e("div",{css:C`
        .ac-dropdown-button {
          min-width: 0px;
        }
      `,children:o(Zn,{placement:"bottom",isOpen:i,onOpenChange:s=>{r(s)},children:[e(Ft,{size:"compact",isDisabled:a,children:"API Keys"}),e(Oa,{children:e(K,{padding:"size-200",children:o(Re,{onSubmit:s=>{s.preventDefault(),r(!1)},children:[e(ce,{level:2,weight:"heavy",children:"API Keys"}),e(x,{color:"text-700",children:"API keys are stored in your browser and used to communicate with their respective API's."}),e(h,{direction:"column",gap:"size-100",children:n.map(s=>{const c=Gf[s];return e(ae,{label:c,type:"password",isRequired:!0,onChange:d=>{t({provider:s,value:d})},value:l[s],description:`Alternatively, you can set the "${c}" environment variable on the phoenix server.`},s)})})]})})})]})})}const Cl=30,Jf=C`
  display: flex;
  direction: row;
  align-items: center;
  .ac-dropdown > button {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
    height: ${Cl}px;
  }
  .ac-button {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
    border-left: none;
    height: ${Cl}px;
  }
`;function Zf(){const n=X(),{datasetId:a}=Ve(),t=a??"";return o("div",{css:Jf,children:[e(Wl,{size:"compact",placeholder:"Test over a dataset",selectedKey:t,onSelectionChange:l=>{if(t!==null&&l===t){n("/playground");return}n(`/playground/datasets/${l}`)}}),e(z,{size:"compact",variant:"default",icon:e(L,{svg:e(I.CloseOutline,{})}),onClick:()=>{n("/playground")}})]})}const Ko=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetSectionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetSectionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"c36833ac260163836d9810cf8e137380",id:null,metadata:{},name:"PlaygroundDatasetSectionQuery",operationKind:"query",text:`query PlaygroundDatasetSectionQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      name
      exampleCount
    }
    __isNode: __typename
    id
  }
}
`}}}();Ko.hash="38aaf5a39c06500e51a82c91a9e27408";const xo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionOverDatasetMutationPayload",kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionOverDatasetMutationExamplePayload",kind:"LinkedField",name:"examples",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentRunId",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"result",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionMutationError",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[t,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ChatCompletionMutationPayload",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableMutation",selections:l},params:{cacheID:"4697f7aaa22729dbf83970ce9ae6475b",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableMutation",operationKind:"mutation",text:`mutation PlaygroundDatasetExamplesTableMutation(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    __typename
    experimentId
    examples {
      datasetExampleId
      experimentRunId
      result {
        __typename
        ... on ChatCompletionMutationError {
          message
        }
        ... on ChatCompletionMutationPayload {
          content
          errorMessage
          span {
            id
            tokenCountCompletion
            tokenCountPrompt
            tokenCountTotal
            latencyMs
            project {
              id
            }
            context {
              traceId
            }
          }
          toolCalls {
            id
            function {
              name
              arguments
            }
          }
        }
      }
    }
  }
}
`}}}();xo.hash="c15f93fe1380986536971620c3bf3a11";const To=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[t],i=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},a],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[t,a,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"experiment",plural:!1,selections:l,storageKey:null}],type:"ChatCompletionSubscriptionExperiment",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"experimentRun",plural:!1,selections:l,storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableSubscription",selections:i,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableSubscription",selections:i},params:{cacheID:"3759bfb17a93aa0cf227c4ef7fa6cd30",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableSubscription",operationKind:"subscription",text:`subscription PlaygroundDatasetExamplesTableSubscription(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    __typename
    ... on TextChunk {
      content
      datasetExampleId
    }
    ... on ToolCallChunk {
      id
      datasetExampleId
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionExperiment {
      experiment {
        id
      }
    }
    ... on ChatCompletionSubscriptionResult {
      datasetExampleId
      span {
        id
        tokenCountCompletion
        tokenCountPrompt
        tokenCountTotal
        latencyMs
        project {
          id
        }
        context {
          traceId
        }
      }
      experimentRun {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      datasetExampleId
      message
    }
  }
}
`}}}();To.hash="f1df5c75f1a62acde69f3f5d676f9213";const Io=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:20,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:t,kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"TypeDiscriminator",abstractKey:"__isNode"},i,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:["datasetVersionId"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"fc176d05790f6c690eead96a6ece1c50",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableRefetchQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableRefetchQuery(
  $after: String = null
  $datasetVersionId: GlobalID
  $first: Int = 20
  $id: GlobalID!
) {
  node(id: $id) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment_4a6F8Z
    __isNode: __typename
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment_4a6F8Z on Dataset {
  examples(datasetVersionId: $datasetVersionId, first: $first, after: $after) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Io.hash="ae68770500a29b14f7108d56c146fb99";const Do=function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:20,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Io,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"PlaygroundDatasetExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__PlaygroundDatasetExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}}();Do.hash="ae68770500a29b14f7108d56c146fb99";const Po=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:20}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"examples(first:20)"},{alias:null,args:i,filters:["datasetVersionId"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"795ea41682593e1fedd5ced3252f7602",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableQuery(
  $datasetId: GlobalID!
) {
  dataset: node(id: $datasetId) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment
    __isNode: __typename
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment on Dataset {
  examples(first: 20) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}}();Po.hash="f809b3d539d0032d9681a4a4450b1d6f";const Yf=n=>typeof n=="object"&&n!==null&&typeof n.message=="string",Xf=/['"']message['"']:\s*['"']([^'"']+)['"']/g,Lo=n=>{if(!Yf(n))return null;const a=n.message;if(typeof a!="string")return null;const t=[...a.matchAll(Xf)].map(l=>l[1]);return t.length>0?t:null},eh=n=>{const a=n;return typeof a=="object"&&a!==null&&typeof a.source=="object"&&a.source!==null&&Array.isArray(a.source.errors)&&a.source.errors.every(t=>typeof t=="object"&&t!==null&&typeof t.message=="string")},nh=n=>Array.isArray(n)&&n.every(a=>typeof a=="object"&&a!==null&&typeof a.message=="string"),wo=n=>eh(n)?n.source.errors.map(a=>a.message):nh(n)?n.map(a=>a.message):null,ah=()=>{const n=(a,t)=>({exampleResponsesMap:{},updateExampleData:({instanceId:l,exampleId:i,patch:r})=>{const s=t().exampleResponsesMap,c=s[l]??{},d=c[i]??{};a({exampleResponsesMap:{...s,[l]:{...c,[i]:{...d,...r}}}})},appendExampleDataTextChunk:({instanceId:l,exampleId:i,textChunk:r})=>{const s=t().exampleResponsesMap,c=s[l]??{},d=c[i]??{},m=d.content??"";a({exampleResponsesMap:{...s,[l]:{...c,[i]:{...d,content:m+r}}}})},appendExampleDataToolCallChunk:({instanceId:l,exampleId:i,toolCallChunk:r})=>{var k;const s=t().exampleResponsesMap,c=s[l]??{},d=c[i]??{},m=d.toolCalls??{},{id:y,function:g}=r,p=m[y],f={...p,id:y,function:{name:((k=p==null?void 0:p.function)==null?void 0:k.name)??g.name,arguments:(p==null?void 0:p.function.arguments)!=null?p.function.arguments+g.arguments:g.arguments}};a({exampleResponsesMap:{...s,[l]:{...c,[i]:{...d,toolCalls:{...m,[y]:f}}}}})},setExampleDataForInstance:({instanceId:l,data:i})=>{const r=t().exampleResponsesMap;a({exampleResponsesMap:{...r,[l]:i}})},resetExampleData:()=>{a({exampleResponsesMap:{}})}});return Il()(n)},Eo=Se.createContext(null);function th({children:n}){const[a]=u.useState(()=>ah());return e(Eo.Provider,{value:a,children:n})}function Hn(n,a){const t=Se.useContext(Eo);if(!t)throw new Error("Missing PlaygroundDatasetExamplesTableContext.Provider in the tree");return ba(t,n,a)}function Bt({children:n}){return o(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(I.AlertCircleOutline,{}),color:"danger"}),e(x,{color:"danger",children:n})]})}const _o=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"runId"}],a=[{kind:"Variable",name:"id",variableName:"runId"}],t={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={kind:"InlineFragment",selections:[t,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[l,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"ExperimentRun",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundExperimentRunDetailsDialogQuery",selections:[{alias:"run",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundExperimentRunDetailsDialogQuery",selections:[{alias:"run",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l],storageKey:null}]},params:{cacheID:"1e3277995e47da369d84557def1a62bf",id:null,metadata:{},name:"PlaygroundExperimentRunDetailsDialogQuery",operationKind:"query",text:`query PlaygroundExperimentRunDetailsDialogQuery(
  $runId: GlobalID!
) {
  run: node(id: $runId) {
    __typename
    ... on ExperimentRun {
      output
      startTime
      endTime
      error
      example {
        id
        revision {
          input
          output
        }
      }
      annotations {
        edges {
          annotation: node {
            id
            name
            label
            score
            explanation
            annotatorKind
          }
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();_o.hash="2eee337b0f8c4e738dd6580efa1e3c96";function lh({runId:n}){var c,d,m;const t=D.useLazyLoadQuery(_o,{runId:n}).run,l=(c=t.example)==null?void 0:c.id,i=(d=t.example)==null?void 0:d.revision,r=i==null?void 0:i.input,s=i==null?void 0:i.output;return e(Z,{title:`Experiment Run for Example: ${l}`,size:"fullscreen",children:o(on,{direction:"vertical",autoSaveId:"example-compare-panel-group",children:[e(ke,{defaultSize:33,children:e(K,{overflow:"auto",height:"100%",padding:"size-200",children:o(h,{direction:"row",gap:"size-200",flex:"1 1 auto",children:[e(K,{width:"50%",children:e(q,{title:"Input",...Fl,bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},extra:e(se,{text:JSON.stringify(r)}),children:e(rn,{value:JSON.stringify(r,null,2)})})}),e(K,{width:"50%",children:e(q,{title:"Reference Output",...Fl,extra:e(se,{text:JSON.stringify(s)}),bodyStyle:{padding:0,maxHeight:"300px",overflowY:"auto"},children:e(rn,{value:JSON.stringify(s,null,2)})})})]})})}),e(sn,{css:bn}),e(ke,{defaultSize:67,children:o(h,{direction:"column",height:"100%",children:[e(K,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(ce,{level:2,children:"Experiment Run Output"})}),e("div",{css:C`
                overflow-y: auto;
                height: 100%;
                padding: var(--ac-global-dimension-static-size-200);
              `,children:o(h,{direction:"row",children:[e(K,{flex:!0,children:t.error?e(K,{padding:"size-200",children:e(rh,{error:t.error})}):e(rn,{value:JSON.stringify(t.output,null,2)})}),o(Dn,{width:"size-3000",children:[t.startTime&&t.endTime&&e(ih,{startTime:t.startTime,endTime:t.endTime}),e("ul",{css:C`
                      margin-top: var(--ac-global-dimension-static-size-100);
                      display: flex;
                      flex-direction: column;
                      justify-content: flex-start;
                      align-items: flex-end;
                      gap: var(--ac-global-dimension-static-size-100);
                    `,children:(m=t.annotations)==null?void 0:m.edges.map(y=>e("li",{children:e(un,{annotation:y.annotation})},y.annotation.id))})]})]})})]})})]})})}function ih({startTime:n,endTime:a}){const t=u.useMemo(()=>{let l=null;return n&&a&&(l=new Date(a).getTime()-new Date(n).getTime()),l},[n,a]);return t===null?null:e(Ce,{latencyMs:t})}function rh({error:n}){return o(h,{direction:"row",gap:"size-50",alignItems:"center",children:[e(L,{svg:e(I.AlertCircleOutline,{}),color:"danger"}),e(x,{color:"danger",children:n})]})}const Fl={backgroundColor:"light",borderColor:"light",variant:"compact",collapsible:!0,bodyStyle:{padding:0}};function Ro({traceId:n,projectId:a,title:t}){const l=X();return e(Z,{title:t,size:"fullscreen",extra:e(z,{variant:"default",onClick:()=>l(`/projects/${a}/traces/${n}`),children:"View Trace in Project"}),children:e(Ot,{traceId:n,projectId:a})})}const sh=n=>{const a=n;return yn(a.function)?typeof a.function.arguments=="string":!1};function Ao({toolCall:n}){const a=u.useMemo(()=>{const{provider:t,validatedToolCall:l}=Ec(n);switch(t){case"OPENAI":case"AZURE_OPENAI":return{name:l.function.name,input:l.function.arguments};case"ANTHROPIC":return{name:l.name,input:l.input};case"UNKNOWN":{if(!sh(n))return null;const{json:i}=Ae(n.function.arguments);return{name:n.function.name??"",input:yn(i)?i:n.function.arguments}}default:return me()}},[n]);return a==null?o(x,{children:["Invalid tool call format: ",JSON.stringify(n)]}):o("pre",{css:C`
        text-wrap: wrap;
        margin: var(--ac-global-dimension-static-size-100) 0;
      `,children:[a.name,"(",typeof a.input=="string"?a.input:JSON.stringify(a.input,null,2),")"]})}const oh=10,dh=n=>n.examples.reduce((a,t)=>{const{datasetExampleId:l,result:i,experimentRunId:r}=t,s={experimentRunId:r};switch(i.__typename){case"ChatCompletionMutationError":return{...a,[l]:{...s,errorMessage:i.message}};case"ChatCompletionMutationPayload":{const{errorMessage:c,content:d,span:m,toolCalls:y}=i;return{...a,[l]:{...s,span:m,content:d,errorMessage:c,toolCalls:y.reduce((g,p)=>(g[p.id]=p,g),{})}}}case"%other":return a;default:me()}},{}),ch=C`
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: center;
  height: 100%;
  min-height: 75px;
  padding: var(--ac-global-dimension-static-size-200);
  .controls {
    transition: opacity 0.2s ease-in-out;
    opacity: 0;
    display: none;
    z-index: 1;
  }
  &:hover .controls {
    opacity: 1;
    display: flex;
    // make them stand out
    .ac-button {
      border-color: var(--ac-global-color-primary);
    }
  }
`,uh=C`
  position: absolute;
  top: -4px;
  right: var(--ac-global-dimension-static-size-100);
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-static-size-100);
`;function Mo(n){return o("div",{css:ch,children:[n.children,e("div",{css:uh,className:"controls",children:n.controls})]})}function No({children:n}){return e("div",{css:C`
        max-height: 300px;
        overflow-y: auto;
        padding: var(--ac-global-dimension-static-size-100)
          var(--ac-global-dimension-static-size-200);
      `,children:n})}function mh({getValue:n,collapseSingleKey:a}){const t=n();return e(No,{children:e(Ka,{json:t,space:2,collapseSingleKey:a})})}function gh({isRunning:n,instanceVariables:a,datasetExampleInput:t}){const l=u.useMemo(()=>{const i=yn(t)?t:{};return a.filter(r=>i[r]==null)},[t,a]);return n?e(ye,{}):l.length===0?null:e(Bt,{children:`Missing input for variable${l.length>1?"s":""}: ${l.join(", ")}`})}function ph({exampleData:n,setDialog:a}){const{span:t,content:l,toolCalls:i,errorMessage:r,experimentRunId:s}=n,c=t!=null,d=s!=null,m=u.useMemo(()=>{if(c||d)return o(G,{children:[d&&o(pe,{children:[e(z,{variant:"default",size:"compact","aria-label":"View experiment run details",icon:e(L,{svg:e(I.ExpandOutline,{})}),onClick:y=>{y.preventDefault(),y.stopPropagation(),u.startTransition(()=>{a(e(lh,{runId:s}))})}}),e(Ie,{children:"View run details"})]}),c&&e(G,{children:o(pe,{children:[e(z,{variant:"default",size:"compact","aria-label":"View run trace",icon:e(L,{svg:e(I.Trace,{})}),onClick:y=>{y.preventDefault(),y.stopPropagation(),u.startTransition(()=>{a(e(Ro,{traceId:t.context.traceId,projectId:t.project.id,title:"Experiment Run Trace"}))})}}),e(Ie,{children:"View Trace"})]})})]})},[s,d,c,a,t]);return e(Mo,{controls:m,children:o(h,{direction:"column",gap:"size-200",children:[r!=null?e(Bt,{children:r}):null,e(x,{children:l}),i!=null?Object.values(i).map(y=>y==null?null:e(Ao,{toolCall:y},y.id)):null,c?e(fh,{span:t}):null]})})}const yh=u.memo(function({isRunning:a,instanceId:t,exampleId:l,setDialog:i,instanceVariables:r,datasetExampleInput:s}){const c=Hn(d=>{var m;return(m=d.exampleResponsesMap[t])==null?void 0:m[l]});return c==null?e(gh,{isRunning:a,instanceVariables:r,datasetExampleInput:s}):e(ph,{exampleData:c,setDialog:i})});function fh({span:n}){return o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Sn,{tokenCountTotal:n.tokenCountTotal||0,tokenCountPrompt:n.tokenCountPrompt||0,tokenCountCompletion:n.tokenCountCompletion||0}),e(Ce,{latencyMs:n.latencyMs||0})]})}function zo({table:n}){return e("tbody",{children:n.getRowModel().rows.map(a=>e("tr",{children:a.getVisibleCells().map(t=>e("td",{style:{padding:0,height:1,width:`calc(var(--col-${t.column.id}-size) * 1px)`,wordBreak:"break-all"},children:J(t.column.columnDef.cell,t.getContext())},t.id))},a.id))})}const hh=Se.memo(zo,(n,a)=>n.table.options.data===a.table.options.data);function kh({datasetId:n}){const a=D.useRelayEnvironment(),t=O($=>$.instances),l=O($=>$.templateLanguage),i=O($=>$.updateInstance),r=Hn($=>$.updateExampleData),s=Hn($=>$.setExampleDataForInstance),c=Hn($=>$.resetExampleData),d=Hn($=>$.appendExampleDataToolCallChunk),m=Hn($=>$.appendExampleDataTextChunk),[y,g]=u.useState(null),p=X(),f=t.some($=>$.activeRunId!==null),k=Va($=>$),b=O($=>$.markPlaygroundInstanceComplete),S=Fo(),v=ve(),P=u.useCallback($=>re=>{var he;if(re==null)return;const Y=re.chatCompletionOverDataset;switch(Y.__typename){case"ChatCompletionSubscriptionExperiment":i({instanceId:$,patch:{experimentId:Y.experiment.id}});break;case"ChatCompletionSubscriptionResult":if(Y.datasetExampleId==null)return;r({instanceId:$,exampleId:Y.datasetExampleId,patch:{span:Y.span,experimentRunId:(he=Y.experimentRun)==null?void 0:he.id}});break;case"ChatCompletionSubscriptionError":if(Y.datasetExampleId==null)return;r({instanceId:$,exampleId:Y.datasetExampleId,patch:{errorMessage:Y.message}});break;case"TextChunk":if(Y.datasetExampleId==null)return;m({instanceId:$,exampleId:Y.datasetExampleId,textChunk:Y.content});break;case"ToolCallChunk":{if(Y.datasetExampleId==null)return;d({instanceId:$,exampleId:Y.datasetExampleId,toolCallChunk:Y});break}case"%other":return;default:return me()}},[m,d,r,i]),[E]=D.useMutation(xo),R=u.useCallback($=>(re,Y)=>{if(b($),Y){v({title:"Chat completion failed",message:Y[0].message});return}i({instanceId:$,patch:{experimentId:re.chatCompletionOverDataset.experimentId}}),s({instanceId:$,data:dh(re.chatCompletionOverDataset)})},[b,v,s,i]);u.useEffect(()=>{if(!f)return;const{instances:$,streaming:re,updateInstance:Y}=S.getState();if(c(),re){const he=[];for(const Te of $){const{activeRunId:Ya}=Te;if(Y({instanceId:Te.id,patch:{experimentId:null}}),Ya===null)continue;const Xa={input:tl({credentials:k,instanceId:Te.id,playgroundStore:S,datasetId:n})},et={subscription:To,variables:Xa,onNext:P(Te.id),onCompleted:()=>{b(Te.id)},onError:jn=>{b(Te.id);const nt=wo(jn);nt!=null&&nt.length>0?v({title:"Failed to get output",message:nt.join(`
`),expireMs:1e4}):v({title:"Failed to get output",message:jn.message,expireMs:1e4})}},Ia=St.requestSubscription(a,et);he.push(Ia)}return()=>{for(const Te of he)Te.dispose()}}else{const he=[];for(const Te of $){const{activeRunId:Ya}=Te;if(Ya===null)continue;Y({instanceId:Te.id,patch:{experimentId:null}});const Xa={input:tl({credentials:k,instanceId:Te.id,playgroundStore:S,datasetId:n})},et=E({variables:Xa,onCompleted:R(Te.id),onError(Ia){b(Te.id);const jn=Lo(Ia);jn!=null&&jn.length>0?v({title:"Failed to get output",message:jn.join(`
`),expireMs:1e4}):v({title:"Failed to get output",message:Ia.message,expireMs:1e4})}});he.push(et)}return()=>{for(const Te of he)Te.dispose()}}},[k,n,a,E,f,b,v,R,P,S,c]);const{dataset:F}=D.useLazyLoadQuery(Po,{datasetId:n}),T=u.useRef(null),{data:w,loadNext:_,hasNext:Q,isLoadingNext:V}=D.usePaginationFragment(Do,F),H=u.useMemo(()=>w.examples.edges.map($=>{const re=$.example,Y=re.revision;return{id:re.id,input:Y.input,output:Y.output}}),[w]),te=u.useMemo(()=>t.map(($,re)=>{const Y=Ci({instance:$,templateLanguage:l});return{id:`instance-${$.id}`,header:()=>o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Rt,{index:re}),e("span",{children:"Output"})]}),cell:({row:he})=>e(yh,{instanceId:$.id,exampleId:he.original.id,isRunning:f,setDialog:g,instanceVariables:Y,datasetExampleInput:he.original.input}),size:500}}),[f,t,l]),oe=[{header:"input",accessorKey:"input",cell:({row:$})=>e(Mo,{controls:o(pe,{children:[e(z,{variant:"default",size:"compact","aria-label":"View example details",icon:e(L,{svg:e(I.ExpandOutline,{})}),onClick:()=>{p(`/playground/datasets/${n}/examples/${$.original.id}`)}}),e(Ie,{children:"View Example"})]}),children:e(No,{children:e(Ka,{json:$.original.input,disableTitle:!0,space:2,collapseSingleKey:!1})})}),size:200},{header:"reference output",accessorKey:"output",cell:$=>mh({...$,collapseSingleKey:!0}),size:200},...te],N=Fe({columns:oe,data:H,getCoreRowModel:Ke(),columnResizeMode:"onChange"}),M=N.getRowModel().rows.length===0,U=u.useCallback($=>{if($){const{scrollHeight:re,scrollTop:Y,clientHeight:he}=$;re-Y-he<300&&!V&&Q&&_(oh)}},[Q,V,_]),ie=Se.useMemo(()=>{const $=N.getFlatHeaders(),re={};for(let Y=0;Y<$.length;Y++){const he=$[Y];re[`--header-${he.id}-size`]=he.getSize(),re[`--col-${he.column.id}-size`]=he.column.getSize()}return re},[N.getState().columnSizingInfo,N.getState().columnSizing,oe.length]);return o("div",{css:C`
        flex: 1 1 auto;
        overflow: auto;
        height: 100%;
      `,ref:T,onScroll:$=>U($.target),children:[o("table",{css:$=>C(nn($),ii),style:{...ie,width:N.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:N.getHeaderGroups().map($=>e("tr",{children:$.headers.map(re=>o("th",{style:{width:`calc(var(--header-${re==null?void 0:re.id}-size) * 1px)`},children:[e("div",{children:J(re.column.columnDef.header,re.getContext())}),e("div",{onMouseDown:re.getResizeHandler(),onTouchStart:re.getResizeHandler(),className:`resizer ${re.column.getIsResizing()?"isResizing":""}`})]},re.id))},$.id))}),M?e(an,{}):N.getState().columnSizingInfo.isResizingColumn?e(hh,{table:N}):e(zo,{table:N})]}),e(ee,{isDismissable:!0,type:"slideOver",onDismiss:()=>{g(null)},children:y})]})}function bh(){return o("span",{css:C`
        color: var(--ac-global-text-color-700);
        display: inline-flex;
        .dots {
          display: inline-block;
          width: 3ch;
          overflow: hidden;
        }

        .dots::after {
          content: "...";
          display: inline-block;
          animation: dots 1.5s steps(4) infinite;
        }

        @keyframes dots {
          0% {
            content: "";
          }
          25% {
            content: ".";
          }
          50% {
            content: "..";
          }
          75% {
            content: "...";
          }
        }
      `,children:["Run in progress",e("span",{className:"dots"})]})}function Sh({datasetId:n}){const a=O(s=>s.instances),t=a.some(s=>s.activeRunId!=null),l=u.useMemo(()=>a.map(s=>s.experimentId).filter(s=>s!=null),[a]),i=X(),r=D.useLazyLoadQuery(Ko,{datasetId:n});return o(h,{direction:"column",height:"100%",children:[e(K,{backgroundColor:"dark",paddingX:"size-200",paddingY:"size-100",borderBottomColor:"light",borderBottomWidth:"thin",children:o(h,{justifyContent:"space-between",alignItems:"center",children:[o(h,{gap:"size-100",children:[o(x,{children:[r.dataset.name??"Dataset"," results"]}),r.dataset.exampleCount!=null?o(x,{fontStyle:"italic",color:"text-700",children:[r.dataset.exampleCount," examples"]}):null]}),o(h,{gap:"size-100",alignItems:"center",children:[t&&e(bh,{}),l.length>0&&e(z,{size:"compact",variant:"default",disabled:t,loading:t,icon:e(L,{svg:e(I.ExperimentOutline,{})}),onClick:()=>{i(`/datasets/${n}/compare?experimentId=${l.join("&experimentId=")}`)},children:o(h,{gap:"size-100",alignItems:"center",children:["View Experiment",a.length>1?"s":""]})})]})]})}),e(th,{children:e(kh,{datasetId:n})})]})}const vh=()=>{const n=O(r=>r.input),a=O(r=>r.instances),t=O(r=>r.templateLanguage),{variableKeys:l,variablesMap:i}=u.useMemo(()=>Fi({instances:a,templateLanguage:t,input:n}),[n,a,t]);return{variableKeys:l,variablesMap:i}},Ch={lineNumbers:!1,highlightActiveLine:!1,foldGutter:!1,highlightActiveLineGutter:!1,bracketMatching:!1,syntaxHighlighting:!1},Fh=[yi.lineWrapping],Kh=({label:n,value:a,onChange:t})=>{const{theme:l}=On();return e(Vn,{label:n,children:e(Ne,{width:"100%",children:e(ia,{theme:l==="light"?eu:ra,basicSetup:Ch,value:a,extensions:Fh,onChange:t})})})};function xh(){const{variableKeys:n,variablesMap:a}=vh(),t=O(i=>i.setVariableValue),l=O(i=>i.templateLanguage);if(n.length===0){let i="";switch(l){case"F_STRING":{i="{input name}";break}case"MUSTACHE":{i="{{input name}}";break}case"NONE":return null;default:me()}return e(K,{padding:"size-100",children:e(h,{direction:"column",justifyContent:"center",alignItems:"center",children:o(x,{color:"text-700",children:["Add variable inputs to your prompt using"," ",e(x,{color:"text-900",children:i})," within your prompt template."]})})})}return e(h,{direction:"column",gap:"size-200",width:"100%",children:n.map((i,r)=>e(Kh,{label:i,value:a[i],onChange:s=>t(i,s)},r))})}const Vo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionMutationPayload",kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[a,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputMutation",selections:t},params:{cacheID:"9dc63d3e40081b276c1cbd5f21405c6f",id:null,metadata:{},name:"PlaygroundOutputMutation",operationKind:"mutation",text:`mutation PlaygroundOutputMutation(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    content
    errorMessage
    span {
      id
    }
    toolCalls {
      id
      function {
        name
        arguments
      }
    }
  }
}
`}}}();Vo.hash="085e7cb2bebd2c6c6e44b511364c6dd9";const $o=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null}],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputSubscription",selections:t,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputSubscription",selections:t},params:{cacheID:"aca7bf342ad2dc5db66b07e236a68268",id:null,metadata:{},name:"PlaygroundOutputSubscription",operationKind:"subscription",text:`subscription PlaygroundOutputSubscription(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    ... on TextChunk {
      content
    }
    ... on ToolCallChunk {
      id
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionResult {
      span {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      message
    }
  }
}
`}}}();$o.hash="bb5936a61a0e99dbb4a298a6e552a01c";const Th=({instance:n,outputContent:a,toolCalls:t,cleanupOutput:l})=>{const i=n.id,r=O(s=>s.updateInstance);return o(pe,{delay:500,offset:10,children:[e(z,{variant:"default",size:"compact",icon:e(L,{svg:e(I.PlusCircleOutline,{})}),"aria-label":"Move the output message to the end of the prompt",onClick:s=>{if(s.stopPropagation(),n.template.__type!=="chat")return;const c=Array.isArray(a)?a:a?[{id:fa(),role:za("ai"),content:a}]:[];t.length>0&&c.push({id:fa(),role:za("ai"),toolCalls:ui({provider:n.model.provider,toolCalls:t.map(d=>{var m;return{...d,function:{...d.function,arguments:((m=Ae(d.function.arguments))==null?void 0:m.json)??d.function.arguments}}})})}),r({instanceId:i,patch:{template:{__type:"chat",messages:[...n.template.messages,...c]}}}),l()},children:"Prompt"}),e(Ie,{children:"Move the output message to the end of the prompt"})]})},Oo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountCompletion",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountPrompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"bee4b51bd781a58c87fd283a966776f6",id:null,metadata:{},name:"RunMetadataFooterQuery",operationKind:"query",text:`query RunMetadataFooterQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    id
    ... on Span {
      project {
        id
      }
      context {
        traceId
        spanId
      }
      tokenCountCompletion
      tokenCountPrompt
      tokenCountTotal
      latencyMs
    }
  }
}
`}}}();Oo.hash="c89cb87e785645bbf42e3eadbacc4fc0";function Ih({spanId:n}){const[a,t]=u.useState(null),l=D.useLazyLoadQuery(Oo,{spanId:n});if(!l.span||!l.span.project||!l.span.context)return null;const{project:i,context:{traceId:r}}=l.span;return o(K,{borderTopColor:"light",borderTopWidth:"thin",paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",children:[o(h,{direction:"row",gap:"size-200",justifyContent:"space-between",children:[o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Sn,{tokenCountTotal:l.span.tokenCountTotal||0,tokenCountPrompt:l.span.tokenCountPrompt||0,tokenCountCompletion:l.span.tokenCountCompletion||0}),e(Ce,{latencyMs:l.span.latencyMs||0})]}),o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(z,{size:"compact",variant:"default",icon:e(L,{svg:e(I.EditOutline,{})}),onClick:()=>t(e(zl,{spanNodeId:n,projectId:i.id})),children:"Annotate"}),e(z,{size:"compact",variant:"default",icon:e(L,{svg:e(I.Trace,{})}),onClick:()=>{u.startTransition(()=>{t(e(u.Suspense,{children:e(Ro,{traceId:r,projectId:i.id,title:"Playground Trace"})}))})},children:"View Trace"})]})]}),e(ee,{type:"slideOver",isDismissable:!0,onDismiss:()=>t(null),children:a})]})}function Dh({index:n,title:a}){return o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Rt,{index:n}),e("span",{children:a})]})}const Ph=n=>yn(n)&&(typeof n.id=="string"||typeof n.id=="number")?n.id:JSON.stringify(n);function Kl({message:n}){const{role:a,content:t,toolCalls:l}=n,i=Ja(a),{mode:r}=_c();return o(q,{title:a,...i,variant:"compact",extra:e(Ye,{}),children:[t!=null&&!Array.isArray(t)&&e(h,{direction:"column",alignItems:"start",children:r==="text"?t:e(K,{overflow:"auto",maxWidth:"100%",children:e(la,{children:t})})}),l&&l.length>0?l.map(s=>e(Ao,{toolCall:s},Ph(s))):null]})}function Lh({content:n,partialToolCalls:a}){return Bu(n)?n.map((t,l)=>e(Kl,{message:t},l)):typeof n=="string"||a.length>0?e(Kl,{message:{id:fa(),content:n,role:"ai",toolCalls:a}}):"click run to see output"}function wh(n){const a=n.playgroundInstanceId,t=O(V=>V.instances),l=O(V=>V.streaming),i=Va(V=>V),r=O(V=>V.instances.findIndex(H=>H.id===a)),s=t.find(V=>V.id===a),c=O(V=>V.updateInstance),[d,m]=u.useState(null),y=O(V=>V.markPlaygroundInstanceComplete),g=D.useRelayEnvironment(),p=Fo();if(!s)throw new Error(`No instance found for id ${a}`);if(s.template.__type!=="chat")throw new Error("We only support chat templates for now");const[f,k]=u.useState(!1),[b]=D.useMutation(Vo),S=(s==null?void 0:s.activeRunId)!=null,v=ve(),P=u.useCallback(({title:V,message:H,...te})=>{m({title:V,message:H}),v({title:V,message:H,...te})},[v]),[E,R]=u.useState(s.output),[F,T]=u.useState([]),w=u.useCallback(({chatCompletion:V})=>{if(k(!1),V.__typename==="TextChunk"){const H=V.content;R(te=>te!=null?te+H:H);return}else if(V.__typename==="ToolCallChunk"){T(H=>{let te=!1;const oe=H.map(N=>N.id===V.id?(te=!0,{...N,function:{...N.function,arguments:N.function.arguments+V.function.arguments}}):N);return te||oe.push({id:V.id,function:{name:V.function.name,arguments:V.function.arguments}}),oe});return}if(V.__typename==="ChatCompletionSubscriptionResult"&&V.span!=null){c({instanceId:a,patch:{spanId:V.span.id}});return}V.__typename==="ChatCompletionSubscriptionError"&&(y(n.playgroundInstanceId),V.message!=null&&P({title:"Chat completion failed",message:V.message}))},[a,y,P,n.playgroundInstanceId,c]),_=u.useCallback((V,H)=>{if(k(!1),y(n.playgroundInstanceId),c({instanceId:a,patch:{spanId:V.chatCompletion.span.id}}),H){P({title:"Chat completion failed",message:H[0].message});return}if(V.chatCompletion.errorMessage!=null){P({title:"Chat completion failed",message:V.chatCompletion.errorMessage});return}R(V.chatCompletion.content??void 0),T(V.chatCompletion.toolCalls)},[a,y,P,n.playgroundInstanceId,c]),Q=u.useCallback(()=>{R(void 0),T([]),m(null),c({instanceId:a,patch:{spanId:null}})},[a,c]);return u.useEffect(()=>{if(!S){k(!1);return}k(!0),Q();const V=Xu({playgroundStore:p,instanceId:a,credentials:i});if(l){const te={subscription:$o,variables:{input:V},onNext:N=>{N&&w(N)},onCompleted:()=>{k(!1),y(n.playgroundInstanceId)},onError:N=>{k(!1),y(n.playgroundInstanceId);const j=wo(N);j!=null&&j.length>0?P({title:"Failed to get output",message:j.join(`
`)}):P({title:"Failed to get output",message:N.message})}};return St.requestSubscription(g,te).dispose}return b({variables:{input:V},onCompleted:_,onError(te){k(!1),y(n.playgroundInstanceId);const oe=Lo(te);oe!=null&&oe.length>0?P({title:"Failed to get output",message:oe.join(`
`)}):P({title:"Failed to get output",message:te.message})}}).dispose},[Q,i,g,b,S,a,y,P,_,w,p,n.playgroundInstanceId,l,c]),e(q,{title:e(Dh,{index:r,title:"Output"}),extra:E!=null||(F==null?void 0:F.length)>0?e(Th,{outputContent:E,toolCalls:F,instance:s,cleanupOutput:Q}):null,titleSeparator:!0,collapsible:!0,variant:"compact",bodyStyle:{padding:0},children:f?e(K,{padding:"size-200",children:e(ye,{message:"Running..."})}):d?e(K,{padding:"size-200",children:e(Bt,{children:d.message})}):o(G,{children:[e(K,{padding:"size-200",children:e(qe,{children:e(Lh,{content:E,partialToolCalls:F})})}),e(u.Suspense,{children:s.spanId?e(Ih,{spanId:s.spanId}):null})]})})}function Eh(){const n=O(l=>l.runPlaygroundInstances),a=O(l=>l.cancelPlaygroundInstances),t=O(l=>l.instances.some(i=>i.activeRunId!=null));return e(z,{variant:"primary",icon:t?e("div",{css:C`
              margin-right: var(--ac-global-dimension-static-size-50);
              & > * {
                height: 1em;
                width: 1em;
                font-size: 1.3rem;
              }
            `,children:e(ye,{size:"S"})}):e(L,{svg:e(I.PlayCircleOutline,{})}),size:"compact",onClick:()=>{t?a():n()},children:t?"Cancel":"Run"})}function _h(){const n=O(i=>i.streaming),a=O(i=>i.setStreaming),t=ze(i=>i.setPlaygroundStreamingEnabled),l=O(i=>i.instances.some(r=>r.activeRunId!=null));return window.Config.websocketsEnabled===!1?null:e(Xn,{labelPlacement:"start",isSelected:n,onChange:()=>{a(!n),t(!n)},isDisabled:l,children:"Stream"})}const Qo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"providerKey"}],a=[{kind:"Variable",name:"providerKey",variableName:"providerKey"}],t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelConfigButtonDialogQuery",selections:[{args:null,kind:"FragmentSpread",name:"ModelProviderPickerFragment"},{args:a,kind:"FragmentSpread",name:"ModelPickerFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelConfigButtonDialogQuery",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null},{alias:null,args:[{fields:a,kind:"ObjectValue",name:"input"}],concreteType:"GenerativeModel",kind:"LinkedField",name:"models",plural:!0,selections:[t],storageKey:null}]},params:{cacheID:"312c7daf378370f2936ee987869d155d",id:null,metadata:{},name:"ModelConfigButtonDialogQuery",operationKind:"query",text:`query ModelConfigButtonDialogQuery(
  $providerKey: GenerativeProviderKey!
) {
  ...ModelProviderPickerFragment
  ...ModelPickerFragment_3rERSq
}

fragment ModelPickerFragment_3rERSq on Query {
  models(input: {providerKey: $providerKey}) {
    name
  }
}

fragment ModelProviderPickerFragment on Query {
  modelProviders {
    key
    name
    dependenciesInstalled
    dependencies
  }
}
`}}}();Qo.hash="c9b38e766093b2378047d22b01ef0fbf";function Rh({defaultValue:n,onChange:a,label:t,errorMessage:l}){const[i,r]=u.useState(n==null?"":Nl(n).json??""),s=u.useCallback(c=>{r(c);const{json:d}=Ae(c);d==null&&c!==""||a(d)},[a]);return e("div",{css:C`
        & .ac-view {
          width: 100%;
        }
      `,children:e(Vn,{label:t,errorMessage:l,validationState:l?"invalid":void 0,children:e(Ne,{children:e(_e,{value:i,onChange:s,optionalLint:!0})})})})}const Ah=({field:n,value:a,onChange:t,errors:l,control:i})=>{var g;const r=n.invocationName;if(!r)throw new Error("Invocation name is required");const s=(g=l[r])==null?void 0:g.message,c=n.required?`${n.label||r} is required`:void 0,d=n.minValue!=null?`${n.label||r} must be at least ${n.minValue}`:void 0,m=n.maxValue!=null?`${n.label||r} must be at most ${n.maxValue}`:void 0,{__typename:y}=n;switch(y){case"InvocationParameterBase":return null;case"BoundedFloatInvocationParameter":return typeof a!="number"&&a!==void 0?null:e(Fd,{label:n.label,isRequired:n.required,defaultValue:a,step:.1,minValue:n.minValue,maxValue:n.maxValue,onChange:p=>t(p)});case"FloatInvocationParameter":case"IntInvocationParameter":return e(W,{control:i,name:r,rules:{required:c,min:d,max:m},render:({field:{onBlur:p}})=>e(ae,{label:n.label,isRequired:n.required,value:(a==null?void 0:a.toString())||"",type:"number",onBlur:p,onChange:f=>{if(f===""){t(void 0);return}t(Number(f))},errorMessage:s,validationState:s?"invalid":"valid"})});case"StringListInvocationParameter":return!Array.isArray(a)&&a!==void 0?null:e(W,{control:i,name:r,rules:{required:c},render:({field:{onBlur:p}})=>e(ae,{label:n.label,isRequired:n.required,defaultValue:(a==null?void 0:a.join(", "))??"",onBlur:p,onChange:f=>{if(f===""){t(void 0);return}t(f.split(/, */g))},description:"A comma separated list of strings",errorMessage:s})});case"StringInvocationParameter":return e(W,{control:i,name:r,rules:{required:c},render:({field:{onBlur:p}})=>e(ae,{label:n.label,isRequired:n.required,defaultValue:(a==null?void 0:a.toString())||"",type:"text",onBlur:p,onChange:f=>{if(f===""){t(void 0);return}t(f)},errorMessage:s})});case"BooleanInvocationParameter":return e(Xn,{onChange:t,defaultSelected:!!a,children:n.label});case"JSONInvocationParameter":return e(W,{control:i,name:r,rules:{required:c},render:()=>e(Rh,{defaultValue:a,onChange:t,label:n.label??n.invocationName??"",errorMessage:s})});default:return null}},Mh=(n,a)=>{if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return a[Wa(n.invocationInputField)]},Nh=(n,a)=>{if(n.invocationName===void 0)throw new Error("Invocation name is required");if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return{invocationName:n.invocationName,canonicalName:n.canonicalName,[Wa(n.invocationInputField)]:a}},zh=({instanceId:n})=>{const a=O(f=>f.instances.find(k=>k.id===n));if(!a)throw new Error("Instance not found");const{model:t}=a,l=O(f=>f.upsertInvocationParameterInput),i=O(f=>f.deleteInvocationParameterInput),r=a.model.supportedInvocationParameters,s=a.model.invocationParameters,c=u.useCallback((f,k)=>{if(!f.invocationName)throw new Error("Invocation name is required");k===void 0?i({instanceId:n,invocationParameterInputInvocationName:f.invocationName}):l({instanceId:n,invocationParameterInput:Nh(f,k)})},[n,l,i]),d=u.useMemo(()=>r.filter(f=>!(f.canonicalName!=null&&mu.includes(f.canonicalName))).reduce((f,k)=>{const b=s.find(v=>Rn(v,k)),S=b?Mh(k,b):void 0;return{...f,[k.invocationName]:S??null}},{}),[s,r]),m=Ue({values:d,mode:"onBlur",delayError:0,shouldFocusError:!1,resetOptions:{keepErrors:!0}}),y=m.trigger,g=u.useMemo(()=>pt.debounce(y,250),[y]);return u.useEffect(()=>{g()},[d,g]),t.provider!=="AZURE_OPENAI"&&t.modelName===null?null:Object.entries(d).map(([f,k])=>{const b=r.find(v=>v.invocationName===f);if(!b)return null;const S=`${t.provider??"model"}-${b.invocationName}`;return e(Ah,{field:b,value:k,onChange:v=>c(b,v),control:m.control,errors:m.formState.errors},S)})},jo={argumentDefinitions:[{defaultValue:"OPENAI",kind:"LocalArgument",name:"providerKey"}],kind:"Fragment",metadata:null,name:"ModelPickerFragment",selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"providerKey",variableName:"providerKey"}],kind:"ObjectValue",name:"input"}],concreteType:"GenerativeModel",kind:"LinkedField",name:"models",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};jo.hash="1e660ad77ce19db1c1bbe8698a661b4f";function Vh({query:n,onChange:a,...t}){const l=D.useFragment(jo,n);return e(va,{label:"Model","data-testid":"model-picker",selectedKey:t.modelName??"","aria-label":"model picker",placeholder:"Select a model",onSelectionChange:i=>{typeof i=="string"&&a(i)},width:"100%",...t,children:l.models.map(({name:i})=>e(le,{children:i},i))})}const qo={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelProviderPickerFragment",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};qo.hash="1d4ba7f81a958c9a17bd45dce0456ddb";function $h(n){return n==="OPENAI"||n==="AZURE_OPENAI"||n==="ANTHROPIC"||n==="GEMINI"}function Oh({onChange:n,query:a,...t}){var c,d;const l=D.useFragment(qo,a),i=l.modelProviders.filter(m=>m.dependenciesInstalled),r=i.length!==l.modelProviders.length,s=t.provider&&!i.some(m=>m.key===t.provider);return o(h,{direction:"row",gap:"size-100",children:[e(va,{label:"Provider","data-testid":"model-provider-picker",selectedKey:t.provider??void 0,"aria-label":"Model Provider",placeholder:"Select a provider",onSelectionChange:m=>{const y=m;$h(y)&&n(y)},width:"100%",...t,children:l.modelProviders.map(m=>e(le,{children:m.name},m.key))}),s?o(pe,{delay:0,offset:5,children:[e("span",{children:e(je,{children:e(L,{color:"red-700",svg:e(I.InfoOutline,{})})})}),o(Ie,{children:["The selected provider is not installed. Install"," ",((d=(c=l.modelProviders.find(m=>m.key===t.provider))==null?void 0:c.dependencies)==null?void 0:d.join(", "))??"the dependencies"," ","to use its models in Playground."]})]}):r?o(pe,{delay:0,offset:5,children:[e("span",{children:e(je,{children:e(L,{svg:e(I.InfoOutline,{})})})}),o(Ie,{children:["Some providers are missing dependencies. Install them to use their models in Playground.",e("br",{}),e("br",{}),"Missing providers:",e("br",{}),l.modelProviders.filter(m=>!m.dependenciesInstalled).map(m=>{var y;return o(G,{children:[((y=m.dependencies)==null?void 0:y.join(", "))??m.name,e("br",{})]})})]})]}):null]})}const Qh=150,jh=C`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-200);
  .ac-field,
  .ac-dropdown,
  .ac-dropdown-button,
  .ac-slider {
    width: 100%;
  }
  // Makes the filled slider track blue
  .ac-slider-controls > .ac-slider-track:first-child::before {
    background: var(--ac-global-color-primary);
  }
  padding: var(--ac-global-dimension-size-200);
  overflow: auto;
`;function qh({instance:n}){const a=O(i=>i.updateModel),t=u.useCallback(({configKey:i,value:r})=>{a({instanceId:n.id,patch:{...n.model,[i]:r}})},[n.id,n.model,a]),l=u.useMemo(()=>sd(i=>{t({configKey:"modelName",value:i})},250),[t]);return o(G,{children:[e(ae,{label:"Deployment Name",defaultValue:n.model.modelName??"",onChange:i=>{l(i)}}),e(ae,{label:"Endpoint",defaultValue:n.model.endpoint??"",onChange:i=>{t({configKey:"endpoint",value:i})}}),e(va,{label:"API Version",defaultSelectedKey:n.model.apiVersion??void 0,"aria-label":"api version picker",placeholder:"Select an AzureOpenAI API Version",onSelectionChange:i=>{typeof i=="string"&&t({configKey:"apiVersion",value:i})},children:Rc.map(i=>e(le,{children:i},i))})]})}function Uh(n){const[a,t]=u.useState(null),l=O(c=>c.instances.find(d=>d.id===n.playgroundInstanceId));if(!l)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const i=l.model.supportedInvocationParameters,r=l.model.invocationParameters,s=Ti(r,i);return o(u.Fragment,{children:[e(z,{variant:"default",size:"compact",onClick:()=>{u.startTransition(()=>{t(e(Bh,{...n}))})},title:`${Na[l.model.provider]} ${l.model.modelName||"--"}`,children:o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(x,{weight:"heavy",children:Na[l.model.provider]}),e("div",{css:C`
              max-width: ${Qh}px;
              text-overflow: ellipsis;
              overflow: hidden;
              white-space: nowrap;
            `,children:e(x,{children:l.model.modelName||"--"})}),s?null:o(pe,{delay:0,offset:5,children:[e("span",{children:e(je,{children:e(L,{color:"danger",svg:e(I.InfoOutline,{})})})}),e(Ie,{children:"Some required invocation parameters are not configured."})]})]})}),e(ee,{type:"slideOver",isDismissable:!0,onDismiss:()=>{t(null)},children:a})]})}function Bh(n){const a=O(r=>r.instances.find(s=>s.id===n.playgroundInstanceId));if(!a)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const t=ze(r=>r.setModelConfigForProvider),l=xe(),i=u.useCallback(()=>{const{supportedInvocationParameters:r,...s}=a.model;t({provider:a.model.provider,modelConfig:s}),l({title:"Model Configuration Saved",message:`${Na[a.model.provider]} model configuration saved as default for later use.`,expireMs:3e3})},[a.model,l,t]);return e(Z,{title:"Model Configuration",size:"M",extra:o(pe,{delay:0,offset:5,children:[e(z,{size:"compact",variant:"default",onClick:i,icon:e(L,{svg:e(I.SaveOutline,{})}),children:"Save as Default"}),o(Ie,{children:["Saves the current configuration as the default for"," ",Na[a.model.provider]??"this provider","."]})]}),children:e(u.Suspense,{children:e(Hh,{...n})})})}function Hh(n){const{playgroundInstanceId:a}=n,t=O(g=>g.instances.find(p=>p.id===a));if(!t)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const l=ze(g=>g.modelConfigByProvider),i=O(g=>g.updateProvider),r=O(g=>g.updateModel),s=t.model.supportedInvocationParameters,c=t.model.invocationParameters,d=Ti(c,s),m=D.useLazyLoadQuery(Qo,{providerKey:t.model.provider}),y=u.useCallback(g=>{r({instanceId:a,patch:{modelName:g}})},[a,r]);return o("form",{css:jh,children:[d?null:o(h,{direction:"row",gap:"size-100",children:[e(L,{color:"danger",svg:e(I.InfoOutline,{})}),e(x,{color:"danger",children:"Some required invocation parameters are not configured."})]}),e(Oh,{provider:t.model.provider,query:m,onChange:g=>{i({instanceId:a,provider:g,modelConfigByProvider:l})}}),t.model.provider==="AZURE_OPENAI"?e(qh,{instance:t}):e(Vh,{modelName:t.model.modelName,provider:t.model.provider,query:m,onChange:y}),e(u.Suspense,{children:e(zh,{instanceId:a})})]})}const Uo=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null},t={alias:"floatDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"modelInvocationParameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"required",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:[{alias:"booleanDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[t,a,{alias:null,args:null,kind:"ScalarField",name:"minValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxValue",storageKey:null}],type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[t,a],type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"intDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"jsonDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringListDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringListInvocationParameter",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelSupportedParamsFetcherQuery",selections:l,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelSupportedParamsFetcherQuery",selections:l},params:{cacheID:"8f18509b17f3f97c2413ef8b6557d972",id:null,metadata:{},name:"ModelSupportedParamsFetcherQuery",operationKind:"query",text:`query ModelSupportedParamsFetcherQuery(
  $input: ModelsInput!
) {
  modelInvocationParameters(input: $input) {
    __typename
    ... on InvocationParameterBase {
      __isInvocationParameterBase: __typename
      invocationName
      canonicalName
      required
      label
    }
    ... on BooleanInvocationParameter {
      booleanDefaultValue: defaultValue
      invocationInputField
    }
    ... on BoundedFloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
      minValue
      maxValue
    }
    ... on FloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
    }
    ... on IntInvocationParameter {
      intDefaultValue: defaultValue
      invocationInputField
    }
    ... on JSONInvocationParameter {
      jsonDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringInvocationParameter {
      stringDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringListInvocationParameter {
      stringListDefaultValue: defaultValue
      invocationInputField
    }
  }
}
`}}}();Uo.hash="8bf1a32724929bdc4a02d32809ba59d7";const Gh=({instanceId:n})=>{const a=O(s=>{var c;return(c=s.instances.find(d=>d.id===n))==null?void 0:c.model.provider}),t=O(s=>{var c;return(c=s.instances.find(d=>d.id===n))==null?void 0:c.model.modelName}),l=ze(s=>s.modelConfigByProvider),i=O(s=>s.updateModelSupportedInvocationParameters),{modelInvocationParameters:r}=D.useLazyLoadQuery(Uo,{input:{providerKey:a,modelName:t}});return u.useEffect(()=>{i({instanceId:n,supportedInvocationParameters:r})},[r,n,i,l]),null};function Wh({playgroundInstanceId:n,toolCalls:a,templateMessages:t,messageId:l}){const i=O(p=>p.updateInstance),r=O(p=>p.instances.find(f=>f.id===n));if(r==null)throw new Error(`Playground instance ${n} not found`);const[s,c]=u.useState(()=>JSON.stringify(a,null,2)),[d,m]=u.useState(a);u.useEffect(()=>{JSON.stringify(a)!==JSON.stringify(d)&&(c(JSON.stringify(a,null,2)),m(a))},[d,a]);const y=u.useCallback(p=>{c(p);const{json:f}=Ae(p);if(f==null)return;const{success:k}=Ac.safeParse(f);k&&(m(f),i({instanceId:n,patch:{template:{__type:"chat",messages:t.map(b=>l===b.id?{...b,toolCalls:f}:b)}}}))},[l,n,t,i]),g=u.useMemo(()=>{switch(r.model.provider){case"OPENAI":case"AZURE_OPENAI":return Nc;case"ANTHROPIC":return Mc;case"GEMINI":return null}},[r.model.provider]);return e(_e,{value:s,jsonSchema:g,onChange:y})}function Jh(n){return n==="text"||n==="toolCalls"}function Zh({messageMode:n,onChange:a}){return o(_l,{defaultValue:n,variant:"inline-button",size:"compact",onChange:t=>{if(Jh(t))a(t);else throw new Error(`Unknown message mode: ${t}`)},children:[e(pa,{label:"text input",value:"text",children:o(pe,{placement:"top",delay:0,offset:10,children:[e(je,{children:e(L,{svg:e(I.MessageSquareOutline,{})})}),e(Ie,{children:"Text input"})]})}),e(pa,{label:"tool calling",value:"toolCalls",children:o(pe,{placement:"top",delay:0,offset:10,children:[e(je,{children:e(L,{svg:e(I.Code,{})})}),e(Ie,{children:"Tool calling"})]})})]})}const Yh=C`
  .ac-field-label {
    display: none;
  }
`;function Xh({role:n,includeLabel:a=!0,onChange:t}){return o(va,{selectedKey:n,css:a?void 0:Yh,label:"Role","data-testid":"messages-role-picker","aria-label":"Role for the chat message",size:"compact",onSelectionChange:l=>{if(!Si(l))throw new Error(`Invalid chat message role: ${l}`);t(l)},children:[e(le,{children:"System"},"system"),e(le,{children:"User"},"user"),e(le,{children:"AI"},"ai"),e(le,{children:"Tool"},"tool")]})}const e0=32;function n0({instanceId:n,hasResponseFormat:a}){const t=O(y=>y.instances),l=O(y=>y.updateInstance),i=O(y=>y.upsertInvocationParameterInput),r=t.find(y=>y.id===n);if(!r)throw new Error(`Playground instance ${n} not found`);const{template:s}=r;if(s.__type!=="chat")throw new Error(`Invalid template type ${s.__type}`);const c=r.model.supportedInvocationParameters,d=c==null?void 0:c.some(y=>Rn(y,{canonicalName:_n,invocationName:Ln})),m=c==null?void 0:c.some(y=>Rn(y,{canonicalName:ya,invocationName:_a}));return o(h,{direction:"row",justifyContent:"end",gap:"size-100",minHeight:e0,children:[d?e(z,{variant:"default",size:"compact","aria-label":"output schema",icon:e(L,{svg:e(I.PlusOutline,{})}),disabled:a,onClick:()=>{i({instanceId:n,invocationParameterInput:{valueJson:zc(),invocationName:Ln,canonicalName:_n}})},children:"Output Schema"}):null,m?e(z,{variant:"default","aria-label":"add tool",size:"compact",icon:e(L,{svg:e(I.PlusOutline,{})}),onClick:()=>{[...r.tools,al({provider:r.model.provider,toolNumber:r.tools.length+1})],r.tools.length,l({instanceId:n,patch:{tools:[...r.tools,al({provider:r.model.provider,toolNumber:r.tools.length+1})]}})},children:"Tool"}):null,e(z,{variant:"default","aria-label":"add message",size:"compact",icon:e(L,{svg:e(I.PlusOutline,{})}),onClick:()=>{l({instanceId:n,patch:{template:{__type:"chat",messages:[...s.messages,{id:fa(),role:"user",content:""}]}}})},children:"Message"})]})}const a0=400;function t0({playgroundInstanceId:n}){const a=O(d=>d.deleteInvocationParameterInput),t=O(d=>d.instances.find(m=>m.id===n)),l=O(d=>d.upsertInvocationParameterInput);if(!t)throw new Error(`Instance ${n} not found`);const i=t.model.invocationParameters.find(d=>d.invocationName===Ln||d.canonicalName===_n),[r,s]=u.useState(JSON.stringify((i==null?void 0:i.valueJson)??{},null,2)),c=u.useCallback(d=>{s(d);const{json:m}=Ae(d);if(m==null)return;const{success:y}=Vt.safeParse(m);y&&l({instanceId:n,invocationParameterInput:{invocationName:Ln,valueJson:m,canonicalName:_n}})},[n,l]);return e(Be,{arrowPosition:"start",children:e(be,{id:"response-format",title:"Output Schema",children:e(K,{padding:"size-200",children:e(q,{variant:"compact",title:"Schema",bodyStyle:{padding:0},extra:o(h,{direction:"row",gap:"size-100",children:[e(se,{text:r}),e(z,{"aria-label":"Delete Output Schema",icon:e(L,{svg:e(I.TrashOutline,{})}),variant:"default",size:"compact",onClick:()=>{a({instanceId:n,invocationParameterInputInvocationName:Ln})}})]}),children:e(mi,{preInitializationMinHeight:a0,children:e(_e,{value:r,onChange:c,jsonSchema:wu})})})})})})}const l0=400;function i0({playgroundInstanceId:n,toolId:a}){const t=O(f=>f.updateInstance),l=O(f=>f.instances.find(k=>k.id===n));if(l==null)throw new Error(`Playground instance ${n} not found`);const i=l.tools,r=i.find(f=>f.id===a);if(r==null)throw new Error(`Tool ${a} not found`);const[s,c]=u.useState(JSON.stringify(r.definition,null,2)),[d,m]=u.useState(r.definition);u.useEffect(()=>{JSON.stringify(r.definition)!==JSON.stringify(d)&&(m(r.definition),c(JSON.stringify(r.definition,null,2)))},[r.definition,d]);const y=u.useCallback(f=>{c(f);const{json:k}=Ae(f);if(k==null)return;const{success:b}=Ml.safeParse(k);b&&(m(k),t({instanceId:n,patch:{tools:i.map(S=>S.id===r.id?{...S,definition:k}:S)}}))},[i,n,r.id,t]),g=u.useMemo(()=>Ra(r),[r]),p=u.useMemo(()=>{switch(l.model.provider){case"OPENAI":case"AZURE_OPENAI":return $c;case"ANTHROPIC":return Vc;case"GEMINI":return null}},[l.model.provider]);return e(q,{collapsible:!0,backgroundColor:"yellow-100",borderColor:"yellow-700",variant:"compact",title:o(h,{direction:"row",gap:"size-100",children:[e(wt,{spanKind:"tool"}),e(x,{children:g??"Tool"})]}),bodyStyle:{padding:0},extra:o(h,{direction:"row",gap:"size-100",children:[e(se,{text:s}),e(z,{"aria-label":"Delete tool",icon:e(L,{svg:e(I.TrashOutline,{})}),variant:"default",size:"compact",onClick:()=>{const f=i.filter(v=>v.id!==r.id),k=Ra(r),b=typeof l.toolChoice=="object"&&k!=null&&l.toolChoice.function.name===Ra(r);let S=l.toolChoice;f.length===0?S=void 0:b&&(S="auto"),t({instanceId:n,patch:{tools:f,toolChoice:S}})}})]}),children:e(mi,{preInitializationMinHeight:l0,children:e(_e,{value:s,onChange:y,jsonSchema:p})})})}function r0(n){const a=n.playgroundInstanceId,t=O(s=>s.instances.find(c=>c.id===n.playgroundInstanceId)),l=O(s=>s.updateInstance);if(t==null)throw new Error(`Playground instance ${a} not found`);const{tools:i}=t;if(i==null)throw new Error(`Playground instance ${a} does not have tools`);const r=u.useMemo(()=>i.map(s=>Ra(s)).filter(s=>s!=null),[i]);return e(Be,{arrowPosition:"start",children:e(be,{id:"tools",title:"Tools",titleExtra:e(Je,{variant:"light",children:i.length}),children:e(K,{padding:"size-200",children:o(h,{direction:"column",children:[e(Re,{children:e(Oc,{choice:t.toolChoice,onChange:s=>{l({instanceId:a,patch:{toolChoice:s}})},toolNames:r})}),e(h,{direction:"column",gap:"size-200",children:i.map(s=>e(i0,{playgroundInstanceId:a,toolId:s.id},s.id))})]})})})})}const Bo=1,s0=Bo+1;function o0(n){const a=n.playgroundInstanceId,t=O(y=>y.templateLanguage),l=O(y=>y.instances),i=O(y=>y.updateInstance),r=l.find(y=>y.id===a);if(!r)throw new Error(`Playground instance ${a} not found`);const s=r.tools.length>0,c=r.model.invocationParameters.find(y=>Rn(y,{canonicalName:_n,invocationName:Ln}))!=null,{template:d}=r;if(d.__type!=="chat")throw new Error(`Invalid template type ${d.__type}`);const m=od(Ht(fd),Ht(yd,{coordinateGetter:pd}));return o(ud,{sensors:m,onDragEnd:({active:y,over:g})=>{if(!g||y.id===g.id)return;const p=d.messages.findIndex(b=>b.id===y.id),f=d.messages.findIndex(b=>b.id===g.id),k=dd(d.messages,p,f);i({instanceId:a,patch:{template:{__type:"chat",messages:k}}})},children:[e(cd,{items:d.messages,children:e("ul",{css:C`
            display: flex;
            flex-direction: column;
            gap: var(--ac-global-dimension-size-200);
            padding: var(--ac-global-dimension-size-200);
          `,children:d.messages.map((y,g)=>e(c0,{playgroundInstanceId:a,instance:r,templateLanguage:t,template:d,message:y,index:g},y.id))})}),e(K,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderColor:"dark",borderTopWidth:"thin",borderBottomWidth:s||c?"thin":void 0,children:e(n0,{instanceId:a,hasResponseFormat:c})}),s?e(r0,{...n}):null,c?e(t0,{...n}):null]})}function d0({message:n,updateMessage:a,templateLanguage:t,playgroundInstanceId:l,template:i,messageMode:r}){if(r==="toolCalls")return e(K,{paddingTop:"size-100",paddingStart:"size-250",paddingEnd:"size-250",paddingBottom:"size-200",children:e(Vn,{label:"Tool Calls",children:e(Ne,{width:"100%",children:e(Wh,{playgroundInstanceId:l,toolCalls:n.toolCalls,templateMessages:i.messages,messageId:n.id})})})});if(n.role==="tool"){const s=xi(n.content);return o(Re,{onSubmit:c=>{c.preventDefault()},children:[e(K,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-200",borderColor:"yellow-700",borderBottomWidth:"thin",children:e(ae,{value:n.toolCallId,onChange:c=>a({toolCallId:c}),"aria-label":"Tool Call ID",addonBefore:"Tool Call ID"})}),e(_e,{value:s,"aria-label":"tool message content",height:"100%",onChange:c=>a({content:c}),onBlur:()=>{if(n.content!=null&&typeof n.content=="string"){const{json:c}=Ae(n.content);a({content:JSON.stringify(c,null,2)})}}})]})}return e("div",{css:C`
        & .cm-content {
          padding-left: var(--ac-global-dimension-size-250);
          padding-right: var(--ac-global-dimension-size-250);
        }
        & .cm-line {
          padding-left: 0;
          padding-right: 0;
        }
      `,children:e(jc,{height:"100%",value:typeof n.content=="string"?n.content:JSON.stringify(n.content,null,2),"aria-label":"Message content",templateLanguage:t,onChange:s=>a({content:s})})})}function c0({playgroundInstanceId:n,templateLanguage:a,template:t,message:l,instance:i}){const r=O(w=>w.updateInstance),{attributes:s,listeners:c,setNodeRef:d,transform:m,transition:y,setActivatorNodeRef:g,isDragging:p}=md({id:l.id}),f=Ja(l.role),k={transform:gd.Translate.toString(m),transition:y,zIndex:p?s0:Bo},b=l.toolCalls!=null&&l.toolCalls.length>0,[S,v]=u.useState(b?"toolCalls":"text"),P=u.useCallback(w=>{r({instanceId:n,patch:{template:{__type:"chat",messages:t.messages.map(_=>_.id===l.id?{..._,...w}:_)}}})},[l.id,n,t.messages,r]),[E,R]=u.useState(l.content),[F,T]=u.useState(l.toolCalls);return e("li",{ref:d,style:k,children:e(q,{collapsible:!0,variant:"compact",bodyStyle:{padding:0},...f,title:e(Xh,{includeLabel:!1,role:l.role,onChange:w=>{let _=l.toolCalls;w!=="ai"&&(_=void 0,v("text")),r({instanceId:n,patch:{template:{__type:"chat",messages:t.messages.map(Q=>Q.id===l.id?{...Q,role:w,toolCalls:_}:Q)}}})}}),extra:o(h,{direction:"row",gap:"size-100",children:[l.role==="ai"?e(Zh,{messageMode:S,onChange:w=>{switch(v(w),w){case"text":T(l.toolCalls),P({content:E,toolCalls:void 0});break;case"toolCalls":R(l.content),P({content:"",toolCalls:F!=null?ui({toolCalls:F,provider:i.model.provider}):[Ju(i.model.provider)]});break;default:me()}}}):null,e(se,{text:S==="toolCalls"?JSON.stringify(l.toolCalls):xi(l.content)}),e(z,{"aria-label":"Delete message",icon:e(L,{svg:e(I.TrashOutline,{})}),variant:"default",size:"compact",onClick:()=>{r({instanceId:n,patch:{template:{__type:"chat",messages:t.messages.filter(w=>w.id!==l.id)}}})}}),e(Qc,{ref:g,listeners:c,attributes:s})]}),children:e("div",{children:e(d0,{message:l,messageMode:S,playgroundInstanceId:n,template:t,templateLanguage:a,updateMessage:P})})})})}function u0(n){const a=n.playgroundInstanceId,t=O(s=>s.instances),l=t.find(s=>s.id===a),i=t.findIndex(s=>s.id===a);if(!l)throw new Error(`Playground instance ${a} not found`);const{template:r}=l;return e(q,{title:o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Rt,{index:i}),e("span",{children:"Prompt"})]}),collapsible:!0,variant:"compact",bodyStyle:{padding:0},extra:o(h,{direction:"row",gap:"size-100",children:[e(u.Suspense,{fallback:e("div",{children:e(ye,{size:"S"})}),children:e(Gh,{instanceId:a})}),e(Uh,{...n}),t.length>1?e(m0,{...n}):null]}),children:r.__type==="chat"?e(u.Suspense,{children:e(o0,{...n})}):"Completion Template"})}function m0(n){const a=O(t=>t.deleteInstance);return o(pe,{children:[e(je,{children:e(z,{variant:"default",size:"compact",icon:e(L,{svg:e(I.TrashOutline,{})}),onClick:()=>{a(n.playgroundInstanceId)}})}),e(Ie,{children:e(zn,{children:"Delete this instance of the playground"})})]})}function g0(){const n=O(t=>t.templateLanguage),a=O(t=>t.setTemplateLanguage);return e("div",{css:C`
        & * {
          white-space: nowrap;
        }
      `,children:o(_l,{value:n,variant:"inline-button","aria-label":"Template Language",size:"compact",onChange:t=>{qc(t)&&a(t)},children:[e(pa,{label:"None",value:Pn.NONE,children:"None"}),e(pa,{label:"Mustache",value:Pn.Mustache,children:"Mustache"}),e(pa,{label:"F-String",value:Pn.FString,children:"F-String"})]})})}const p0=C`
  display: flex;
  overflow: hidden;
  flex-direction: column;
  height: 100%;
`;function Ho(n){const{modelProviders:a}=D.useLazyLoadQuery(Co,{}),t=ze(d=>d.modelConfigByProvider),l=ze(d=>d.playgroundStreamingEnabled),[,i]=Sa(),r=a.some(d=>d.dependenciesInstalled);u.useEffect(()=>{i(d=>(d.delete("selectedSpanNodeId"),d),{replace:!0})},[i]);const s=window.Config.websocketsEnabled?l:!1,c=window.Config.websocketsEnabled;return r?o(qf,{...n,streaming:s,modelConfigByProvider:t,children:[o("div",{css:p0,children:[e(K,{borderBottomColor:"dark",borderBottomWidth:"thin",padding:"size-200",flex:"none",children:o(h,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(ce,{level:1,children:"Playground"}),o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[c?e(_h,{}):null,e(Zf,{}),e(Wf,{}),e(Eh,{})]})]})}),e(S0,{})]}),e(u.Suspense,{children:e(Oe,{})})]}):e(Hf,{availableProviders:a})}function y0(){const n=O(i=>i.addInstance),a=O(i=>i.instances),t=a.length,l=a.some(i=>i.activeRunId!=null);return e("div",{onClick:i=>{i.stopPropagation()},children:e(z,{variant:"default",size:"compact","aria-label":"add prompt",icon:e(L,{svg:e(I.PlusCircleOutline,{})}),disabled:t>=nu||l,onClick:()=>{n()},children:"Compare"})})}const f0=C`
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  & > .ac-accordion {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
    flex: 1 1 auto;
    & > .ac-accordion-item {
      height: 100%;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      overflow-y: auto;
      flex: 1 1 auto;
      // prevent the accordion item header from growing to fill the accordion item
      // using two selectors as fallback just incase the component lib changes subtly
      & > [role="button"],
      & > #prompts-heading {
        flex: 0 0 auto;
      }
      .ac-accordion-itemContent {
        height: 100%;
        overflow: hidden;
        flex: 1 1 auto;
      }
    }
  }
`,h0=C`
  padding: var(--ac-global-dimension-size-200);
  scrollbar-gutter: stable;
  height: 100%;
  flex: 1 1 auto;
  overflow: auto;
  box-sizing: border-box;
`,k0=C`
  height: 100%;
  overflow: auto;
`,b0=475;function S0(){const n=O(m=>m.instances),a=O(m=>m.templateLanguage),{datasetId:t}=Ve(),l=t!=null,r=n.length===1,s=n.some(m=>m.activeRunId!=null),c=u.useCallback(({currentLocation:m,nextLocation:y})=>s&&m.pathname!==y.pathname,[s]),d=hd(c);return u.useEffect(()=>{const m=y=>{s&&(y.preventDefault(),y.returnValue=!0)};return window.addEventListener("beforeunload",m),()=>window.removeEventListener("beforeunload",m)},[s]),o(G,{children:[o(on,{direction:r&&!l?"horizontal":"vertical",autoSaveId:r?"playground-horizontal":"playground-vertical",children:[e(ke,{children:e("div",{css:f0,children:e(Be,{arrowPosition:"start",size:"L",children:e(be,{title:"Prompts",id:"prompts",extra:o(h,{direction:"row",gap:"size-100",alignItems:"center",children:[e(g0,{}),e(y0,{})]}),children:e("div",{css:h0,children:e(h,{direction:"row",gap:"size-200",maxWidth:"100%",children:n.map(m=>e(K,{flex:"1 1 0px",minWidth:b0,children:e(u0,{playgroundInstanceId:m.id},m.id)},m.id))})})})})})}),e(sn,{css:bn}),e(ke,{children:l?e(u.Suspense,{fallback:e(ye,{}),children:e(Sh,{datasetId:t})}):e("div",{css:k0,children:o(Be,{arrowPosition:"start",size:"L",children:[a!==Pn.NONE?e(be,{title:"Inputs",id:"input",children:e(K,{padding:"size-200",height:"100%",children:e(xh,{})})}):null,e(be,{title:"Output",id:"output",children:e(K,{padding:"size-200",height:"100%",children:e(h,{direction:"row",gap:"size-200",children:n.map((m,y)=>e(K,{flex:"1 1 0px",children:e(wh,{playgroundInstanceId:m.id},y)},y))})})})]})})})]}),d!=null&&e(Uc,{blocker:d,message:"Playground run is still in progress, leaving the page may result in incomplete runs. Are you sure you want to leave?"})]})}function m1(){return e(Ho,{})}function g1(){const n=kn(),a=u.useMemo(()=>n.span.__typename==="Span"?n.span:null,[n.span]);if(!a)throw new Error("Span not found");const{playgroundInstance:t,parsingErrors:l,playgroundInput:i}=u.useMemo(()=>Uu(a),[a]),r=i!=null?{input:i}:{};return o(h,{direction:"column",height:"100%",children:[e(v0,{span:a,parsingErrors:l}),e(Ho,{instances:[t],...r},a.id)]})}function v0({span:n,parsingErrors:a}){const t=X(),l=a&&a.length>0,[i,r]=u.useState(!0),[s,c]=u.useState(l);return o(h,{direction:"column",gap:"size-50",children:[i&&e(ue,{variant:"info",title:"LLM Span Replay",banner:!0,dismissable:!0,onDismissClick:()=>{r(!1)},extra:e(z,{variant:"default",icon:e(L,{svg:e(I.ArrowBack,{})}),onClick:()=>{t(`/projects/${n.project.id}/traces/${n.context.traceId}?selectedSpanNodeId=${n.id}`)},children:"Back to Trace"}),children:`Replay and iterate on your LLM call from your ${n.project.name} project`}),s&&l&&e(ue,{variant:"warning",banner:!0,dismissable:!0,onDismissClick:()=>{c(!1)},title:"The following errors occurred when parsing span attributes:",children:e("ul",{children:a.map(d=>e("li",{children:d},d))})})]})}const Go=function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},r={alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null}],d={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"invocationParameters",plural:!0,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:c,type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"StringListInvocationParameter",abstractKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[l,i,r,s,d],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"TypeDiscriminator",abstractKey:"__isNode"},l,{kind:"InlineFragment",selections:[i,r,s,d],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"e6a9310252c290e00bfdc12151c88b3a",id:null,metadata:{},name:"spanPlaygroundPageLoaderQuery",operationKind:"query",text:`query spanPlaygroundPageLoaderQuery(
  $spanId: GlobalID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      id
      project {
        id
        name
      }
      context {
        spanId
        traceId
      }
      attributes
      invocationParameters {
        __typename
        ... on InvocationParameterBase {
          __isInvocationParameterBase: __typename
          invocationName
          canonicalName
        }
        ... on BooleanInvocationParameter {
          invocationInputField
        }
        ... on StringInvocationParameter {
          invocationInputField
        }
        ... on BoundedFloatInvocationParameter {
          invocationInputField
        }
        ... on FloatInvocationParameter {
          invocationInputField
        }
        ... on IntInvocationParameter {
          invocationInputField
        }
        ... on JSONInvocationParameter {
          invocationInputField
        }
        ... on StringListInvocationParameter {
          invocationInputField
        }
      }
    }
    __isNode: __typename
    id
  }
}
`}}}();Go.hash="65ef72eb48726c70f00811d17ea6d82d";async function p1(n){const{spanId:a}=n.params;if(!a||typeof a!="string")throw new Error("Invalid spanId");return await D.fetchQuery(Me,Go,{spanId:a}).toPromise()}function y1(){const n=kn();return e(Bc,{query:n,children:e(Oe,{})})}const Wo=function(){var n={alias:null,args:null,kind:"ScalarField",name:"passwordNeedsReset",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"authenticatedRootLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"ViewerContext_viewer"},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[n],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"authenticatedRootLoaderQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[a,t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},n],storageKey:null}]},params:{cacheID:"d63c6184305079deb38a6f6235ba88e6",id:null,metadata:{},name:"authenticatedRootLoaderQuery",operationKind:"query",text:`query authenticatedRootLoaderQuery {
  ...ViewerContext_viewer
  viewer {
    passwordNeedsReset
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}

fragment ViewerContext_viewer on Query {
  viewer {
    id
    username
    email
    profilePictureUrl
    role {
      name
    }
    authMethod
    ...APIKeysTableFragment
  }
}
`}}}();Wo.hash="d30a68846023740517243e9394be73a8";async function f1(){var a;const n=await D.fetchQuery(Me,Wo,{}).toPromise();if((a=n==null?void 0:n.viewer)!=null&&a.passwordNeedsReset){const t=di({path:"/reset-password"});return Ma(t)}return n}export{y1 as A,Z0 as B,t1 as C,z0 as D,j0 as E,c1 as F,a1 as G,m1 as H,w0 as I,g1 as J,p1 as K,r1 as L,q0 as M,i1 as N,l1 as O,u1 as P,P0 as Q,s1 as R,_0 as S,ya as T,D0 as U,Rn as a,o1 as b,f1 as c,L0 as d,A0 as e,V0 as f,M0 as g,R0 as h,N0 as i,B0 as j,H0 as k,U0 as l,I0 as m,O0 as n,$0 as o,Q0 as p,G0 as q,d1 as r,E0 as s,J0 as t,Sm as u,W0 as v,n1 as w,e1 as x,X0 as y,Y0 as z};
